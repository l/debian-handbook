<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">6.2. Los programas aptitude, apt-get y apt</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-es-ES-1.0-1" /><meta
        name="keywords"
        content="apt, apt-get, apt-cache, aptitude, synaptic, sources.list, apt-cdrom" /><link
        rel="home"
        href="index.html"
        title="El manual del Administrador de Debian" /><link
        rel="up"
        href="apt.html"
        title="Capítulo 6. Mantenimiento y actualizaciones: las herramientas APT" /><link
        rel="prev"
        href="apt.html"
        title="Capítulo 6. Mantenimiento y actualizaciones: las herramientas APT" /><link
        rel="next"
        href="sect.apt-cache.html"
        title="6.3. La orden apt-cache" /><meta
        name="viewport"
        content="width=device-width, initial-scale=1" /><meta
        name="flattr:id"
        content="4pz9jq" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/es-ES/sect.apt-get.html" /></head><body><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="../../"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="apt.html"><strong>Anterior</strong></a></li><li
          class="home">El manual del Administrador de Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.apt-cache.html"><strong>Siguiente</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.apt-get"></a>6.2. Los programas <code
                  class="command">aptitude</code>, <code
                  class="command">apt-get</code> y <code
                  class="command">apt</code></h2></div></div></div><a
          id="id-1.9.11.2"
          class="indexterm"></a><a
          id="id-1.9.11.3"
          class="indexterm"></a><a
          id="id-1.9.11.4"
          class="indexterm"></a><div
          class="para">
			APT es un proyecto gigante y su plan original incluia una interfaz gráfica. Está basado en una biblioteca que contiene la aplicación central y <code
            class="command">apt-get</code> fue la primera interfaz — basada en la línea de órdenes — desarrollada dentro del proyecto. <code
            class="command">apt</code> es un segundo frontend de linea de comandos proporcionado por APT el cual soluciona algunos errores de diseño de la orden <code
            class="command">apt-get</code>.
		</div><div
          class="para">
			Varias otras interfaces gráficas aparecieron luego como proyectos externos: <code
            class="command">synaptic</code>, <code
            class="command">aptitude</code> (que incluye tanto una interfaz en modo texto como una gráfica — aún cuando no esté completa), <code
            class="command">wajig</code>, etc. La interfaz más recomendada, <code
            class="command">apt</code> es la que utilizaremos en los ejemplos de esta sección. Note, sin embargo, que la sintaxis de línea de órdenes de <code
            class="command">apt-get</code> y de <code
            class="command">aptitude</code> son muy similares. Detallaremos cuando existan grandes diferencias entre <code
            class="command">apt</code>, <code
            class="command">apt-get</code> y <code
            class="command">aptitude</code>.
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.9.11.7"></a>6.2.1. Inicialización</h3></div></div></div><div
            class="para">
				Para cualquier trabajo con APT necesita actualizar la lista de paquetes; puede hacer esto simplemente con <code
              class="command">apt update</code>. Dependiendo de la velocidad de su conexión esta operación puede demorar ya que involucra descargar una cantidad de archivos <code
              class="filename">Packages</code>/<code
              class="filename">Sources</code>/<code
              class="filename">Translation-<em
                class="replaceable">codigo-idioma</em></code> que han crecido gradualmente a medida que se desarrolló Debian (más de 10 MB de datos para la sección <code
              class="literal">main</code>). Por su puesto, instalar desde un CD-ROM no requiere descarga alguna — en ese caso esta operación es muy rápida.
			</div><a
            id="id-1.9.11.7.3"
            class="indexterm"></a><a
            id="id-1.9.11.7.4"
            class="indexterm"></a><a
            id="id-1.9.11.7.5"
            class="indexterm"></a></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.9.11.8"></a>6.2.2. Instalación y eliminación</h3></div></div></div><a
            id="id-1.9.11.8.2"
            class="indexterm"></a><a
            id="id-1.9.11.8.3"
            class="indexterm"></a><a
            id="id-1.9.11.8.4"
            class="indexterm"></a><a
            id="id-1.9.11.8.5"
            class="indexterm"></a><div
            class="para">
				Con APT puede agregar o eliminar paquetes del sistema, con <code
              class="command">apt install <em
                class="replaceable">paquete</em></code> y <code
              class="command">apt remove <em
                class="replaceable">paquete</em></code> respectivamente. En ambos casos APT automáticamente instalará las dependencias necesarias o eliminará los paquetes que dependen del paquete que está siendo eliminado. La orden <code
              class="command">ap purge <em
                class="replaceable">paquete</em></code> realiza una desinstalación completa — se eliminan también los archivos de configuración.
			</div><a
            id="id-1.9.11.8.7"
            class="indexterm"></a><a
            id="id-1.9.11.8.8"
            class="indexterm"></a><a
            id="id-1.9.11.8.9"
            class="indexterm"></a><a
            id="id-1.9.11.8.10"
            class="indexterm"></a><a
            id="id-1.9.11.8.11"
            class="indexterm"></a><a
            id="id-1.9.11.8.12"
            class="indexterm"></a><a
            id="id-1.9.11.8.13"
            class="indexterm"></a><a
            id="id-1.9.11.8.14"
            class="indexterm"></a><a
            id="id-1.9.11.8.15"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>SUGERENCIA</em></span> Instalando la misma selección de paquetes varias veces</strong></p></div></div></div><div
              class="para">
				Puede ser útil instalar sistemáticamente la misma lista de paquetes en varios equipos. Esto puede realizarse fácilmente.
			</div><div
              class="para">
				Primero, obtenga la lista de paquetes en el equipo que servirá como «modelo» a copiar.
			</div><pre
              class="screen"><code
                class="computeroutput">$ </code><strong
                class="userinput"><code>dpkg --get-selections &gt;pkg-list</code></strong></pre><div
              class="para">
				El archivo <code
                class="filename">pkg-list</code> contiene ahora la lista de paquetes instalados. Luego, transfiera el archivo <code
                class="filename">pkg-list</code> a los equipos que desee actualizar, y utilice los siguientes comandos:
			</div><pre
              class="screen">## Actualizar la base de datos de dpkg sobre paquetes conocidos
# <strong
                class="userinput"><code>avail=`mktemp`</code></strong>
# <strong
                class="userinput"><code>apt-cache dumpavail &gt; "$avail"</code></strong>
# <strong
                class="userinput"><code>dpkg --merge-avail "$avail"</code></strong>
# <strong
                class="userinput"><code>rm -f "$avail"</code></strong>
## Actualizar estado de selección de paquetes de dpkg
# <strong
                class="userinput"><code>dpkg --set-selections &lt; pkg-list</code></strong>
## Pedirle a apt-get que instale los paquetes seleccionados
# <strong
                class="userinput"><code>apt-get dselect-upgrade</code></strong></pre><div
              class="para">
				La primera orden graba la lista de paquetes disponibles en la base de datos de dpkg, después <code
                class="command">dpkg --set-selections</code> restaura el estado de los paquetes seleccionados que desea instalar y la ejecución de <code
                class="command">apt-get</code> implementa las operaciones requeridas. <code
                class="command">aptitude</code> no tiene esta orden.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>SUGERENCIA</em></span> Eliminando e instalando al mismo tiempo</strong></p></div></div></div><div
              class="para">
				Es posible pedirle a <code
                class="command">apt</code> (o <code
                class="command">apt-get</code>, o <code
                class="command">aptitude</code>) que instale ciertos paquetes y elimine otros en la misma línea de comando agregando un sufijo. Con una orden <code
                class="command">apt install</code>, agregue «<code
                class="literal">-</code>» a los nombres de paquetes que desee eliminar. Con una orden <code
                class="command">apt remove</code>, agregue «<code
                class="literal">+</code>» a los nombres de paquete que desee instalar.
			</div><div
              class="para">
				El siguiente ejemplo muetra dos formas distintas de instalar <em
                class="replaceable">paquete1</em> y eliminar <em
                class="replaceable">paquete2</em>.
			</div><pre
              class="screen"># <strong
                class="userinput"><code>apt install <em
                    class="replaceable">paquete1</em> <em
                    class="replaceable">paquete2-</em></code></strong>
[...]
# <strong
                class="userinput"><code>apt remove <em
                    class="replaceable">paquete1+</em> <em
                    class="replaceable">paquete2</em></code></strong>
[...]</pre><div
              class="para">
				De esta forma también puede excluir paquetes que se instalarían, por ejemplo debido a una recomendación (<code
                class="literal">Recommends</code>). Generalmente, el sistema de resolución de dependencias utilizará esa información como una indicación para encontrar soluciones alternativas.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>SUGERENCIA</em></span> <code
                        class="command">apt --reinstall</code> y <code
                        class="command">aptitude reinstall</code></strong></p></div></div></div><a
              id="id-1.9.11.8.18.2"
              class="indexterm"></a><div
              class="para">
				A veces el sistema puede dañarse después de eliminar o modificar los archivos de un paquete. La forma más sencilla de recuperar estos archivos es reinstalar los paquetes afectados. Desafortunadamente, el sistema de empaquetado encuentra que éste ya está instalado y amablemente rechaza su reinstalación; Para evitarlo, utilice la opción <code
                class="literal">--reinstall</code> de los comandos <code
                class="command">apt</code> y <code
                class="command">apt-get</code>. La siguiente orden reinstala <span
                class="pkg pkg">postfix</span> aunque ya esté instalado:
			</div><pre
              class="screen"><code
                class="computeroutput"># </code><strong
                class="userinput"><code>apt --reinstall install postfix</code></strong></pre><div
              class="para">
				La línea de órdenes para <code
                class="command">aptitude</code> es ligeramente diferente pero consigue el mismo resultado con <code
                class="command">aptitude reinstall postfix</code>.
			</div><div
              class="para">
				El problema no ocurre con <code
                class="command">dpkg</code> pero el administrador rara vez lo utiliza directamente.
			</div><div
              class="para">
				¡Tenga cuidado! El uso de <code
                class="command">apt --reinstall</code> para restaurar paquetes modificados durante un ataque no recuperará el sistema tal y como estaba. La <a
                class="xref"
                href="sect.dealing-with-compromised-machine.html">Sección 14.7, “Tratamiento de una máquina comprometida”</a> detalla los pasos necesarios para recuperar en un sistema comprometido.
			</div></div><div
            class="para">
				Si el archivo <code
              class="filename">sources.list</code> menciona varias distribuciones, es posible indicar la versión del paquete a instalar. Se puede proporionar un número de versión específico con <code
              class="command">apt install <em
                class="replaceable">paquete</em>=<em
                class="replaceable">versión</em></code>, pero generealmente es preferible indicar la distribución de origen (<span
              class="distribution distribution">Stable</span>, <span
              class="distribution distribution">Testing</span> o <span
              class="distribution distribution">Unstable</span>) utilizando <code
              class="command">apt install <em
                class="replaceable">paquete</em>/<em
                class="replaceable">distribución</em></code>. Con esta orden es posible volver a una versión antigua de un paquete (si sabe que funciona bien, por ejemplo), siempre que aún esté disponible en alguno de los orígenes a los que se refiere el archivo <code
              class="filename">sources.list</code>. De lo contrario, el archivo <code
              class="literal">snapshot.debian.org</code> puede llegar al rescate (revise el recuadro <a
              class="xref"
              href="apt.html#sidebar.snapshot.debian.org"><span
                class="emphasis"><em>YENDO MÁS ALLÁ</em></span> Versiones antiguas de paquetes: <code
                class="literal">snapshot.debian.org</code></a>).
			</div><div
            class="example"><a
              id="id-1.9.11.8.20"></a><p
              class="title"><strong>Ejemplo 6.3. Instalación de la versión en <span
                  class="distribution distribution">Unstable</span> de <span
                  class="pkg pkg">spamassassin</span></strong></p><div
              class="example-contents"><pre
                class="screen"><code
                  class="computeroutput"># </code><strong
                  class="userinput"><code>apt install spamassassin/unstable</code></strong></pre></div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>YENDO MÁS ALLÁ</em></span> El caché de archivos <code
                        class="filename">.deb</code></strong></p></div></div></div><div
              class="para">
				APT mantiene una copia de cada archivo <code
                class="filename">.deb</code> descargado en el directorio <code
                class="filename">/var/cache/apt/archives/</code>. En caso de actualizaciones frecuentes, este directorio puede ocupar rápidamente mucho espacio en disco, con varias versiones de cada paquete; Debería ordenarlos regularmente. Puede utilizar dos órdenes: <code
                class="command">apt-get clean</code> vacía completamente el directorio y <code
                class="command">apt-get autoclean</code> sólo elimina los paquetes que ya no pueden ser descargados (porque ya desaparecieron del espejo Debian) y son obviamente inútiles (el parámetro de configuración <code
                class="literal">APT::Clean-Installed</code> puede evitar la eliminación de archivos <code
                class="filename">.deb</code> que estén instalados actualmente). Fíjese que <code
                class="command">apt</code> no soporta estos comandos.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt-upgrade"></a>6.2.3. Actualización del sistema</h3></div></div></div><a
            id="id-1.9.11.9.2"
            class="indexterm"></a><a
            id="id-1.9.11.9.3"
            class="indexterm"></a><a
            id="id-1.9.11.9.4"
            class="indexterm"></a><a
            id="id-1.9.11.9.5"
            class="indexterm"></a><div
            class="para">
				Se recomienda realizar actualizaciones regularmente, ya que incluyen las últimas actualizaciones de seguridad. Para actualizar, utilice <code
              class="command">apt upgrade</code>, <code
              class="command">apt-get upgrade</code> o <code
              class="command">aptitude safe-upgrade</code> (por supuesto, después de <code
              class="command">apt-get update</code>). Esta orden busca paquetes instalados que pueden ser actualizados sin eliminar ningún paquete. En otras palabras, el objetivo es asegurar la actualización menos intrusiva posible. <code
              class="command">apt-get</code> es ligeramente más exigente que <code
              class="command">aptitude</code> o <code
              class="command">apt</code> ya que se negará a instalar paquetes que no estaban instalados previamente.
			</div><div
            class="sidebar"><a
              id="sidebar.apt-pdiff"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>SUGERENCIA</em></span> Actualización incremental</strong></p></div></div></div><div
              class="para">
				Como explicamos anteriormente, el objetivo de la orden <code
                class="command">ap update</code> es descargar el archivo <code
                class="filename">Packages</code> (o <code
                class="filename">Sources</code>) de cada origen de paquetes. Sin embargo, aún después de la compresión <code
                class="command">bzip2</code>, estos archivos pueden seguir siendo relativamente grandes (el archivo <code
                class="filename">Packages.xz</code> para la sección <span
                class="foreignphrase"><em
                  class="foreignphrase">main</em></span> de <span
                class="distribution distribution">Jessie</span> ocupa más de 6 MB). Si desea actualizar frecuentemente, estas descargas pueden tardar mucho tiempo.
			</div><div
              class="para">
				Para acelerar el proceso APT puede descargar archivos «diff», que contienen los cambios desde la última actualización, en lugar del archivo completo. Para lograr esto, las réplicas oficiales de Debian distribuyen diferentes archivos que listan las diferencias entre una versión del archivo <code
                class="filename">Packages</code> y la siguiente. Son generados en cada actualización de los archivos y se mantiene un histórico semanal. Cada uno de estos archivos «diff» sólo ocupa unas pocas docenas de kilobytes para <span
                class="distribution distribution">Unstable</span>, por lo que la cantidad de datos descargados si se ejecuta semanalmente <code
                class="command">apt update</code> se divide por 10. Para distribuciones como <span
                class="distribution distribution">Stable</span> y <span
                class="distribution distribution">Testing</span>, que cambian menos, la mejora es menos notable.
			</div><div
              class="para">
				Sin embargo, a veces puede estar interesado en descargar el archivo <code
                class="filename">Packages</code> completo, especialmente cuando la última actualización es muy antigua y cuando el mecanismo de diferencias incrementales no ayudaría demasiado. También puede ser interesante cuando el acceso de red es muy rápido pero el procesador en el equipo a actualizar es relativamente lento ya que el tiempo ahorrado en la descarga es más que el perdido cuando el equipo calcule la nueva versión de los archivos (comenzando con las versiones antiguas y aplicando las diferencias descargadas). Para hacer esto puede utilizar el parámetro de configuración <code
                class="literal">Acquire::Pdiffs</code> y configurarlo como <code
                class="literal">false</code>.
			</div></div><div
            class="para">
				<code
              class="command">apt</code> generalmente seleccionará el número de versión más reciente (excepto para paquetes en <span
              class="distribution distribution">Experimental</span> y <span
              class="distribution distribution">stable-backports</span>, que son ignorados de forma predeterminada sin importar su número de versión). Si especificó <span
              class="distribution distribution">Testing</span> o <span
              class="distribution distribution">Unstable</span> en su archivo <code
              class="filename">sources.list</code>, <code
              class="command">apt upgrade</code> cambiará la mayor parte de su sistema en <span
              class="distribution distribution">Stable</span> a <span
              class="distribution distribution">Testing</span> o <span
              class="distribution distribution">Unstable</span>, lo que podría no ser lo deseado.
			</div><div
            class="para">
				Para indicarle a <code
              class="command">apt</code> que utilice una distribución específica al buscar paquetes a actualizar debe utilizar la opción <code
              class="literal">-t</code> o <code
              class="literal">--target-release</code>, seguido del nombre de la distribución que desea (por ejemplo: <code
              class="command">apt -t stable upgrade</code>). Para evitar especificar esta opción cada vez que utilice <code
              class="command">apt</code> puede agregar <code
              class="literal">APT::Default-Release "stable";</code> al archivo <code
              class="filename">/etc/apt/apt.conf.d/local</code>.
			</div><a
            id="id-1.9.11.9.10"
            class="indexterm"></a><a
            id="id-1.9.11.9.11"
            class="indexterm"></a><a
            id="id-1.9.11.9.12"
            class="indexterm"></a><a
            id="id-1.9.11.9.13"
            class="indexterm"></a><a
            id="id-1.9.11.9.14"
            class="indexterm"></a><div
            class="para">
				Para actualizaciones más importantes, tales como el cambio de una versión mayor de Debian a la siguiente, necesita utilizar <code
              class="command">apt full-upgrade</code>. Con esta instrucción, <code
              class="command">apt</code> completará la actualización aún si tiene que eliminar algunos paquetes obsoletos o instalar nuevas dependencias. Esta también es la orden utilizada por los usuarios que trabajan diariamente con la versión <span
              class="distribution distribution">Unstable</span> de Debian y siguen su evolución día a día. Es tan simple que casi no necesita explicación: la reputación de APT está basada en esta excelente característica.
			</div><div
            class="para">
				A diferencia de <code
              class="command">apt</code> y <code
              class="command">aptitude</code>, <code
              class="command">apt-get</code> no sabe cómo hacer <code
              class="command">full-upgrade</code> command. En su lugar debería usar <code
              class="command">apt-get dist-upgrade</code> (”distribution upgrade”), la histórica y bien conocida orden que <code
              class="command">apt</code> y <code
              class="command">aptitude</code> también aceptan para satisfacer a los usuarios que están acostumbrados a usarla.
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt-config"></a>6.2.4. Opciones de configuración</h3></div></div></div><a
            id="id-1.9.11.10.2"
            class="indexterm"></a><a
            id="id-1.9.11.10.3"
            class="indexterm"></a><a
            id="id-1.9.11.10.4"
            class="indexterm"></a><div
            class="para">
				Además de los elementos de configuración ya mencionados, es posible configurar ciertos aspectos de APT agregando directivas en un archivo del directorio <code
              class="filename">/etc/apt/apt.conf.d/</code>. Recuerde, por ejemplo, que APT puede indicarle a <code
              class="command">dpkg</code> que ignore errores de conflictos de archivos especificando <code
              class="literal">DPkg::options { "--force-overwrite"; }</code>.
			</div><div
            class="para">
				Si sólo puede acceder a la web a través de un proxy, agregue una línea como <code
              class="literal">Acquire::http::proxy "http://<em
                class="replaceable">su-proxy</em>:3128"</code>. Para un proxy FTP, utilice <code
              class="literal">Acquire::ftp::proxy "ftp://<em
                class="replaceable">su-proxy</em>"</code>. Para descubrir más opciones de configuración, lea la página de manual <span
              class="citerefentry"><span
                class="refentrytitle">apt.conf</span>(5)</span> con la orden <code
              class="command">man apt.conf</code> (para detalles sobre las páginas de manual, revise la <a
              class="xref"
              href="solving-problems.html#sect.manual-pages">Sección 7.1.1, “Páginas de manual”</a>).
			</div><div
            class="sidebar"><a
              id="sidebar.directory.d"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>VOLVER A LOS CIMIENTOS</em></span> Directorios terminados con <code
                        class="filename">.d</code></strong></p></div></div></div><a
              id="id-1.9.11.10.7.2"
              class="indexterm"></a><div
              class="para">
				Cada vez más se utilizan directorios con el sufijo <code
                class="filename">.d</code>. Cada directorio representa un archivo de configuración repartido en múltiples archivos. En este sentido, todos los archivos en <code
                class="filename">/etc/apt/apt.conf.d/</code> son instrucciones para la configuración de APT. APT los incluye en orden alfabético para que los últimos puedan modificar un elemento de configuración definido en los primeros.
			</div><div
              class="para">
				Esta estructura le da cierta flexibilidad al administrador del equipo y a los desarrolladores de paquetes. De hecho, el administrador puede modificar fácilmente la configuración del software agregando un archivo prehecho en el directorio en cuestión sin tener que modificar un archivo existente. Los desarrolladores de paquetes utilizan el mismo enfoque cuando necesitan adaptar la configuración de otro software pare asegurar que pueda coexistir perfectamente con el suyo. La Normativa Debian prohíbe explícitamente modificar los archivos de configuración de otros paquetes — sólo los usuarios pueden hacerlo. Recuerde que durante la actualización de un paquete el usuario puede elegir la versión del archivo de configuración a mantener cuando se detectó una modificación. Cualquier modificación externa de un archivo dispararía dicho pedido, lo que molestaría al administrador que está seguro de no haber modificado nada.
			</div><div
              class="para">
				Sin un directorio <code
                class="filename">.d</code> es imposible que un paquete externo modifique la configuración de un programa sin modificar su archivo de configuración. En su lugar, debe invitar al usuario a que lo haga por su cuenta y lista las operaciones a realizar en el archivo <code
                class="filename">/usr/share/doc/<em
                  class="replaceable">paquete</em>/README.Debian</code>.
			</div><div
              class="para">
				Dependiendo de la aplicación, el directorio <code
                class="filename">.d</code> puede ser utilizado directamente o administrado por un script externo que concatena todos los archivos para crear el archivo de configuración. Es importante ejecutar este script luego de cualquier cambio en ese directorio para que se tengan en cuenta las modificaciones más recientes. De la misma forma, es importante no trabajar directamente en el archivo de configuración creado automáticamente ya que se perdería todo en la siguiente ejecución del script. El método seleccionado (usar directamente el directorio <code
                class="filename">.d</code> o un archivo generado desde dicho directorio) está generalmente definido por limitaciones de implementación, pero en ambos casos las ganancias en cuanto a flexibilidad de la configuración más que compensan las pequeñas complicaciones que significan. El servidor de correo Exim 4 es un ejemplo del método en el que se genera el archivo: puede configurarse mediante varios archivos (<code
                class="filename">/etc/exim4/conf.d/*</code>) que son concatenados en <code
                class="filename">/var/lib/exim4/config.autogenerated</code> mediante la orden <code
                class="command">update-exim4.conf</code>.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt.priorities"></a>6.2.5. Gestión de prioridades de los paquetes</h3></div></div></div><div
            class="para">
				Uno de los aspectos más importantes en la configuración de APT es la gestión de las prioridades asociadas con cada origen de paquetes. Por ejemplo, podría desear extender una distribución con uno o dos paquetes más recientes de <span
              class="distribution distribution">Testing</span>, <span
              class="distribution distribution">Unstable</span> o <span
              class="distribution distribution">Experimental</span>. Es posible asignar una prioridad a cada paquete disponible (el mismo paquete puede tener varias prioridades según su versión o la distribución que lo provee). Estas prioridades influenciarán el comportamiento de APT: para cada paquete, siempre seleccionará la versión con la prioridad más alta (excepto si esta versión es anterior a la instalada y si su prioridad es menor a 1000).
			</div><a
            id="id-1.9.11.11.3"
            class="indexterm"></a><a
            id="id-1.9.11.11.4"
            class="indexterm"></a><a
            id="id-1.9.11.11.5"
            class="indexterm"></a><a
            id="id-1.9.11.11.6"
            class="indexterm"></a><a
            id="id-1.9.11.11.7"
            class="indexterm"></a><a
            id="id-1.9.11.11.8"
            class="indexterm"></a><a
            id="id-1.9.11.11.9"
            class="indexterm"></a><div
            class="para">
				APT define varias prioridades predeterminadas. Cada versión instalada de un paquete tiene una prioridad de 100. Una versión no instalada tiene una prioridad predeterminada de 500, pero puede saltar a 990 si es parte de la distribución destino (definida con la opción de línea de órdenes <code
              class="literal">-t</code> o la directiva de configuración <code
              class="literal">APT::Default-Release</code>).
			</div><div
            class="para">
				Puede modificar las prioridades agregando elementos en el archivo <code
              class="filename">/etc/apt/preferences</code> con los nombres de los paquetes afectados, sus versiones, sus orígenes y sus nuevas prioridades.
			</div><div
            class="para">
				APT nunca instalará una versión anterior de un paquete (esto es, un paquete cuyo número de versión sea menor al que está instalado actualmente) excepto si su prioridad es mayor a 1000. APT siempre instalará el paquete con la mayor prioridad que cumpla esta restricción. Si dos paquetes tienen la misma prioridad, APT instalará la más reciente (aquella cuya versión sea mayor). Si dos paquetes de la misma versión tienen la misma prioridad pero tienen diferente contenido, APT instalará la versión que no está instalada (se creó esta regla para cubrir los casos de la actualización de un paquete sin aumentar el número de revisión, que es generalmente necesario).
			</div><div
            class="para">
				En términos más concretos, un paquete con prioridad menor a 0 nunca será instalado. Un paquete con una prioridad entre 0 y 100 sólo será instalado si no hay otra versión ya instalada del paquete. Con una prioridad entre 100 y 500, el paquete sólo será instalado si no hay otra versión más reciente instalada o disponible en otra distribución. Un paquete con prioridad entre 501 y 990 será instalado sólo si no hay una versión más nueva instalada o disponible en la distribución de destino. Con una prioridad entre 990 y 1000, el paquete será instalado a menos que la versión instalada sea mayor. Una prioridad mayor a 1000 siempre llevará a la instalación del paquete aún si ésto significa que APT instalará una versión anterior.
			</div><div
            class="para">
				Cuando APT revisa <code
              class="filename">/etc/apt/preferences</code> primero tiene en cuenta las entradas más específicas (generalmente aquellas que especifiquen el paquete en cuestión), luego las más genéricas (incluyendo, por ejemplo, todos los paquetes de una distribución). Si existen varias entradas genéricas, utiliza la primera coincidencia. El criterio de selección disponible incluye el nombre del paquete y el origen que lo provee. Se identifica cada origen de paquetes por la información contenida en un archivo <code
              class="filename">Release</code> y que APT descarga junto con los archivos <code
              class="filename">Packages</code>. Especifica el origen (generalmente «Debian» para paquetes de las réplicas oficiales, pero también puede ser el nombre de una persona u organización para repositorios de terceros). También provee el nombre de la distribución (generalmente <span
              class="distribution distribution">Stable</span>, <span
              class="distribution distribution">Testing</span>, <span
              class="distribution distribution">Unstable</span> o <span
              class="distribution distribution">Experimental</span> para las distribuciones estándar que provee Debian) junto con su versión (por ejemplo, 8 para Debian <span
              class="distribution distribution">Jessie</span>). Revisemos su sintaxis a través de casos de estudio de este mecanismo más realistas.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>CASO ESPECÍFICO</em></span> La prioridad de <span
                        class="distribution distribution">Experimental</span></strong></p></div></div></div><a
              id="id-1.9.11.11.15.2"
              class="indexterm"></a><div
              class="para">
				Si agregó <span
                class="distribution distribution">Experimental</span> en su archivo <code
                class="filename">sources.list</code>, los paquetes correspondientes casi nunca serán instalados porque su prioridad APT predeterminada es 1. Este es, por supuesto, un caso específico diseñado para evitar que los usuarios instalen paquetes de <span
                class="distribution distribution">Experimental</span> por error. Los paquetes sólo pueden instalarse ejecutando <code
                class="command">aptitude install <em
                  class="replaceable">paquete</em>/experimental</code> — solo los usuarios que ingresen esta orden saben los riesgos que están tomando. Es posible (aunque <span
                class="emphasis"><em>no</em></span> recomendable) tratar los paquetes de <span
                class="distribution distribution">Experimental</span> como aquellos de otra distribución otorgándoles una prioridad de 500. Esto se logra con una entrada específica en <code
                class="filename">/etc/apt/preferences</code>:
			</div><div
              class="informalexample"><pre
                class="programlisting">Package: *
Pin: release a=experimental
Pin-Priority: 500</pre></div></div><div
            class="para">
				Supongamos que sólo desea utilizar paquetes de la versión estable de Debian. Aquellos provistos en otras versiones no serían instalados a menos que sean pedidos explícitamente. Puede escribir las siguientes entradas en el archivo <code
              class="filename">/etc/apt/preferences</code>:
			</div><div
            class="informalexample"><pre
              class="programlisting">Package: *
Pin: release a=stable
Pin-Priority: 900

Package: *
Pin: release o=Debian
Pin-Priority: -10</pre></div><div
            class="para">
				<code
              class="literal">a=stable</code> define el nombre de la distribución elegida. <code
              class="literal">o=Debian</code> limita el alcance a los paquetes cuyo origen es «Debian».
			</div><div
            class="para">
				Asumamos ahora que tiene un servidor con varios programas locales que dependen de la versión 5.14 de Perl y que desea asegurarse que las actualizaciones no instalarán otra versión del mismo. Puede utilizar la siguiente entrada:
			</div><div
            class="informalexample"><pre
              class="programlisting">Package: perl
Pin: version 5.14*
Pin-Priority: 1001</pre></div><div
            class="para">
				La documentación de referencia para este archivo de configuración está disponible en la página de manual <span
              class="citerefentry"><span
                class="refentrytitle">apt_preferences</span>(5)</span> que puede ver con <code
              class="command">man apt_preferences</code>.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>SUGERENCIA</em></span> Comentarios en <code
                        class="filename">/etc/apt/preferences</code></strong></p></div></div></div><a
              id="id-1.9.11.11.22.2"
              class="indexterm"></a><a
              id="id-1.9.11.11.22.3"
              class="indexterm"></a><a
              id="id-1.9.11.11.22.4"
              class="indexterm"></a><div
              class="para">
				No existe una sintaxis oficial para agregar comentarions en el archivo <code
                class="filename">/etc/apt/preferences</code>, pero se pueden proveer algunas descripciones textuales agregando uno o más campos «<code
                class="literal">Explanation</code>» al principio de cada entrada:
			</div><div
              class="informalexample"><pre
                class="programlisting">Explanation: El paquete xserver-xorg-video-intel provisto
Explanation: en experimental puede usarse de forma segura
Package: xserver-xorg-video-intel
Pin: release a=experimental
Pin-Priority: 500</pre></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt-mix-distros"></a>6.2.6. Trabajo con varias distribuciones</h3></div></div></div><div
            class="para">
				Siendo la herramienta maravillosa que <code
              class="command">apt</code> es, es tentador elegir paquetes de otras distribuciones. Por ejemplo, tras instalar un sistema <span
              class="distribution distribution">Stable</span> podría desear probar paquetes de software disponibles en <span
              class="distribution distribution">Testing</span> o <span
              class="distribution distribution">Unstable</span> sin desviarse demasiado del estado inicial del sistema.
			</div><div
            class="para">
				Aún cuando ocasionamente encontrará problemas al mezclar paquetes de diferentes distribuciones <code
              class="command">apt</code> gestionará muy bien su coexistencia y limitará los riesgos de manera muy efectiva. La mejor manera de proceder es listar todas las distribuciones utilizadas en <code
              class="filename">/etc/apt/sources.list</code> (algunas personas siempre agregan las tres distribuciones, pero recuerde que <span
              class="distribution distribution">Unstable</span> está reservado para usuarios experimentados) y definir su distribución de referencia con el parámetro <code
              class="literal">APT::Default-Release</code> (revise la <a
              class="xref"
              href="sect.apt-get.html#sect.apt-upgrade">Sección 6.2.3, “Actualización del sistema”</a>).
			</div><div
            class="para">
				Supongamos que su distribución de referencia es <span
              class="distribution distribution">Stable</span> pero que <span
              class="distribution distribution">Testing</span> y <span
              class="distribution distribution">Unstable</span> también aparecen listados en su archivo <code
              class="filename">sources.list</code>. En este caso, puede utilizar <code
              class="command">apt install <em
                class="replaceable">paquete</em>/testing</code> para instalar un paquete de <span
              class="distribution distribution">Testing</span>. Si la instalación falla debido a alguna dependencia insatisfecha, permítale resolver esas dependencias dentro de <span
              class="distribution distribution">Testing</span> agregando el parámetro <code
              class="literal">-t testing</code>. Obviamente, lo mismo aplica a <span
              class="distribution distribution">Unstable</span>.
			</div><div
            class="para">
				En esta situación, las actualizaciones (<code
              class="command">upgrade</code> y <code
              class="command">full-upgrade</code>) se realizan dentro de <span
              class="distribution distribution">Stable</span> a excepción de los paquetes que ya fueron actualizados a otra distribución: éstos seguirán las actualizaciones disponibles en las otras distribuciones. Explicaremos este comportamiento con la ayuda de las prioridades predeterminadas de APT a continuación. No dude en utilizar <code
              class="command">apt-cache policy</code> (revise el recuadro <a
              class="xref"
              href="sect.apt-get.html#sidebar.apt-cache-policy"><span
                class="emphasis"><em>SUGERENCIA</em></span> <code
                class="command">apt-cache policy</code></a>) para verificar las prioridades otorgadas.
			</div><div
            class="para">
				Todo gira alrededor del hecho de que APT considera sólo paquetes con una versión mayor o igual que la instalada (suponiendo que <code
              class="filename">/etc/apt/preferences</code> no ha sido usado para forzar prioridades superiores a 1000 para algunos paquetes).
			</div><div
            class="sidebar"><a
              id="sidebar.apt-cache-policy"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>SUGERENCIA</em></span> <code
                        class="command">apt-cache policy</code></strong></p></div></div></div><div
              class="para">
				Para obtener un mejor entendimiento del mecanismo de prioridades, no dude en ejecutar <code
                class="command">apt-cache policy</code> para mostrar la prioridad predeterminada asociada a cada origen de paquetes. También puede utilizar <code
                class="command">apt-cache policy <em
                  class="replaceable">paquete</em></code> para mostrar las prioridades de todas las versiones disponibles de un paquete dado.
			</div></div><div
            class="para">
				Asumamos que instaló la versión 1 de un primer paquete de <span
              class="distribution distribution">Stable</span> y que las versiones 2 y 3 están disponibles en <span
              class="distribution distribution">Testing</span> y <span
              class="distribution distribution">Unstable</span> respectivamente. La versión instalada tiene una prioridad de 100, pero la versión disponible en <span
              class="distribution distribution">Stable</span> (la misma versión) tiene una prioridad de 990 (porque es parte de la versión de destino). Los paquetes en <span
              class="distribution distribution">Testing</span> y <span
              class="distribution distribution">Unstable</span> tienen una prioridad de 500 (la prioridad predeterminada para una versión no instalada). El ganador es, por lo tanto, la versión 1 con una prioridad de 990. El paquete «se mantiene en <span
              class="distribution distribution">Stable</span>».
			</div><div
            class="para">
				Tomemos como ejemplo otro paquete cuya versión 2 fue instalada de <span
              class="distribution distribution">Testing</span>. La versión 1 está disponible en <span
              class="distribution distribution">Stable</span> y la versión 3 en <span
              class="distribution distribution">Unstable</span>. La versión 1 (de prioridad 990 — por lo tanto menor a 1000) es descartada porque es menor que la versión instalada. Esto deja sólo las versiones 2 y 3, ambas de prioridad 500. Frente a esta alternativa, APT selecciona la versión más nueva: la de <span
              class="distribution distribution">Unstable</span>. Si no desea que un paquete de <span
              class="distribution distribution">Testing</span> actualice su versión a la de <span
              class="distribution distribution">Unstable</span>, debe asignar una prioridad menor a 500 (490 por ejemplo) a los paquetes que provengan de <span
              class="distribution distribution">Unstable</span>. Puede modificar <code
              class="filename">/etc/apt/preferences</code> de la siguiente forma:
			</div><pre
            class="programlisting">Package: *
Pin: release a=unstable
Pin-Priority: 490</pre></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.automatic-tracking"></a>6.2.7. Seguimiento de paquetes instalados automáticamente</h3></div></div></div><div
            class="para">
				Una de las funcionalidades esenciales de <code
              class="command">apt</code> es el rastreo de aquellos paquetes instalados únicamente debido a dependencias. Estos paquetes son llamados «automáticos», y generalmente incluyen bibliotecas.
			</div><div
            class="para">
				Con esta información, cuado se eliminan paquetes, los gestores de paquetes pueden calcular una lista de paquetes automáticos que ya no son necesarios (porque no hay paquetes «instalados manualmente» que dependan de ellos). El comando <code
              class="command">apt-get autoremove</code> se encargará de dichos paquetes. <code
              class="command">aptitude</code> y <code
              class="command">apt</code> no poseen esta orden: el primero porque los elimina automáticamente tan pronto como los identifica y, el último probablemente porque el usuario no debería tener que ejecuar dicho comando. En todo caso, las herramientas muestran un claro mensaje que enumera los paquetes afectados.
			</div><a
            id="id-1.9.11.13.4"
            class="indexterm"></a><a
            id="id-1.9.11.13.5"
            class="indexterm"></a><a
            id="id-1.9.11.13.6"
            class="indexterm"></a><a
            id="id-1.9.11.13.7"
            class="indexterm"></a><div
            class="para">
				Es buen hábito marcar como automático cualquier paquete que no necesite directamente para que sea eliminado automáticamente cuando ya no sea necesario. <code
              class="command">apt-mark auto <em
                class="replaceable">paquete</em></code> marcará el paquete dado como automático mientras que <code
              class="command">apt-mark manual <em
                class="replaceable">paquete</em></code> realiza lo opuesto. <code
              class="command">aptitude markauto</code> y <code
              class="command">aptitude unmarkauto</code> funcionan de la misma forma, pero ofrecen más funcionalidad para marcar varios paquetes simultáneamente (revise la <a
              class="xref"
              href="sect.apt-frontends.html#sect.aptitude">Sección 6.4.1, “<code
                class="command">aptitude</code>”</a>). La interfaz interactiva para la consola de <code
              class="command">aptitude</code> también facilita el revisar la «marca automática» en muchos paquetes.
			</div><a
            id="id-1.9.11.13.9"
            class="indexterm"></a><div
            class="para">
				Algunas personas podrían desear saber porqué un paquete instalado automáticamente está presente en el sistema. Para obtener esta información desde la línea de comandos puede utilizar <code
              class="command">aptitude why <em
                class="replaceable">paquete</em></code> (<code
              class="command">apt</code> y <code
              class="command">apt-get</code> no poseen una funcionalidad similar):
			</div><pre
            class="screen"><code
              class="computeroutput">$ </code><strong
              class="userinput"><code>aptitude why python-debian
</code></strong><code
              class="computeroutput">i   aptitude         Recommends apt-xapian-index         
i A apt-xapian-index Depends    python-debian (&gt;= 0.1.15)
</code></pre><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ALTERNATIVA</em></span> <code
                        class="command">deborphan</code> y <code
                        class="command">debfoster</code></strong></p></div></div></div><a
              id="id-1.9.11.13.12.2"
              class="indexterm"></a><a
              id="id-1.9.11.13.12.3"
              class="indexterm"></a><div
              class="para">
				Cuando <code
                class="command">apt</code>, <code
                class="command">apt-get</code> y <code
                class="command">aptitude</code> no poseían un seguimiento automático de paquetes, existían dos herramientas que generaban listas de paquetes innecesarios: <code
                class="command">deborphan</code> y <code
                class="command">debfoster</code>.
			</div><div
              class="para">
				<code
                class="command">deborphan</code> es la más rudimentaria de ambas. Simplemente escanea las secciones <code
                class="literal">libs</code> y <code
                class="literal">oldlibs</code> (siempre que no se le indique otra cosa) buscando los paquetes instalados actualmente de los que no depende ningún otro paquete. La lista resultante puede servir luego como una base para eliminar paquetes innecesarios.
			</div><div
              class="para">
				<code
                class="command">debfoster</code> tiene un enfoque más elaborado, muy similar al de APT: mantiene una lista de paquetes que fueron instalados explícitamente y recuerda qué paquetes son realmente necesarios entre cada invocación. Si aparecen nuevos paquetes en el sistema que <code
                class="command">debfoster</code> no reconoce como paquetes requeridos serán mostrados en pantalla junto a una lista de sus dependencias. El programa luego ofrece la opción de eliminar el paquete (posiblemente junto a los que dependen de él), marcarlo como requerido explícitamente o ignorarlo temporalmente.
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="apt.html"><strong>Anterior</strong>Capítulo 6. Mantenimiento y actualizaciones: las ...</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Subir</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Inicio</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.apt-cache.html"><strong>Siguiente</strong>6.3. La orden apt-cache</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.apt-get.html">ar-MA</a></li><li><a
              href="../da-DK/sect.apt-get.html">da-DK</a></li><li><a
              href="../de-DE/sect.apt-get.html">de-DE</a></li><li><a
              href="../el-GR/sect.apt-get.html">el-GR</a></li><li><a
              href="../en-US/sect.apt-get.html">en-US</a></li><li><a
              href="../es-ES/sect.apt-get.html">es-ES</a></li><li><a
              href="../fa-IR/sect.apt-get.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.apt-get.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.apt-get.html">hr-HR</a></li><li><a
              href="../id-ID/sect.apt-get.html">id-ID</a></li><li><a
              href="../it-IT/sect.apt-get.html">it-IT</a></li><li><a
              href="../ja-JP/sect.apt-get.html">ja-JP</a></li><li><a
              href="../ko-KR/sect.apt-get.html">ko-KR</a></li><li><a
              href="../nb-NO/sect.apt-get.html">nb-NO</a></li><li><a
              href="../pl-PL/sect.apt-get.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.apt-get.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.apt-get.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.apt-get.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.apt-get.html">tr-TR</a></li><li><a
              href="../vi-VN/sect.apt-get.html">vi-VN</a></li><li><a
              href="../zh-CN/sect.apt-get.html">zh-CN</a></li><li><a
              href="../zh-TW/sect.apt-get.html">zh-TW</a></li></ul></div></body></html>
