<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">Capítulo 10. Infraestructura de red</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.1" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-es-ES-1.0-1" /><meta
        name="keywords"
        content="Red, Puerta de enlace, TCP/IP, IPv6, DNS, Bind, DHCP, QoS" /><link
        rel="home"
        href="index.html"
        title="El libro del administrador de Debian" /><link
        rel="up"
        href="index.html"
        title="El libro del administrador de Debian" /><link
        rel="prev"
        href="sect.power-management.html"
        title="9.12. Gestión de energía: interfaz avanzada de configuración y energía (ACPI: «Advanced Configuration and Power Interface)" /><link
        rel="next"
        href="sect.virtual-private-network.html"
        title="10.2. Red virtual privada" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/es-ES/network-infrastructure.html" /></head><body
      class="draft "><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="http://debian-handbook.info"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.power-management.html"><strong>Anterior</strong></a></li><li
          class="home">El libro del administrador de Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.virtual-private-network.html"><strong>Siguiente</strong></a></li></ul><div
        xml:lang="es-ES"
        class="chapter"
        lang="es-ES"><div
          class="titlepage"><div><div><h1
                class="title"><a
                  id="network-infrastructure"></a>Capítulo 10. Infraestructura de red</h1></div></div></div><div
          class="toc"><dl
            class="toc"><dt><span
                class="section"><a
                  href="network-infrastructure.html#sect.gateway">10.1. Puerta de enlace</a></span></dt><dt><span
                class="section"><a
                  href="sect.virtual-private-network.html">10.2. Red virtual privada</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.openvpn">10.2.1. OpenVPN</a></span></dt><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.ssh-vpn">10.2.2. Red privada virtual con SSH</a></span></dt><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.ipsec">10.2.3. IPsec</a></span></dt><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.pptp">10.2.4. PPTP</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.quality-of-service.html">10.3. Calidad del servicio</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.quality-of-service.html#sect.qos-principe">10.3.1. Principio y mecanismo</a></span></dt><dt><span
                    class="section"><a
                      href="sect.quality-of-service.html#sect.qos-config">10.3.2. Configuración e implementación</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.dynamic-routing.html">10.4. Enrutamiento dinámico</a></span></dt><dt><span
                class="section"><a
                  href="sect.ipv6.html">10.5. IPv6</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.ipv6.html#sect.ipv6-tunneling">10.5.1. Túneles</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.domain-name-servers.html">10.6. Servidores de nombres de dominio (DNS)</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.domain-name-servers.html#sect.dns-principe">10.6.1. Principio y mecanismo</a></span></dt><dt><span
                    class="section"><a
                      href="sect.domain-name-servers.html#sect.dns-config">10.6.2. Configuración</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.dhcp.html">10.7. DHCP</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.dhcp.html#sect.dhcp-config">10.7.1. Configuración</a></span></dt><dt><span
                    class="section"><a
                      href="sect.dhcp.html#sect.dhcp-dns">10.7.2. DHCP y DNS</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.network-diagnosis-tools.html">10.8. Herramientas de diagnóstico de red</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.network-diagnosis-tools.html#sect.netstat">10.8.1. Diagnóstico local: <code
                        class="command">netstat</code></a></span></dt><dt><span
                    class="section"><a
                      href="sect.network-diagnosis-tools.html#sect.nmap">10.8.2. Diagnóstico remoto: <code
                        class="command">nmap</code></a></span></dt><dt><span
                    class="section"><a
                      href="sect.network-diagnosis-tools.html#sect.sniffers">10.8.3. «Sniffers»: <code
                        class="command">tcpdump</code> y <code
                        class="command">wireshark</code></a></span></dt></dl></dd></dl></div><div
          class="highlights"><div
            class="para">
		Linux goza de toda la herencia de Unix sobre redes, y Debian provee un conjunto completo de herramientas para crear y administrarlas. Este capítulo examina estas herramientas.
	</div></div><div
          class="section"><div
            class="titlepage"><div><div><h2
                  class="title"><a
                    id="sect.gateway"></a>10.1. Puerta de enlace</h2></div></div></div><div
            class="para">
			Una puerta de enlace es un sistema que enlaza varias redes. Este término usualmente se refiere al «punto de salida» de una red local en el camino obligatorio hacia las direcciones IP externas. La puerta de enlace está conectada a cada una de las redes que enlaza y actúa como router para transmitir paquetes IP entre sus varias interfaces.
		</div><a
            id="idm140447115301232"
            class="indexterm"></a><a
            id="idm140447111472032"
            class="indexterm"></a><a
            id="idm140447114866352"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>VOLVER A LOS CIMIENTOS</em></span> Paquete IP</strong></p></div></div></div><a
              id="idm140447111536768"
              class="indexterm"></a><div
              class="para">
			La mayoría de las redes hoy en día utilizan el protocolo IP (protocolo de Internet: «<span
                class="emphasis"><em>Internet Protocol</em></span>). Este protocolo segmenta los datos transmitidos en paquetes de tamaño limitado. Cada paquete contiene, además de sus datos como carga útil, algunos detalles necesarios para enrutarlos apropiadamente.
		</div></div><div
            class="sidebar"><a
              id="sidebar.tcp-udp"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>VOLVER A LOS CIMIENTOS</em></span> TCP/UDP</strong></p></div></div></div><a
              id="idm140447110891616"
              class="indexterm"></a><a
              id="idm140447110890176"
              class="indexterm"></a><a
              id="idm140447111493440"
              class="indexterm"></a><a
              id="idm140447111492480"
              class="indexterm"></a><div
              class="para">
			Muchos programas no gestionan los paquetes individuales por sí mismos aunque los datos que transmiten viajan por IP; generalmente utilizan TCP (protocolo de control de transmisión: «<span
                class="emphasis"><em>Transmission Control Protocol</em></span>»). TCP es una capa sobre IP que permite establecer conexiones dedicadas a flujos de datos entre dos puntos. Los programas sólo ven, entonces, un punto de entrada en el que pueden verter datos con la garantía que los mismos datos existirán sin pérdida (y en el mismo orden) en el punto de salida en el otro extremo de la conexión. Si bien pueden ocurrir muchos tipos de errores en las capas inferiores, TCP los compensa: retransmite paquetes perdidos y reordena apropiadamente los paquetes que lleguen fuera de orden (por ejemplo si utilizaron caminos diferentes).
		</div><div
              class="para">
			Otro protocolo sobre IP es UDP (protocolo de datagramas de usuario: «<span
                class="emphasis"><em>User Datagram Protocol</em></span>). A diferencia de TCP, está orientado a paquetes. Sus objetivos son diferentes: el propósito de UDP sólo es transmitir un paquete de una aplicación a otra. El protocolo no intenta compensar la posible pérdida de paquetes en el camino, así como tampoco asegura que los paquetes sean recibidos en el mismo orden en el que se los envió. La principal ventaja de este protocolo es que mejora enormemente la latencia ya que la pérdida de un paquete no demora la recepción de todos los paquetes siguientes hasta que se retransmita aquél perdido.
		</div><div
              class="para">
			Tanto TCP como UDP involucran puertos, que son «números de extensión» para establecer comunicaciones con una aplicación particular en una máquina. Este concepto permite mantener varias comunicaciones diferentes en paralelo con el mismo correspondiente debido a que se pueden diferenciar estas comunicaciones por el número de puerto.
		</div><div
              class="para">
			Algunos de estos números de puerto — estandarizados por IANA (autoridad de números asignados en Internet: «<span
                class="emphasis"><em>Internet Assigned Numbers Authority</em></span>») — son «muy conocidos» por estar asociados con servicios de red. Por ejemplo, generalmente el servidor de correo utiliza el puerto TCP 25. <div
                class="url">→ <a
                  href="http://www.iana.org/assignments/port-numbers">http://www.iana.org/assignments/port-numbers</a></div>
		</div></div><div
            class="para">
			Cuando una red local utiliza un rango de direcciones privadas (no enrutables en Internet), la puerta de enlace necesita implementar <span
              class="emphasis"><em>enmascarado de dirección</em></span> («address masquerading») para que los equipos en la red puedan comunicarse con el mundo exterior. La operación de enmascarado es un tipo de proxy que funciona a nivel de red: se reemplaza cada conexión saliente de una máquina interna con una conexión desde la puerta de enlace misma (ya que la puerta de enlace tiene una dirección externa y enrutable), los datos que pasan a través de la conexión enmascarada son enviados a la nueva conexión y los datos recibidos en respuesta son enviados a través de la conexión enmascarada a la máquina interna. La puerta de enlace utiliza un rango de puertos TCP dedicados para este propósito, generalmente con números muy altos (mayores a 60000). Cada conexión que proviene de una máquina interna parece, para el mundo exterior, una conexión que proviene de uno de esos puertos reservados.
		</div><a
            id="idm140447103684288"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>CULTURA</em></span> Rango de direcciones privadas</strong></p></div></div></div><a
              id="idm140447103682240"
              class="indexterm"></a><a
              id="idm140447103680800"
              class="indexterm"></a><div
              class="para">
			El RFC 1918 define tres rangos de direcciones IPv4 que no deben ser viables en Internet sino sólo utilizadas en redes locales. El primero, <code
                class="literal">10.0.0.0/8</code> (revise el recuadro <a
                class="xref"
                href="sect.network-config.html#sidebar.networking-basics"><span
                  class="emphasis"><em>VOLVER A LOS CIMIENTOS</em></span> Conceptos de red esenciales (Ethernet, dirección IP, subred, difusión).</a>) es un rango clase A (con 2<sup>24</sup> direcciones IP). El segundo, <code
                class="literal">172.16.0.0/12</code>, reúne 16 rangos clase B (<code
                class="literal">172.16.0.0/16</code> a <code
                class="literal">172.31.0.0/16</code>), cada uno de los cuales contiene 2<sup>16</sup> direcciones IP. Finalmente, <code
                class="literal">192.168.0.0/16</code> es un rango clase B (agrupando 256 rangos clase C, <code
                class="literal">192.168.0.0/24</code> a <code
                class="literal">192.168.255.0/24</code>, con 256 direcciones IP cada uno). <div
                class="url">→ <a
                  href="http://www.faqs.org/rfcs/rfc1918.html">http://www.faqs.org/rfcs/rfc1918.html</a></div>
		</div></div><div
            class="para">
			La puerta de enlace también puede realizar dos tipos de <span
              class="emphasis"><em>traducción de direcciones de red</em></span> («Network Address Translation» o NAT). El primer tipo, <span
              class="emphasis"><em>NAT de destino</em></span> (DNAT) es una técnica para alterar la dirección IP de destino (y/o el puerto TCP o UDP) para una conexión (generalmente) entrante. El mecanismo de seguimiento de conexiones también altera los paquetes siguientes en la misma conexión para asegurar continuidad en la comunicación. El segundo tipo de NAT es <span
              class="emphasis"><em>NAT de origen</em></span> (SNAT), del que el <span
              class="emphasis"><em>enmascarado</em></span> es un caso particular; SNAT modifica la dirección IP de origen (y/o el puerto TCP o UDP) de una conexión (generalmente) saliente. En lo que respecta a DNAT, todos los paquetes en la conexión son gestionados de forma apropiada por el mecanismo de seguimiento de conexiones. Sepa que NAT sólo es relevante para IPv4 y su espacio de direcciones limitado; en IPv6, la amplia disponibilidad de direcciones reduce enormemente la utilidad de NAT permitiendo que todas las direcciones «internas» sean enrutables directamente en Internet (esto no implica que se pueda acceder a las máquinas internas ya que los firewalls intermedios puede filtrar el tráfico).
		</div><a
            id="idm140447102180928"
            class="indexterm"></a><a
            id="idm140447102179968"
            class="indexterm"></a><a
            id="idm140447102178560"
            class="indexterm"></a><a
            id="idm140447102177600"
            class="indexterm"></a><a
            id="idm140447102176640"
            class="indexterm"></a><a
            id="idm140447102175680"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>VOLVER A LOS CIMIENTOS</em></span> Redirección de puertos</strong></p></div></div></div><a
              id="idm140447102173632"
              class="indexterm"></a><div
              class="para">
			Una aplicación concreta de DNAT es <span
                class="emphasis"><em>redirección de puertos</em></span> («port forwarding»). Las conexiones entrantes a un puerto dado de una máquina son redireccionados a un puerto en otra máquina. Sin embargo, pueden existir otras soluciones para conseguir un efecto similar, especialmente a nivel de aplicación con <code
                class="command">ssh</code> (revise la <a
                class="xref"
                href="sect.remote-login.html#sect.ssh-port-forwarding">Sección 9.2.1.3, “Creación de túneles cifrados con redirección de puertos”</a>) o <code
                class="command">redir</code>.
		</div></div><div
            class="para">
			Suficiente teoría, pongámonos prácticos. Convertir un sistema Debian en una puerta de enlace sólo es cuestión de activar la opción apropiada en el núcleo Linux a través del sistema de archivos virtual <code
              class="filename">/proc/</code>:
		</div><pre
            class="screen">
<code
              class="computeroutput"># </code><strong
              class="userinput"><code>echo 1 &gt; /proc/sys/net/ipv4/conf/default/forwarding</code></strong></pre><div
            class="para">
			También se puede activar esta opción automáticamente durante el inicio si <code
              class="filename">/etc/sysctl.conf</code> define la opción <code
              class="literal">net.ipv4.conf.default.forwarding</code> como <code
              class="literal">1</code>.
		</div><div
            class="example"><a
              id="example.sysctl.conf"></a><p
              class="title"><strong>Ejemplo 10.1. El archivo <code
                  class="filename">/etc/sysctl.conf</code></strong></p><div
              class="example-contents"><pre
                class="programlisting">
net.ipv4.conf.default.forwarding = 1
net.ipv4.conf.default.rp_filter = 1
net.ipv4.tcp_syncookies = 1
</pre></div></div><div
            class="para">
			Puede conseguir el mismo efecto para IPv6 simplemente reemplazando <code
              class="literal">ipv4</code> con <code
              class="literal">ipv6</code> en la orden manual y utilizando la línea <code
              class="literal">net.ipv6.conf.all.forwarding</code> en <code
              class="filename">/etc/sysctl.conf</code>.
		</div><div
            class="para">
			Activar enmascarado de IPv4 es una operación un poco más compleja que involucra configurar el firewall <span
              class="emphasis"><em>netfilter</em></span>.
		</div><div
            class="para">
			De forma similar, utilizar NAT (para IPv4) necesita configurar <span
              class="emphasis"><em>netfilter</em></span>. Debido a que el propósito principal de este componente es filtrar paquetes, se enumeran los detalles en el <a
              class="xref"
              href="security.html">Capítulo 14: “<em>Seguridad</em>”</a> (revise la <a
              class="xref"
              href="sect.firewall-packet-filtering.html">Sección 14.2, “Firewall o el filtrado de paquetes”</a>).
		</div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.power-management.html"><strong>Anterior</strong>9.12. Gestión de energía: interfaz avanzada de co...</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Subir</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Inicio</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.virtual-private-network.html"><strong>Siguiente</strong>10.2. Red virtual privada</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/network-infrastructure.html">ar-MA</a></li><li><a
              href="../da-DK/network-infrastructure.html">da-DK</a></li><li><a
              href="../de-DE/network-infrastructure.html">de-DE</a></li><li><a
              href="../el-GR/network-infrastructure.html">el-GR</a></li><li><a
              href="../en-US/network-infrastructure.html">en-US</a></li><li><a
              href="../es-ES/network-infrastructure.html">es-ES</a></li><li><a
              href="../fa-IR/network-infrastructure.html">fa-IR</a></li><li><a
              href="../fr-FR/network-infrastructure.html">fr-FR</a></li><li><a
              href="../hr-HR/network-infrastructure.html">hr-HR</a></li><li><a
              href="../id-ID/network-infrastructure.html">id-ID</a></li><li><a
              href="../it-IT/network-infrastructure.html">it-IT</a></li><li><a
              href="../ja-JP/network-infrastructure.html">ja-JP</a></li><li><a
              href="../pl-PL/network-infrastructure.html">pl-PL</a></li><li><a
              href="../pt-BR/network-infrastructure.html">pt-BR</a></li><li><a
              href="../ro-RO/network-infrastructure.html">ro-RO</a></li><li><a
              href="../ru-RU/network-infrastructure.html">ru-RU</a></li><li><a
              href="../tr-TR/network-infrastructure.html">tr-TR</a></li><li><a
              href="../zh-CN/network-infrastructure.html">zh-CN</a></li></ul></div></body></html>
