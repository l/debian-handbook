<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">Capítulo 15. Creación de un paquete Debian</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.1" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-es-ES-1.0-1" /><meta
        name="keywords"
        content="Retroadaptación, Recompilación, Paquete fuente, Repositorio, Metapaquete, Desarrollador Debian, Responsable" /><link
        rel="home"
        href="index.html"
        title="El libro del administrador de Debian" /><link
        rel="up"
        href="index.html"
        title="El libro del administrador de Debian" /><link
        rel="prev"
        href="sect.dealing-with-compromised-machine.html"
        title="14.6. Tratamiento de una máquina comprometida" /><link
        rel="next"
        href="sect.building-first-package.html"
        title="15.2. Creación de su primer paquete" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/es-ES/debian-packaging.html" /></head><body
      class="draft "><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="http://debian-handbook.info"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.dealing-with-compromised-machine.html"><strong>Anterior</strong></a></li><li
          class="home">El libro del administrador de Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.building-first-package.html"><strong>Siguiente</strong></a></li></ul><div
        xml:lang="es-ES"
        class="chapter"
        lang="es-ES"><div
          class="titlepage"><div><div><h1
                class="title"><a
                  id="debian-packaging"></a>Capítulo 15. Creación de un paquete Debian</h1></div></div></div><div
          class="toc"><dl
            class="toc"><dt><span
                class="section"><a
                  href="debian-packaging.html#sect.rebuilding-package">15.1. Recompilación de un paquete desde sus fuentes</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="debian-packaging.html#idm140502905797760">15.1.1. Obtención de las fuentes</a></span></dt><dt><span
                    class="section"><a
                      href="debian-packaging.html#idm140502916798896">15.1.2. Realización de cambios</a></span></dt><dt><span
                    class="section"><a
                      href="debian-packaging.html#idm140502898443312">15.1.3. Inicio de la recompilación</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.building-first-package.html">15.2. Creación de su primer paquete</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.building-first-package.html#idm140502896283904">15.2.1. Metapaquetes o paquetes falsos</a></span></dt><dt><span
                    class="section"><a
                      href="sect.building-first-package.html#idm140502917311616">15.2.2. Simple compendio de archivos</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.setup-apt-package-repository.html">15.3. Creación de un repositorio de paquetes para APT</a></span></dt><dt><span
                class="section"><a
                  href="sect.becoming-package-maintainer.html">15.4. Cómo convertirse en un encargado de paquetes</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.becoming-package-maintainer.html#idm140502897621776">15.4.1. Aprendizaje de creación de paquetes</a></span></dt><dt><span
                    class="section"><a
                      href="sect.becoming-package-maintainer.html#idm140502897555120">15.4.2. Proceso de aceptación</a></span></dt></dl></dd></dl></div><div
          class="highlights"><div
            class="para">
		Es muy común para un administrador Debian que gestiona diariamente paquetes Debian finalmente sentir la necesidad de crear sus propios paquetes o modificar un paquete existente. Este capítulo pretende dar respuesta a las preguntas más comunes en este campo y proporcionar los elementos necesarios para aprovechar lo mejor posible la infraestructura de Debian. Con un poco de suerte, después de probar con paquetes locales, incluso puede sentir la necesidad de ir más allá y ¡unirse al proyecto Debian en sí!
	</div></div><div
          class="section"><div
            class="titlepage"><div><div><h2
                  class="title"><a
                    id="sect.rebuilding-package"></a>15.1. Recompilación de un paquete desde sus fuentes</h2></div></div></div><div
            class="para">
			Son varias las cirunstancias bajo las que es necesario reconstruir un paquete binario. En algunos casos, el administrador necesita una funcionalidad del software para la que necesitará compilarlo desde sus fuentes con alguna opción de compilación particular; en otras, el software empaquetado para la versión de Debian instalada no es suficientemente reciente. En el último caso, el administrador generalmente compilará un paquete más reciente que obtendrá de una versión más reciente de Debian — como <span
              class="distribution distribution">Testing</span> o inclusive <span
              class="distribution distribution">Unstable</span> — para que este nuevo paquete funcione con su distribución <span
              class="distribution distribution">Stable</span>; esta operación es llamada «retroadaptación» («backporting»). Como siempre, antes de embarcarse en esta tarea, se debe revisar si no fue hecha ya — revise rápidamente la página de este paquete en el sistema de seguimiento de paquetes para encontrar esta información. <div
              class="url">→ <a
                href="http://packages.qa.debian.org/">http://packages.qa.debian.org/</a></div> <a
              id="idm140502900871520"
              class="indexterm"></a>
		</div><div
            class="section"><div
              class="titlepage"><div><div><h3
                    class="title"><a
                      id="idm140502905797760"></a>15.1.1. Obtención de las fuentes</h3></div></div></div><div
              class="para">
				Lo primero para recompilar un paquete Debian es obtener su código fuente. La forma más sencilla es utilizando <code
                class="command">apt-get source <em
                  class="replaceable">nombre-paquete-fuente</em></code>. Para ello necesitará una línea <code
                class="literal">deb-src</code> en el archivo <code
                class="filename">/etc/apt/sources.list</code> y archivos de índice actualizados (es decir: <code
                class="command">apt-get update</code>). Si siguió las instrucciones en el capítulo sobre la configuración de APT (revise la <a
                class="xref"
                href="apt.html#sect.apt-sources.list">Sección 6.1, “Contenido del archivo <code
                  class="filename">sources.list</code>”</a>) debería cumplir estas condiciones. Sepa, sin embargo, que descargará los paquetes fuente de la versión Debian mencionada en la línea <code
                class="literal">deb-src</code>. Si necesita otra versión probablemente necesite descargarla manualmente de un repositorio Debian o desde el sitio web. Para ello debe obtener dos o tres archivos (con extensiones <code
                class="filename">*.dsc</code> — por <span
                class="emphasis"><em>control de fuente Debian</em></span>: «Debian Source Control» — <code
                class="filename">*.tar.<em
                  class="replaceable">comp</em></code> y a veces <code
                class="filename">*.diff.gz</code> o <code
                class="filename">*.debian.tar.<em
                  class="replaceable">comp</em></code> — donde el valor de <em
                class="replaceable">comp</em> es uno de <code
                class="literal">gz</code>, <code
                class="literal">bz2</code>, <code
                class="literal">lzma</code> o <code
                class="literal">xz</code> dependiendo de la herramienta de compresión utilizada), luego ejecute <code
                class="command">dpkg-source -x <em
                  class="replaceable">archivo.dsc</em></code>. Si puede acceder directamente al archivo <code
                class="filename">*.dsc</code> a través de una URL existe una forma más sencilla de obtener todo ejecutando <code
                class="command">dget <em
                  class="replaceable">URL</em></code>. Este programa (que puede encontrar en el paquete <span
                class="pkg pkg">devscripts</span>) obtiene el archivo <code
                class="filename">*.dsc</code> en la dirección provista, analiza su contenido y obtiene automáticamente el o los archivos a los que hace referencia. Con la opción <code
                class="literal">-x</code> inclusive se descomprime localmente el paquete fuente una vez que fue descargado.
			</div></div><div
            class="section"><div
              class="titlepage"><div><div><h3
                    class="title"><a
                      id="idm140502916798896"></a>15.1.2. Realización de cambios</h3></div></div></div><div
              class="para">
				Ahora tiene las fuentes del paquete disponibles en un directorio cuyo nombre coincide con el paquete fuente y su versión (por ejemplo: <span
                class="emphasis"><em>samba-3.6.16</em></span>); allí es donde trabajaremos en nuestros cambios locales.
			</div><div
              class="para">
				Lo primero que debemos hacer es cambiar el número de versión del paquete para que podamos distinguir el paquete recompilado del paquete original que provee Debian. Si asumimos que la versión actual es <code
                class="literal">3.6.16-2</code> podemos crear la versión <code
                class="literal">3.6.16-2falcot1</code>, que indica claramente el origen del paquete. Esto además hace que el número de versión del paquete sea mayor al del que provee Debian para que el paquete se instalará fácilmente como una actualización al paquete original. La mejor forma de realizar dicho cambio es con el programa <code
                class="command">dch</code> (por <span
                class="emphasis"><em>cambios Debian</em></span>: «Debian CHangelog») del paquete <span
                class="pkg pkg">devscripts</span> ejecutando algo similar a <code
                class="command">dch --local falcot1</code>. Esto invoca un editor de texto (<code
                class="command">sensible-editor</code> — este debería ser tu editor favorito si es mencionado en las variables de entorno <code
                class="varname">VISUAL</code> o <code
                class="varname">EDITOR</code> o el editor predeterminado de lo contrario) que nos permitirá documentar las diferencias introducidas en esta recompilación. Este editor nos mostrará que <code
                class="command">dch</code> realmente cambió el archivo <code
                class="filename">debian/changelog</code>.
			</div><div
              class="para">
				Cuando necesitamos cambiar las opciones de compilación, debemos realizar cambios a <code
                class="filename">debian/rules</code>, el cual se encarga de todos los pasos en el proceso de compilación del paquete. En los casos más simples, es sencillo encontrar las líneas sobre la configuración inicial (<code
                class="literal">./configure …</code>) o la compilación en sí (<code
                class="literal">$(MAKE) …</code> o <code
                class="literal">make …</code>). Si no se ejecutan específicamente estos programas probablemente son un efecto secundario de otra orden explícita, en cuyo caso refiérase a la documentación de las mismas para aprender cómo cambiar el comportamiento predeterminado.
			</div><div
              class="para">
				Dependiendo de los cambios locales a los paquetes, también podría necesitar actualizar el archivo <code
                class="filename">debian/control</code>, que contiene una descripción de los paquetes generados. En particular, este paquete contiene líneas <code
                class="literal">Build-Depends</code> que controlan la lista de dependencias que se deben cumplir en el momento de compilar un paquete. Éstas líneas generalmente hacen referencia a las versiones de los paquetes que se encuentran en la distribución de la que proveen los paquetes fuente pero que pueden no estar disponibles en la distribución en la que estamos recompilando. No hay una forma automatizada para determinar si una dependencia es real o sólo está presente para garantizar que sólo se intente compilar con la última versión de una biblioteca — esta es la única forma de forzar que <span
                class="emphasis"><em>autobuilder</em></span> utilice una versión específica de un paquete durante su compilación, por lo que los desarrolladores Debian frecuentemente utilizan dependencias de compilación con versiones estrictas.
			</div><div
              class="para">
				Si está seguro que estas dependencias de compilación son muy estrictas, siéntase libre de relajarlas localmente. Lea los archivos que documentan la forma estándar de compilar el software — generalmente estos archivos son llamados <code
                class="filename">INSTALL</code> — le ayudarán a encontrar las dependencias adecuadas. Idealmente, podrá satisfacer todas las dependencias en la distribución que utilice para recompilar; de lo contrario, comienza un proceso recursivo en el que debemos retroadaptar los paquetes mencionados en el campo <code
                class="literal">Build-Depends</code> antes de poder finalizar con el paquete deseado. Algunos paquetes pueden no necesitar ser retroadaptados y puede instalarlos tal cual durante el proceso de compilación (un ejemplo notable es <span
                class="pkg pkg">debhelper</span>). Sepa que el proceso de retroadaptación puede volverse muy complejo rápidamente si no tiene cuidado. Por lo tanto, debe mantener al mínimo las retroadaptaciones siempre que sea posible.
			</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>SUGERENCIA</em></span> Instalación de <code
                          class="literal">Build-Depends</code></strong></p></div></div></div><div
                class="para">
				<a
                  id="idm140502917170720"
                  class="indexterm"></a> <code
                  class="command">apt-get</code> permite instalar todos los paquetes mencionados en los campos <code
                  class="literal">Build-Depends</code> de un paquete fuente disponible en una distribución mencionada en una línea <code
                  class="literal">deb-src</code> del archivo <code
                  class="filename">/etc/apt/sources.list</code>. Esto es simple cuestión de ejecutar <code
                  class="command">apt-get build-dep <em
                    class="replaceable">paquete-fuente</em></code>.
			</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h3
                    class="title"><a
                      id="idm140502898443312"></a>15.1.3. Inicio de la recompilación</h3></div></div></div><div
              class="para">
				Cuando aplicamos los cambios necesarios a las fuentes, podemos comenzar la generación del paquete binario (archivo <code
                class="filename">.deb</code>). El programa <code
                class="command">dpkg-buildpackage</code> gestiona todo el proceso.
			</div><div
              class="example"><a
                id="idm140502898441024"></a><p
                class="title"><strong>Ejemplo 15.1. Recompilación del paquete</strong></p><div
                class="example-contents"><pre
                  class="screen">
<code
                    class="computeroutput">$ </code><strong
                    class="userinput"><code>dpkg-buildpackage -us -uc</code></strong>
[...]
</pre></div></div><div
              class="sidebar"><a
                id="sidebar.fakeroot"></a><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>HERRAMIENTA</em></span> <code
                          class="command">fakeroot</code></strong></p></div></div></div><div
                class="para">
				En esencia, el proceso de creación de un paquete es simple cuestión de reunir en un compendio un conjunto de archivos existentes (o compilados); en dicho compendio <span
                  class="emphasis"><em>root</em></span> será el dueño de la mayoría de los archivos del compendio. Sin embargo, crear todo el paquete bajo este usuario aumentaría los riesgos; afortunadamente, podemos evitar esto con el programa <code
                  class="command">fakeroot</code>. Podemos utilizar esta herramienta para ejecutar un programa y darle la impresión que está ejecutando como <span
                  class="emphasis"><em>root</em></span> y crea archivos con permisos y dueños arbitrarios. Cuando el programa crea el compendio que será el paquete Debian, se lo engaña para que cree un compendio con archivos con dueños arbitrarios, incluyendo <span
                  class="emphasis"><em>root</em></span>. Esta configuración es tan conveniente que <code
                  class="command">dpkg-buildpackage</code> utiliza <code
                  class="command">fakeroot</code> de forma predeterminada cuando genera paquetes.
			</div><div
                class="para">
				Sepa que sólo se engaña al programa para que «crea» que funciona bajo una cuenta con privilegios, pero el proceso realmente ejecuta como el usuario que ejecutó <code
                  class="command">fakeroot <em
                    class="replaceable">programa</em></code> (y se crean los archivos con los permisos de dicho usuario). En ningún momento realmente obtiene privilegios de root que pueda abusar.
			</div></div><div
              class="para">
				El programa anterior puede fallar si no se actualizaron los campos <code
                class="literal">Build-Depends</code> o si no están instalados los paquetes relacionados. En tal caso, es posible evitar este chequeo con la opción <code
                class="literal">-d</code> de <code
                class="command">dpkg-buildpackage</code>. Sin embargo, al ignorar explícitamente estas dependencias corre el riesgo de que el proceso de compilación falle en una etapa posterior. Lo que es peor, el paquete puede parecer compilar correctamente pero no ejecutar correctamente: algunos programas desactivan automáticamente algunas de sus funcionalidades cuando una biblioteca necesaria no está disponible al momento de compilarlo.
			</div><div
              class="para">
				La mayoría de las veces, los desarrolladores Debian utilizan un programa de alto nivel como <code
                class="command">debuild</code>; éste ejecuta <code
                class="command">dpkg-buildpackage</code> normalmente, pero también agrega una invocación de un programa que ejecuta muchos chequeos para validar el paquete generado según la normativa Debian. Este script también limpia el entorno para que las variables de entorno locales no «contaminen» la compilación del paquete. El programa <code
                class="command">debuild</code> es una de las herramientas de <span
                class="emphasis"><em>devscripts</em></span>, que comparte un poco de consistencia y configuración para facilitar la tarea del desarrollador.
			</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>VISTA RÁPIDA</em></span> <code
                          class="command">pbuilder</code></strong></p></div></div></div><a
                id="idm140502896291984"
                class="indexterm"></a><div
                class="para">
				El programa <code
                  class="command">pbuilder</code> (en el paquete del mismo nombre) permite crear un paquete Debian en un entorno <span
                  class="emphasis"><em>chroot</em></span>. Primero crea un directorio temporal que contiene el sistema mínimo necesario para crear el paquete (incluyendo los paquetes mencionados en el campo <span
                  class="emphasis"><em>Build-Depends</em></span>). Luego utiliza este directorio como raíz (<code
                  class="filename">/</code>) con el programa <code
                  class="command">chroot</code> durante el proceso de compilación.
			</div><div
                class="para">
				Esta herramienta permite que el proceso de compilación ocurra en un entorno que no fue modificado por el usuario. Esto también permite una detección rápida de las dependencias de compilación faltantes (ya que la compilación fallará a menos que las dependencias apropiadas estén documentadas). Finalmente, permite crear un paquete para una versión de Debian que no es la instalada en el sistema: el equipo puede estar utilizando <span
                  class="distribution distribution">Stable</span> para su trabajo normal, pero <code
                  class="command">pbuilder</code> en el mismo equipo puede utilizar <span
                  class="distribution distribution">Unstable</span> para compilar paquetes.
			</div></div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.dealing-with-compromised-machine.html"><strong>Anterior</strong>14.6. Tratamiento de una máquina comprometida</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Subir</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Inicio</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.building-first-package.html"><strong>Siguiente</strong>15.2. Creación de su primer paquete</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/debian-packaging.html">ar-MA</a></li><li><a
              href="../da-DK/debian-packaging.html">da-DK</a></li><li><a
              href="../de-DE/debian-packaging.html">de-DE</a></li><li><a
              href="../el-GR/debian-packaging.html">el-GR</a></li><li><a
              href="../en-US/debian-packaging.html">en-US</a></li><li><a
              href="../es-ES/debian-packaging.html">es-ES</a></li><li><a
              href="../fa-IR/debian-packaging.html">fa-IR</a></li><li><a
              href="../fr-FR/debian-packaging.html">fr-FR</a></li><li><a
              href="../hr-HR/debian-packaging.html">hr-HR</a></li><li><a
              href="../id-ID/debian-packaging.html">id-ID</a></li><li><a
              href="../it-IT/debian-packaging.html">it-IT</a></li><li><a
              href="../ja-JP/debian-packaging.html">ja-JP</a></li><li><a
              href="../pl-PL/debian-packaging.html">pl-PL</a></li><li><a
              href="../pt-BR/debian-packaging.html">pt-BR</a></li><li><a
              href="../ro-RO/debian-packaging.html">ro-RO</a></li><li><a
              href="../ru-RU/debian-packaging.html">ru-RU</a></li><li><a
              href="../tr-TR/debian-packaging.html">tr-TR</a></li><li><a
              href="../zh-CN/debian-packaging.html">zh-CN</a></li></ul></div></body></html>
