<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">14.2. Firewall o filtraggio dei pacchetti</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.1" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-it-IT-1.0-1" /><meta
        name="keywords"
        content="Firewall, Netfilter, IDS/NIDS" /><link
        rel="home"
        href="index.html"
        title="Il manuale dell'amministratore Debian" /><link
        rel="up"
        href="security.html"
        title="Capitolo 14. Sicurezza" /><link
        rel="prev"
        href="security.html"
        title="Capitolo 14. Sicurezza" /><link
        rel="next"
        href="sect.supervision.html"
        title="14.3. Supervisione: prevenire, rilevare, dissuadere" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/it-IT/sect.firewall-packet-filtering.html" /></head><body
      class="draft "><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="http://debian-handbook.info"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="security.html"><strong>Indietro</strong></a></li><li
          class="home">Il manuale dell'amministratore Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.supervision.html"><strong>Avanti</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.firewall-packet-filtering"></a>14.2. Firewall o filtraggio dei pacchetti</h2></div></div></div><a
          id="idm140108834122512"
          class="indexterm"></a><a
          id="idm140108834121552"
          class="indexterm"></a><a
          id="idm140108851010896"
          class="indexterm"></a><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>FONDAMENTALI</em></span> Firewall</strong></p></div></div></div><a
            id="idm140108851008816"
            class="indexterm"></a><div
            class="para">
			Il <span
              class="emphasis"><em>firewall</em></span> è un componente informatico provvisto di hardware e/o software che smista i pacchetti di rete in ingresso o uscita (che arrivano o lasciano la rete locale) e li lascia passare solo se soddisfano determinati criteri predefiniti.
		</div></div><div
          class="para">
			Il firewall è un punto di filtraggio di rete ed è efficace solo per i pacchetti che devono transitare da esso. Perciò può essere efficace solo se il passaggio attraverso il firewall è l'unico instradamento possibile per quei pacchetti.
		</div><div
          class="para">
			La mancanza di una configurazione standard (e il motto «processo, non prodotto») spiega l'assenza di una soluzione chiavi in mano. Ci sono, comunque, strumenti che semplificano la configurazione del firewall <span
            class="emphasis"><em>netfilter</em></span>, con una rappresentazione grafica delle regole di filtraggio. <code
            class="command">fwbuilder</code> tra questi è senza dubbio uno dei migliori.
		</div><a
          id="idm140108851003760"
          class="indexterm"></a><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>CASO SPECIFICO</em></span> Firewall Locale</strong></p></div></div></div><div
            class="para">
			Un firewall può essere limitato ad una particolare macchina (a differenza di un'intera rete), nel qual caso la sua funzione è quella di filtrare o limitare l'accesso ad alcuni servizi, oppure di impedire connessioni uscenti a software malevolo che un utente, volente o nolente, potrebbe aver installato.
		</div></div><div
          class="para">
			The Linux kernel embeds the <span
            class="emphasis"><em>netfilter</em></span> firewall. It can be controlled from user-space with the <code
            class="command">iptables</code> and <code
            class="command">ip6tables</code> commands. The difference between these two commands is that the former acts on the IPv4 network, whereas the latter acts on IPv6. Since both network protocol stacks will probably be around for many years, both tools will need to be used in parallel.
		</div><a
          id="idm140108834205200"
          class="indexterm"></a><a
          id="idm140108834204080"
          class="indexterm"></a><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.netfilter"></a>14.2.1. Funzionamento di netfilter</h3></div></div></div><div
            class="para">
				<span
              class="emphasis"><em>netfilter</em></span> utilizza quattro tabelle distinte nelle quali memorizza le regole che controllano tre tipologie di operazioni sui pacchetti:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">filter</code> riguarda le regole di filtraggio (accettare, rifiutare o ignorare un pacchetto);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">nat</code> riguarda la traduzione di indirizzi e porte di origine o di destinazione dei pacchetti; da notare che questa tabella esiste solo per l'IPv4;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">mangle</code> riguarda altre trasformazioni sui pacchetti IP (inclusi il campo e le opzioni del ToS: <span
                    class="emphasis"><em>Type of Service</em></span>);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">raw</code> permette altre modifiche manuali sui pacchetti prima che giungano al sistema di monitoraggio delle connessioni.
					</div></li></ul></div><div
            class="para">
				Ogni tabella contiene delle liste di regole chiamate <span
              class="emphasis"><em>catene</em></span>. Per gestire i pacchetti i firewall utilizzano catene standard in base a circostanze predefinite. L'amministratore può creare altre catene, che saranno utilizzate solo quando una delle catene standard vi fa riferimento (direttamente o indirettamente).
			</div><a
            id="idm140108834148560"
            class="indexterm"></a><a
            id="idm140108834147600"
            class="indexterm"></a><div
            class="para">
				La tabella <code
              class="literal">filter</code> contiene tre catene standard:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">INPUT</code>: riguarda i pacchetti che hanno come destinazione il firewall stesso;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">OUTPUT</code>: riguarda i pacchetti emessi dal firewall;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">FORWARD</code>: riguarda i pacchetti che transitano attraverso il firewall (che non è né la sorgente, né la destinazione).
					</div></li></ul></div><div
            class="para">
				Anche la tabella <code
              class="literal">nat</code> contiene tre catene standard:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">PREROUTING</code>: per modificare i pacchetti non appena arrivano;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">POSTROUTING</code>: per modificare i pacchetti quando sono pronti per essere spediti;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">OUTPUT</code>: per modificare i pacchetti generati dal firewall stesso.
					</div></li></ul></div><div
            class="figure"><a
              id="figure.chaines-netfilter"></a><div
              class="figure-contents"><div
                class="mediaobject"><img
                  src="images/netfilter.png"
                  alt="Relazione tra le catene netfilter" /></div></div><p
              class="title"><strong>Figura 14.1. Relazione tra le catene <span
                  class="emphasis"><em>netfilter</em></span></strong></p></div><div
            class="para">
				Ogni catena è una lista di regole; ogni regola è un insieme di condizioni e un'azione da intraprendere quando le condizioni sono soddisfatte. Quando viene analizzato un pacchetto, il firewall esamina la catena opportuna, regola per regola; quando le condizioni di una regola sono soddisfatte, esso, per continuare l'elaborazione, «salta» (da qui l'opzione <code
              class="literal">-j</code> dei comandi) all'azione specificata. Sono stati standardizzati i comportamenti più comuni ed esistono azioni dedicate per ognuno. Intraprendere una di queste azioni standard interrompe l'avanzamento nella catena, dato che il destino del pacchetto è già stato deciso (salvo l'eccezione descritta in seguito):
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>FONDAMENTALI</em></span> ICMP</strong></p></div></div></div><div
              class="para">
				ICMP (<span
                class="emphasis"><em>Internet Control Message </em></span>Protocol) è il protocollo usato per trasmettere informazioni supplementari sulle comunicazioni. Permette di provare la connettività di rete con il comando <code
                class="command">ping</code> (che invia un messaggio ICMP di <span
                class="emphasis"><em>echo request</em></span>, al quale il destinatario risponde con un messaggio ICMP di <span
                class="emphasis"><em>echo reply</em></span>). Può rilevare un firewall che rifiuta un pacchetto, indicare l'overflow di un buffer di ricezione, proporre un instradamento migliore per i successivi pacchetti nella connessione e così via. Questo protocollo è definito in numerosi documenti RFC; le prime RFC777 e RFC792 sono state ben presto completate ed estese. <div
                class="url">→ <a
                  href="http://www.faqs.org/rfcs/rfc777.html">http://www.faqs.org/rfcs/rfc777.html</a></div><div
                class="url">→ <a
                  href="http://www.faqs.org/rfcs/rfc792.html">http://www.faqs.org/rfcs/rfc792.html</a></div>
			</div><div
              class="para">
				Per chiarezza, un buffer di ricezione è una piccola area di memoria che immagazzina i dati nel tempo che intercorre tra il loro arrivo dalla rete e la loro elaborazione da parte del kernel. Se quest'area si riempie, non possono esser ricevuti nuovi dati, e l'ICMP segnala il problema, così la sorgente può abbassare la velocità di trasferimento (che raggiungerà idealmente un equilibrio dopo un certo tempo).
			</div><a
              id="idm140108837490352"
              class="indexterm"></a><a
              id="idm140108837489392"
              class="indexterm"></a><a
              id="idm140108837488464"
              class="indexterm"></a><a
              id="idm140108837487504"
              class="indexterm"></a><a
              id="idm140108837486064"
              class="indexterm"></a><div
              class="para">
				Da notare che, anche se le reti IPv4 possono lavorare senza ICMP, ICMPv6 è strettamente necessario per le reti IPv6, dato che esse utilizzano molte funzioni che erano, per il mondo IPv4, fornite da ICMPv4, IGMP (<span
                class="emphasis"><em>Internet Group Membership Protocol</em></span>) e ARP (<span
                class="emphasis"><em>Address Resolution Protocol</em></span>). ICMPv6 è definito nella RFC4443. <div
                class="url">→ <a
                  href="http://www.faqs.org/rfcs/rfc4443.html">http://www.faqs.org/rfcs/rfc4443.html</a></div>
			</div></div><div
            class="para">
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">ACCEPT</code>: permette al pacchetto di continuare per la sua strada;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">REJECT</code>: rifiuta il pacchetto con un pacchetto di errore ICMP (l'opzione <code
                    class="literal">--reject-with <em
                      class="replaceable">tipo</em></code> di <code
                    class="command">iptables</code> permette di selezionare il tipo di errore);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">DROP</code>: elimina (ignora) il pacchetto;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">LOG</code>: registra (via <code
                    class="command">syslogd</code>) un messaggio con la descrizione del pacchetto; da notare che questa azione non interrompe l'elaborazione, e l'esecuzione della catena prosegue con la regola successiva, ed è per questo che per registrare i pacchetti rifiutati è necessario usare insieme una regola LOG e una REJECT o DROP;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">ULOG</code>: registra un messaggio via <code
                    class="command">ulogd</code>, che può essere maggiormente personalizzato ed è più efficiente di <code
                    class="command">syslogd</code> per analizzare una grande mole di messaggi; da notare che questa azione, come «LOG», anch'essa fa proseguire l'elaborazione con la regola successiva nella catena corrente;
					</div></li><li
                class="listitem"><div
                  class="para">
						<em
                    class="replaceable">nome_catena</em>: salta alla catena specificata ed elabora le relative regole;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">RETURN</code>: interrompe l'elaborazione della catena corrente, e ritorna alla catena chiamante; nel caso in cui la catena corrente sia standard, non esiste alcuna catena chiamante, perciò viene eseguita l'azione predefinita (specificata dall'opzione <code
                    class="literal">-P</code> di <code
                    class="command">iptables</code>);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">SNAT</code> (solo nella tabella <code
                    class="literal">nat</code>, quindi IPv4 in <span
                    class="distribution distribution">Wheezy</span> — supporto NAT per IPv6 è presente a partire dal kernel Linux 3.7): applica il <span
                    class="emphasis"><em>Sorgente NAT</em></span> (opzioni ulteriori descrivono l'esatta modifica da applicare);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">DNAT</code> (solo nella tabella <code
                    class="literal">nat</code>, quindi solo IPv4 in <span
                    class="distribution distribution">Wheezy</span>): applica la <span
                    class="emphasis"><em>Destinazione NAT</em></span> (opzioni ulteriori descrivono l'esatta modifica da applicare);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">MASQUERADE</code> (solo nella tabella <code
                    class="literal">nat</code>, quindi solo IPv4 in <span
                    class="distribution distribution">Wheezy</span>): applica il <span
                    class="emphasis"><em>mascheramento</em></span> (caso speciale di <span
                    class="emphasis"><em>Sorgente NAT</em></span>);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">REDIRECT</code> (solo nella tabella <code
                    class="literal">nat</code>, quindi solo IPv4 in <span
                    class="distribution distribution">Wheezy</span>): reinstrada un pacchetto verso una data porta dello stesso firewall; può essere usato per creare un proxy trasparente alla rete che funziona senza necessità di configurazioni lato client, dato che il client pensa di connettersi al destinatario mentre le comunicazioni in realtà attraversano il proxy.
					</div></li></ul></div><div
            class="para">
				Altre azioni, in particolare quelle riguardanti la tabella <code
              class="literal">mangle</code>, esulano dagli scopi di questo libro. Una lista integrale si ottiene con <span
              class="citerefentry"><span
                class="refentrytitle">iptables</span>(8)</span> e <span
              class="citerefentry"><span
                class="refentrytitle">ip6tables</span>(8)</span>.
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.iptables"></a>14.2.2. Sintassi di <code
                    class="command">iptables</code> e <code
                    class="command">ip6tables</code></h3></div></div></div><div
            class="para">
				I comandi <code
              class="command">iptables</code> e <code
              class="command">ip6tables</code> permettono la manipolazione di tabelle, catene e regole. L'opzione <code
              class="literal">-t <em
                class="replaceable">tabella</em></code> individua su quale tabella vanno ad operare (<code
              class="literal">filter</code> è la predefinita).
			</div><a
            id="idm140108831964000"
            class="indexterm"></a><a
            id="idm140108831962880"
            class="indexterm"></a><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="sect.iptables-command"></a>14.2.2.1. Comandi</h4></div></div></div><div
              class="para">
					The <code
                class="literal">-N <em
                  class="replaceable">chain</em></code> option creates a new chain. The <code
                class="literal">-X <em
                  class="replaceable">chain</em></code> deletes an empty and unused chain. The <code
                class="literal">-A <em
                  class="replaceable">chain</em> <em
                  class="replaceable">rule</em></code> adds a rule at the end of the given chain. The <code
                class="literal">-I <em
                  class="replaceable">chain</em> <em
                  class="replaceable">rule_num</em> <em
                  class="replaceable">rule</em></code> option inserts a rule before the rule number <em
                class="replaceable">rule_num</em>. The <code
                class="literal">-D <em
                  class="replaceable">chain</em> <em
                  class="replaceable">rule_num</em></code> (or <code
                class="literal">-D <em
                  class="replaceable">chain</em> <em
                  class="replaceable">rule</em></code>) option deletes a rule in a chain; the first syntax identifies the rule to be deleted by its number, while the latter identifies it by its contents. The <code
                class="literal">-F <em
                  class="replaceable">chain</em></code> option flushes a chain (deletes all its rules); if no chain is mentioned, all the rules in the table are deleted. The <code
                class="literal">-L <em
                  class="replaceable">chain</em></code> option lists the rules in the chain. Finally, the <code
                class="literal">-P <em
                  class="replaceable">chain</em> <em
                  class="replaceable">action</em></code> option defines the default action, or “policy”, for a given chain; note that only standard chains can have such a policy.
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="sect.iptables-rules"></a>14.2.2.2. Regole</h4></div></div></div><a
              id="idm140108831948256"
              class="indexterm"></a><div
              class="para">
					Each rule is expressed as <code
                class="literal"><em
                  class="replaceable">conditions</em> -j <em
                  class="replaceable">action</em> <em
                  class="replaceable">action_options</em></code>. If several conditions are described in the same rule, then the criterion is the conjunction (logical <span
                class="emphasis"><em>and</em></span>) of the conditions, which is at least as restrictive as each individual condition.
				</div><div
              class="para">
					La condizione <code
                class="literal">-p <em
                  class="replaceable">protocollo</em></code> verifica il campo protocollo del pacchetto IP. I valori più usati sono <code
                class="literal">tcp</code>, <code
                class="literal">udp</code>, <code
                class="literal">icmp</code> e <code
                class="literal">icmpv6</code>. Anteporre un punto esclamativo alla condizione la nega, facendola corrispondere a «qualunque pacchetto con un protocollo differente da quello specificato». Questa meccanismo di negazione non è specifico solo per l'opzione <code
                class="literal">-p</code>, ma può essere utilizzato anche per tutte le altre condizioni.
				</div><div
              class="para">
					La condizione <code
                class="literal">-s <em
                  class="replaceable">indirizzo</em></code> oppure <code
                class="literal">-s <em
                  class="replaceable">rete/maschera</em></code> verifica l'indirizzo sorgente del pacchetto. Ugualmente, <code
                class="literal">-d <em
                  class="replaceable">indirizzo</em></code> oppure <code
                class="literal">-d <em
                  class="replaceable">rete/maschera</em></code> verifica l'indirizzo destinazione.
				</div><div
              class="para">
					La condizione <code
                class="literal">-i <em
                  class="replaceable">interfaccia</em></code> seleziona i pacchetti provenienti dalla data interfaccia di rete. <code
                class="literal">-o <em
                  class="replaceable">interfaccia</em></code> seleziona quelli uscenti da una specifica interfaccia.
				</div><div
              class="para">
					Ci sono condizioni più specifiche, che dipendono da quelle generiche descritte sopra. Per esempio, la condizione <code
                class="literal">-p tcp</code> può essere raffinata con ulteriori condizioni sulle porte TCP, con clausole tipo <code
                class="literal">--source-port <em
                  class="replaceable">porta</em></code> e <code
                class="literal">--destination-port <em
                  class="replaceable">porta</em></code>.
				</div><div
              class="para">
					La condizione <code
                class="literal">--state <em
                  class="replaceable">stato</em></code> verifica lo stato di un pacchetto in una connessione (questa richiede il modulo del kernel <code
                class="command">ipt_conntrack</code>, per il monitoraggio delle connessioni). Lo stato <code
                class="literal">NEW</code> descrive un pacchetto che instaura una nuova connessione; <code
                class="literal">ESTABLISHED</code> descrive i pacchetti appartenenti ad una connessione già in essere, e <code
                class="literal">RELATED</code> descrive i pacchetti che instaurano una connessione correlata con una già esistente (che è utile per le connessioni <code
                class="literal">ftp-data</code> in modalità «attiva» del protocollo FTP).
				</div><div
              class="para">
					La sezione precedente elenca tutte le possibili azioni, ma non le rispettive opzioni. L'azione <code
                class="literal">LOG</code>, per esempio, ha le seguenti opzioni:
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="itemizedlist"><ul><li
                  class="listitem"><div
                    class="para">
							<code
                      class="literal">--log-priority</code>, con valore predefinito <code
                      class="literal">warning</code>, indica la priorità dei messaggi di <code
                      class="command">syslog</code>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="literal">--log-prefix</code> permette l'inserimento di un prefisso di testo per differenziare i messaggi di log;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="literal">--log-tcp-sequence</code>, <code
                      class="literal">--log-tcp-options</code> e <code
                      class="literal">--log-ip-options</code> indicano dati ulteriori da integrare nel messaggio: rispettivamente, il numero di sequenza TCP, opzioni TCP e opzioni IP.
						</div></li></ul></div><div
              class="para">
					The <code
                class="literal">DNAT</code> action provides the <code
                class="literal">--to-destination <em
                  class="replaceable">address</em>:<em
                  class="replaceable">port</em></code> option to indicate the new destination IP address and/or port. Similarly, <code
                class="literal">SNAT</code> provides <code
                class="literal">--to-source <em
                  class="replaceable">address</em>:<em
                  class="replaceable">port</em></code> to indicate the new source IP address and/or port.
				</div><div
              class="para">
					The <code
                class="literal">REDIRECT</code> action (only available if NAT is available — on <span
                class="distribution distribution">Wheezy</span>, this means IPv4 only) provides the <code
                class="literal">--to-ports <em
                  class="replaceable">port(s)</em></code> option to indicate the port, or port range, where the packets should be redirected.
				</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.creating-rules"></a>14.2.3. Creare le regole</h3></div></div></div><div
            class="para">
				Per la creazione di ogni regola è necessaria l'invocazione di <code
              class="command">iptables</code>/<code
              class="command">ip6tables</code>. Digitare questi comandi manualmente può essere noioso, perciò sono solitamente memorizzati in uno script in modo tale che ad ogni avvio della macchina venga richiamata automaticamente la stessa configurazione. Questo script può essere scritto a mano, ma può essere interessante prepararlo con uno strumento di alto livello quale <code
              class="command">fwbuilder</code>.
			</div><div
            class="para">
				Il principio è semplice. Come primo passo, è necessario descrivere tutti gli elementi coinvolti nelle regole effettive:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						il firewall stesso, con le sue interfacce di rete;
					</div></li><li
                class="listitem"><div
                  class="para">
						le reti, con i loro corrispondenti intervalli di IP;
					</div></li><li
                class="listitem"><div
                  class="para">
						i server;
					</div></li><li
                class="listitem"><div
                  class="para">
						le porte che appartengono ai servizi presenti nei server.
					</div></li></ul></div><div
            class="para">
				Le regole sono quindi create con semplici azioni di trascina e rilascia sugli oggetti. Alcuni menu contestuali permettono di modificare le condizioni (la negazione, per esempio). Dopodiché deve essere scelta e configurata l'azione.
			</div><div
            class="para">
				Per quanto concerne l'IPv6, si possono creare due diversi insiemi di regole per IPv4 e IPv6, oppure crearno uno e lasciare che <code
              class="command">fwbuilder</code> traduca le regole in base con gli indirizzi assegnati agli oggetti.
			</div><div
            class="figure"><a
              id="figure.fwbuilder"></a><div
              class="figure-contents"><div
                class="mediaobject"><img
                  src="images/fwbuilder.png"
                  alt="Finestra principale di fwbuilder" /></div></div><p
              class="title"><strong>Figura 14.2. Finestra principale di fwbuilder</strong></p></div><a
            id="idm140108832521936"
            class="indexterm"></a><div
            class="para">
				<code
              class="command">fwbuilder</code> can then generate a script configuring the firewall according to the rules that have been defined. Its modular architecture gives it the ability to generate scripts targeting different systems (<code
              class="command">iptables</code> for Linux, <code
              class="command">ipf</code> for FreeBSD and <code
              class="command">pf</code> for OpenBSD).
			</div><div
            class="para">
				Già a partire da <span
              class="distribution distribution">Squeeze</span> le versioni del pacchetto <span
              class="pkg pkg">fwbuilder</span> contengono sia l'interfaccia grafica che i moduli per ogni sistema di firewall (questi erano prima suddivisi in vari pacchetti, uno per ogni sistema di destinazione):
			</div><pre
            class="screen">
<code
              class="computeroutput"># </code><strong
              class="userinput"><code>aptitude install fwbuilder</code></strong></pre></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.install-rules-at-boot"></a>14.2.4. Installare le regole ad ogni avvio</h3></div></div></div><div
            class="para">
				Se il firewall mira a difendere una connessione di rete PPP intermittente, il modo più semplice di lanciare lo script è di installarlo come <code
              class="filename">/etc/ppp/ip-up.d/0iptables</code> (da notare che sono presi in considerazione solo i file senza punti nel nome). Il firewall viene in questo modo ricreato ogni volta che si instaura la connessione PPP.
			</div><div
            class="para">
				Negli altri casi, si consiglia di posizionare lo script di configurazione in una direttiva <code
              class="literal">up</code> del file <code
              class="filename">/etc/network/interfaces</code>. Nel seguente esempio, lo script è memorizzato in <code
              class="filename">/usr/local/etc/arrakis.fw</code>.
			</div><div
            class="example"><a
              id="example.network-interfaces-firewall"></a><p
              class="title"><strong>Esempio 14.1. File <code
                  class="filename">interfaces</code> che richiama lo script del firewall</strong></p><div
              class="example-contents"><pre
                class="programlisting">auto eth0
iface eth0 inet static
    address 192.168.0.1
    network 192.168.0.0
    netmask 255.255.255.0
    broadcast 192.168.0.255
    up /usr/local/etc/arrakis.fw
</pre></div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="security.html"><strong>Indietro</strong>Capitolo 14. Sicurezza</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Risali</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Partenza</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.supervision.html"><strong>Avanti</strong>14.3. Supervisione: prevenire, rilevare, dissuade...</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.firewall-packet-filtering.html">ar-MA</a></li><li><a
              href="../da-DK/sect.firewall-packet-filtering.html">da-DK</a></li><li><a
              href="../de-DE/sect.firewall-packet-filtering.html">de-DE</a></li><li><a
              href="../el-GR/sect.firewall-packet-filtering.html">el-GR</a></li><li><a
              href="../en-US/sect.firewall-packet-filtering.html">en-US</a></li><li><a
              href="../es-ES/sect.firewall-packet-filtering.html">es-ES</a></li><li><a
              href="../fa-IR/sect.firewall-packet-filtering.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.firewall-packet-filtering.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.firewall-packet-filtering.html">hr-HR</a></li><li><a
              href="../id-ID/sect.firewall-packet-filtering.html">id-ID</a></li><li><a
              href="../it-IT/sect.firewall-packet-filtering.html">it-IT</a></li><li><a
              href="../ja-JP/sect.firewall-packet-filtering.html">ja-JP</a></li><li><a
              href="../pl-PL/sect.firewall-packet-filtering.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.firewall-packet-filtering.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.firewall-packet-filtering.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.firewall-packet-filtering.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.firewall-packet-filtering.html">tr-TR</a></li><li><a
              href="../zh-CN/sect.firewall-packet-filtering.html">zh-CN</a></li></ul></div></body></html>
