<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">5.2. 套件元資訊</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-zh-TW-1.0-1" /><meta
        name="keywords"
        content="執行檔套件, 原始檔套件, dpkg, 相依性, 衝突" /><link
        rel="home"
        href="index.html"
        title="The Debian Administrator's Handbook" /><link
        rel="up"
        href="packaging-system.html"
        title="章 5. 套件系統：工具與基本原則" /><link
        rel="prev"
        href="packaging-system.html"
        title="章 5. 套件系統：工具與基本原則" /><link
        rel="next"
        href="sect.source-package-structure.html"
        title="5.3. 原始套件的結構" /><meta
        name="viewport"
        content="width=device-width, initial-scale=1" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/zh-TW/sect.package-meta-information.html" /></head><body><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="../../"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="packaging-system.html"><strong>前一頁</strong></a></li><li
          class="home">The Debian Administrator's Handbook</li><li
          class="next"><a
            accesskey="n"
            href="sect.source-package-structure.html"><strong>下一頁</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.package-meta-information"></a>5.2. 套件元資訊</h2></div></div></div><a
          id="id-1.8.6.2"
          class="indexterm"></a><a
          id="id-1.8.6.3"
          class="indexterm"></a><div
          class="para">
			Debian 套件不祗是被安裝檔案的集合。還包括其他的資訊，描述與其他 Debian 套件的關係 (相依、衝突、建議)。也提供在套件生命週期 (安裝、移除、升級) 各階段的腳本供執行之用。這些資料供套件管理工具使用但不是套件軟體的一部份；它們在套件內，稱為 “元資訊” (資訊的資訊)。
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.control"></a>5.2.1. 描述：<code
                    class="filename">control</code> 檔案</h3></div></div></div><a
            id="id-1.8.6.5.2"
            class="indexterm"></a><a
            id="id-1.8.6.5.3"
            class="indexterm"></a><a
            id="id-1.8.6.5.4"
            class="indexterm"></a><div
            class="para">
				此檔案採用類似電子郵件標頭 (如 RFC 2822 的定義) 的做法。例如，<span
              class="pkg pkg">apt</span>、 <code
              class="filename">控制</code> 檔案內容如下：
			</div><pre
            class="screen">
<code
              class="computeroutput">$ </code><strong
              class="userinput"><code>apt-cache show apt</code></strong>
<code
              class="computeroutput">Package: apt
Version: 1.0.9.6
Installed-Size: 3788
Maintainer: APT Development Team &lt;deity@lists.debian.org&gt;
Architecture: amd64
Replaces: manpages-it (&lt;&lt; 2.80-4~), manpages-pl (&lt;&lt; 20060617-3~), openjdk-6-jdk (&lt;&lt; 6b24-1.11-0ubuntu1~), sun-java5-jdk (&gt;&gt; 0), sun-java6-jdk (&gt;&gt; 0)
Depends: libapt-pkg4.12 (&gt;= 1.0.9.6), libc6 (&gt;= 2.15), libgcc1 (&gt;= 1:4.1.1), libstdc++6 (&gt;= 4.9), debian-archive-keyring, gnupg
Suggests: aptitude | synaptic | wajig, dpkg-dev (&gt;= 1.17.2), apt-doc, python-apt
Conflicts: python-apt (&lt;&lt; 0.7.93.2~)
Breaks: manpages-it (&lt;&lt; 2.80-4~), manpages-pl (&lt;&lt; 20060617-3~), openjdk-6-jdk (&lt;&lt; 6b24-1.11-0ubuntu1~), sun-java5-jdk (&gt;&gt; 0), sun-java6-jdk (&gt;&gt; 0)
Description-en: commandline package manager
 This package provides commandline tools for searching and
 managing as well as querying information about packages
 as a low-level access to all features of the libapt-pkg library.
 .
 These include:
  * apt-get for retrieval of packages and information about them
    from authenticated sources and for installation, upgrade and
    removal of packages together with their dependencies
  * apt-cache for querying available information about installed
    as well as installable packages
  * apt-cdrom to use removable media as a source for packages
  * apt-config as an interface to the configuration settings
  * apt-key as an interface to manage authentication keys
Description-md5: 9fb97a88cb7383934ef963352b53b4a7
Tag: admin::package-management, devel::lang:ruby, hardware::storage,
 hardware::storage:cd, implemented-in::c++, implemented-in::perl,
 implemented-in::ruby, interface::commandline, network::client,
 protocol::ftp, protocol::http, protocol::ipv6, role::program,
 role::shared-lib, scope::application, scope::utility, sound::player,
 suite::debian, use::downloading, use::organizing, use::searching,
 works-with::audio, works-with::software:package, works-with::text
Section: admin
Priority: important
Filename: pool/main/a/apt/apt_1.0.9.6_amd64.deb
Size: 1107560
MD5sum: a325ccb14e69fef2c50da54e035a4df4
SHA1: 635d09fcb600ec12810e3136d51e696bcfa636a6
SHA256: 371a559ce741394b59dbc6460470a9399be5245356a9183bbeea0f89ecaabb03</code></pre><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>基礎</em></span> RFC — 網際網路標準</strong></p></div></div></div><a
              id="id-1.8.6.5.7.2"
              class="indexterm"></a><a
              id="id-1.8.6.5.7.3"
              class="indexterm"></a><div
              class="para">
				RFC 是 “Request For Comments” 的縮寫。意思是，徵求修正意見書，通常是一份即將成為網際網路標準的技術文件。在成為標準前先凍結它，並交付大眾評估 (就是名稱的由來)。由網際網路工程任務組 (Internet Engineering Task Force, IETF) 決定這些文件的狀態 (建議標準、草案、或標準)。
			</div><div
              class="para">
				RFC 2026 定義網際網路協定標準化的程序。<div
                class="url">→ <a
                  href="http://www.faqs.org/rfcs/rfc2026.html">http://www.faqs.org/rfcs/rfc2026.html</a></div>
			</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="id-1.8.6.5.8"></a>5.2.1.1. 相依性：<code
                      class="literal">依賴</code> 欄位</h4></div></div></div><a
              id="id-1.8.6.5.8.2"
              class="indexterm"></a><a
              id="id-1.8.6.5.8.3"
              class="indexterm"></a><a
              id="id-1.8.6.5.8.4"
              class="indexterm"></a><div
              class="para">
					相依性定義在套件標頭的 <code
                class="literal">Depends</code> 欄位。這是情況清單用來滿足套件正確工作所需 — 此資訊用於 <code
                class="command">apt</code> 之類的工具用來安裝必備的程式庫，以適當的版本滿足套件的相依性。每個相依性，都指定符合其需求的版本。換句話說，像是這樣的，我們需要套件 <span
                class="pkg pkg">libc6</span> 版本大於或等於 “2.15” (寫法是 “<code
                class="command">libc6 (&gt;= 2.15)</code>”)。版本的寫法是：
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="itemizedlist"><ul><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">&lt;&lt;</code>：小於；
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">&lt;=</code>：小於或等於；
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">=</code>：等於 (“<code
                      class="literal">2.6.1</code>” 不等於 “<code
                      class="literal">2.6.1-1</code>”)；
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">&gt;=</code>：大於或等於；
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">&gt;&gt;</code>：大於。
						</div></li></ul></div><div
              class="para">
					碰到條件時，以逗點做為交集 “and” 符號。以直線 (“|”) 為聯集 “or” 符號 (它是包容性的或 “or”、不是排它性的非此即彼 “either/or”)。優先順序比 “and” 高，可以無限次使用。因此，相依性 “(A or B) and C” 可寫成 <code
                class="command">A | B, C</code>。另個例子，“A or (B and C)” 應寫成 “(A or B) and (A or C)”，因為 <code
                class="literal">Depends</code> 欄位不接受以括號改變邏輯運算元 “or” 與 “and”的優先次序。所以須寫成 <code
                class="command">A | B, A | C</code>。<div
                class="url">→ <a
                  href="http://www.debian.org/doc/debian-policy/ch-relationships.html">http://www.debian.org/doc/debian-policy/ch-relationships.html</a></div>
				</div><a
              id="id-1.8.6.5.8.8"
              class="indexterm"></a><div
              class="para">
					相依性系統是保證程式順利運作的良好機制，但它也有另個用法 “元套件”。這些空的套件內容祗有相依性的說明。由元套件維護者把一群程式的相依性描述在其中；例如，<code
                class="command">apt install <em
                  class="replaceable">meta-package</em></code> 將自動安裝所有用到元套件相依的檔案。<span
                class="pkg pkg">gnome</span>、<span
                class="pkg pkg">kde-full</span> 與 <span
                class="pkg pkg">linux-image-amd64</span> 套件就是元套件之一。
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>DEBIAN 政策</em></span> <code
                          class="literal">預相依</code>，更苛刻的 <code
                          class="literal">相依</code></strong></p></div></div></div><a
                id="id-1.8.6.5.8.10.2"
                class="indexterm"></a><a
                id="id-1.8.6.5.8.10.3"
                class="indexterm"></a><div
                class="para">
					“預相依性”，列在套件標頭的 “<code
                  class="literal">Pre-Depends</code>” 欄位，滿足完整的正常相依性；它的語法是相同的。正常相依性係指必須在宣告相依性前先解開並組態的問題套件。預相依性規定在執行套件的預安裝腳本前，必須先解開並組態套件，就是在安裝之前。
				</div><div
                class="para">
					<code
                  class="command">apt</code> 極度需要預相依，因為在安裝前加入嚴格的限制。因此，除非絕對的必要，不鼓勵加入預相依性。甚至要求在加入預相依性之前，在 <code
                  class="email"><a
                    class="email"
                    href="mailto:debian-devel@lists.debian.org">debian-devel@lists.debian.org</a></code> 郵寄清單諮詢其他發展者的意見。通常可以找出其他的解決方案。
				</div></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>DEBIAN 政策</em></span> <code
                          class="literal">推薦</code>、<code
                          class="literal">建議</code>、與 <code
                          class="literal">強化</code> 欄位</strong></p></div></div></div><a
                id="id-1.8.6.5.8.11.2"
                class="indexterm"></a><a
                id="id-1.8.6.5.8.11.3"
                class="indexterm"></a><div
                class="para">
					<code
                  class="literal">推薦</code> 與 <code
                  class="literal">建議</code> 欄位描述非強制性的相依。“推薦” 相依性是最重要的，改善套件提供的功能但不是運作的必要部份。“建議” 相依性是次重要的，指出套件可能補充與增加其功能，但仍可以在不安裝其他套件的情況安裝它。
				</div><div
                class="para">
					必須安裝 “推薦” 套件，除非確知不需要的理由。反之，沒有必要安裝 “建議” 套件，除非確知需要它們。
				</div><a
                id="id-1.8.6.5.8.11.6"
                class="indexterm"></a><div
                class="para">
					<code
                  class="literal">Enhances</code> 欄位也描述建議，但是位於不同的內文。實際上位於建議套件內，而不是受益於建議的套件內。有可能在不修改套件的前提下新增建議。因此所有插件、外掛與其他的程式延伸可以顯示在與軟體相關的建議清單內。雖然已存在多年，但是 <code
                  class="command">apt</code> 或 <code
                  class="command">synaptic</code> 等程式依然忽略此欄位的存在。<code
                  class="literal">Enhances</code> 欄位提出的建議係在傳統建議 — <code
                  class="literal">Suggests</code> 欄位供使用者參考。
				</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="id-1.8.6.5.9"></a>5.2.1.2. 衝突： <code
                      class="literal">Conflicts</code> 欄位</h4></div></div></div><a
              id="id-1.8.6.5.9.2"
              class="indexterm"></a><a
              id="id-1.8.6.5.9.3"
              class="indexterm"></a><a
              id="id-1.8.6.5.9.4"
              class="indexterm"></a><div
              class="para">
					<code
                class="literal">Conflicts</code> 欄位指示不能與其共存的其他套件。最常見的理由是兩個套件使用相同的名稱，或在同個 TCP 埠提供相同的服務，或會隱藏彼此的運作。
				</div><div
              class="para">
					<code
                class="command">dpkg</code> 不會安裝衝突的套件，除非新套件指明 “取代” 被衝突的套件，<code
                class="command">dpkg</code> 才會以新的套件取代舊的套件。<code
                class="command">apt</code> 總是遵循您的指示：若選擇安裝新套件，則自動移除造成問題的舊套件。
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="id-1.8.6.5.10"></a>5.2.1.3. 不相容：<code
                      class="literal">Breaks</code> 欄位</h4></div></div></div><a
              id="id-1.8.6.5.10.2"
              class="indexterm"></a><a
              id="id-1.8.6.5.10.3"
              class="indexterm"></a><a
              id="id-1.8.6.5.10.4"
              class="indexterm"></a><div
              class="para">
					<code
                class="literal">Breaks</code> 欄位的影響類似於 <code
                class="literal">Conflicts</code> 欄位，但具有特殊的意義。指出安裝一個套件將 “中斷” 另個套件 (或特別版本的套件)。通常而言，兩個套件的不相容是短暫的，且 <code
                class="literal">Breaks</code> 關係係指不相容的特定版本。
				</div><div
              class="para">
					已經中斷現有套件時，<code
                class="command">dpkg</code> 將拒絕安裝並且 <code
                class="command">apt</code> 將更新套件至新的版本試圖解決此問題 (通常可解決此問題，並再度相容)。
				</div><div
              class="para">
					此狀況可能發生在未向下相容的昇級：新版本不再與舊版本相容，沒有特別安排將造成故障。<code
                class="literal">Breaks</code> 欄位避免使用者進入此問題。
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="id-1.8.6.5.11"></a>5.2.1.4. 提供項目：<code
                      class="literal">Provides</code> 欄位</h4></div></div></div><a
              id="id-1.8.6.5.11.2"
              class="indexterm"></a><div
              class="para">
					這個欄位引進有趣的 “虛擬套件” 概念。它有很多角色，其中兩個特別重要。第一個是以虛擬套件關連至一個通用的服務 (此套件 “提供” 此服務)。第二個是指出此套件完全取代另個套件，它也能滿足相依性的要求。因此，可能建立替代套件而不必使用相同名稱的套件。
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>術語</em></span> 元套件與虛擬套件</strong></p></div></div></div><a
                id="id-1.8.6.5.11.4.2"
                class="indexterm"></a><a
                id="id-1.8.6.5.11.4.3"
                class="indexterm"></a><a
                id="id-1.8.6.5.11.4.4"
                class="indexterm"></a><div
                class="para">
					必須從虛擬套件中明確的分離出元套件。後者是真實的套件 (包括真實的 <code
                  class="filename">.deb</code> 檔案)，其唯一目的是用來表示其相依性。
				</div><div
                class="para">
					然而，虛擬套件並未真實的存在；祗是依照通用、邏輯範圍 (提供的服務、相容於標準程式或已存在的套件等) 辨認真實套件的手段。
				</div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        id="id-1.8.6.5.11.5"></a>5.2.1.4.1. 提供 “服務”</h5></div></div></div><div
                class="para">
						讓我們以範例詳述第一個案子：<span
                  class="pkg pkg">postfix</span> 或 <span
                  class="pkg pkg">sendmail</span> 之類的郵件伺服器都 “提供” <span
                  class="pkg pkg">mail-transport-agent</span> 虛擬套件。因此需要啟用該等服務的套件 (如：<span
                  class="pkg pkg">smartlist</span> 或 <span
                  class="pkg pkg">sympa</span> 之類的郵寄名單管理器) 祗要在其相依性裡敘明需要 <span
                  class="pkg pkg">mail-transport-agent</span> 而不是指明還不相容的可能解決方案清單 (如 <code
                  class="command">postfix | sendmail | exim4 | …</code>)。更進一步來說，在同個機器安裝兩個郵件伺服器是沒有用的，因此每個套件都聲明與 <span
                  class="pkg pkg">mail-transport-agent</span> 虛擬套件衝突。系統忽略衝突的兩個套件，但技術上可以禁止同時安裝兩個郵件伺服器。
					</div><div
                class="sidebar"><div
                  class="titlepage"><div><div><p
                        class="title"><strong><span
                            class="emphasis"><em>DEBIAN 政策</em></span> 虛擬套件清單</strong></p></div></div></div><a
                  id="id-1.8.6.5.11.5.3.2"
                  class="indexterm"></a><div
                  class="para">
						使用虛擬套件時，每個人都必須同意其名稱。這就是在 Debian 政策內把他們標準化的原因。此清單包括郵件伺服器 <span
                    class="pkg pkg">mail-transport-agent</span>、C 語文編譯器 <span
                    class="pkg pkg">c-compiler</span>、網頁瀏覽器 <span
                    class="pkg pkg">www-browser</span>、網頁伺服器 <span
                    class="pkg pkg">httpd</span>、FTP 伺服器 <span
                    class="pkg pkg">ftp-server</span>、圖形模式終端機模擬器 <span
                    class="pkg pkg">x-terminal-emulator</span> (<code
                    class="command">xterm</code>)、以及視窗管理員 <span
                    class="pkg pkg">x-window-manager</span>。
					</div><div
                  class="para">
						完整清單參見網站。<div
                    class="url">→ <a
                      href="http://www.debian.org/doc/packaging-manuals/virtual-package-names-list.txt">http://www.debian.org/doc/packaging-manuals/virtual-package-names-list.txt</a></div>
					</div></div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        id="id-1.8.6.5.11.6"></a>5.2.1.4.2. 與另個套件的交換性</h5></div></div></div><div
                class="para">
						套件內容被置於另個較大的套件內時，<code
                  class="literal">Provides</code> 欄位就很有意思。例如，<span
                  class="pkg pkg">libdigest-md5-perl</span> Perl 模組是 Perl 5.6 的選項之一，已被整合入標準的 Perl 5.8 (及其以後的版本，如 5.20 並納入 <span
                  class="distribution distribution">Jessie</span>)。所以，套件 <span
                  class="pkg pkg">perl</span> 5.8 版之後已被宣告 <code
                  class="literal">Provides: libdigest-md5-perl</code> 所以祗要使用 Perl 5.8 (或更新版) 就已滿足其相依性。<span
                  class="pkg pkg">libdigest-md5-perl</span> 套件本身早就被刪除，因為移除 Perl 舊版之後就沒有任何意義。
					</div><div
                class="figure"><a
                  id="id-1.8.6.5.11.6.3"></a><div
                  class="figure-contents"><div
                    class="mediaobject"><img
                      src="images/virtual-package.png"
                      alt="使用 Provides 欄位以避免中斷相依性" /></div></div><p
                  class="title"><strong>圖形 5.1. 使用 <code
                      class="literal">Provides</code> 欄位以避免中斷相依性</strong></p></div><div
                class="para">
						此功能極有用，因為它永遠不可能預料變化莫測的發展，也不能重新命名、或者自動替換過時的軟體。
					</div><div
                class="sidebar"><div
                  class="titlepage"><div><div><p
                        class="title"><strong><span
                            class="emphasis"><em>基本</em></span> Perl，程式語言</strong></p></div></div></div><a
                  id="id-1.8.6.5.11.6.5.2"
                  class="indexterm"></a><a
                  id="id-1.8.6.5.11.6.5.3"
                  class="indexterm"></a><div
                  class="para">
						Perl (Practical Extraction and Report Language) 是極為普遍的程式語言。經由詳盡的 Perl 套件網路，CPAN (Comprehensive Perl Archive Network) 伺服器，包括涵蓋層面很廣的多個現成模組。<div
                    class="url">→ <a
                      href="http://www.perl.org/">http://www.perl.org/</a></div> <div
                    class="url">→ <a
                      href="http://www.cpan.org/">http://www.cpan.org/</a></div>
					</div><div
                  class="para">
						因為它是解譯語言，Perl 寫成的程式在執行前不需要編譯。所以也被稱為 “Perl 腳本”。
					</div></div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        id="id-1.8.6.5.11.7"></a>5.2.1.4.3. 過去的限制</h5></div></div></div><div
                class="para">
						虛擬套件曾有很多限制，最麻煩的是沒有版本編號。從上例可知，這種 <code
                  class="literal">Depends: libdigest-md5-perl (&gt;= 1.6)</code> 相依性，在 Perl 5.10 沒問題，但在包裝系統時仍不會滿足其相依性 — 雖然實際上已滿足了。但是包裝不知道相依性沒問題，祗好選擇風險最小的做法，假設其版本未相依。
					</div><div
                class="para">
						<span
                  class="pkg pkg">dpkg</span> 1.17.11 移除了這個限制，在 Jessie 裡沒問題。套件可以指定版本給虛擬套件使其相依，諸如 <code
                  class="literal">Provides: libdigest-md5-perl (= 1.8)</code>。
					</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="id-1.8.6.5.12"></a>5.2.1.5. 取代檔案：<code
                      class="literal">Replaces</code> 欄位</h4></div></div></div><a
              id="id-1.8.6.5.12.2"
              class="indexterm"></a><a
              id="id-1.8.6.5.12.3"
              class="indexterm"></a><a
              id="id-1.8.6.5.12.4"
              class="indexterm"></a><div
              class="para">
					<code
                class="literal">Replaces</code> 欄位指出在其他套件的檔案，但該套件也合理地取代他們。沒有指名，<code
                class="command">dpkg</code> 失敗，說明它不能覆寫另個套件的檔案 (技術上來說，雖不能強迫使用 <code
                class="literal">--force-overwrite</code> 選項，但可視為標準選項)。因此在加入該欄位之前，先辦認可能的問題並要求維護者研究它。
				</div><div
              class="para">
					套件變更名稱或被包入其他套件時，就可合理地使用此欄位。這種情況也發生在維護者從相同的原始碼套件的執行套件中分離出檔案：被取代的檔案不再屬於舊的套件，祗屬於新的套件。
				</div><div
              class="para">
					已安裝套件內的所有檔案都被取代後，就該移除此套件。最後，此欄位亦鼓勵 <code
                class="command">dpkg</code> 移除衝突的被取代套件。
				</div><div
              class="sidebar"><a
                id="sidebar.debtags"></a><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>進一步</em></span> <code
                          class="literal">Tag</code> 欄位</strong></p></div></div></div><div
                class="para">
					以上述的 <span
                  class="pkg pkg">apt</span> 為例，還有一個欄位未說明，<code
                  class="literal">Tag</code> 欄位。此欄位不是說明套件的關係，而是把套件分類。根據若干屬性 (介面類型、程式語言、應用範圍等) 來分類。僅管如此，並非每個套件都有精準的標籤且未融入所有的 Debian 工具；<code
                  class="command">aptitude</code> 顯示該等標籤，且可以被搜尋。未被 <code
                  class="command">aptitude</code> 搜尋的範圍，可使用以下的網站瀏覽標籤資料庫：<div
                  class="url">→ <a
                    href="http://debtags.alioth.debian.org/">http://debtags.alioth.debian.org/</a></div>
				</div></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.configuration-scripts"></a>5.2.2. 組態腳本</h3></div></div></div><a
            id="id-1.8.6.6.2"
            class="indexterm"></a><a
            id="id-1.8.6.6.3"
            class="indexterm"></a><a
            id="id-1.8.6.6.4"
            class="indexterm"></a><a
            id="id-1.8.6.6.5"
            class="indexterm"></a><a
            id="id-1.8.6.6.6"
            class="indexterm"></a><div
            class="para">
				除了 <code
              class="filename">control</code> 檔案，給 Debian 套件使用的 <code
              class="filename">control.tar.gz</code> 也有若干腳本，在處理套件的各階段由 <code
              class="command">dpkg</code> 啟用。Debian 政策詳細說明可能的個案，指出他們可能接收的腳本與參數。這些程序可能極為複雜，可能多個腳本同時失敗，<code
              class="command">dpkg</code> 將取消安裝或移除 (祗要可能的話) 以返回前個滿意的階段。
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>進一步</em></span> <code
                        class="command">dpkg</code> 的資料庫</strong></p></div></div></div><a
              id="id-1.8.6.6.8.2"
              class="indexterm"></a><a
              id="id-1.8.6.6.8.3"
              class="indexterm"></a><div
              class="para">
				已安裝套件的所有組態腳本，都以前置套件檔名的方式，儲存在 <code
                class="filename">/var/lib/dpkg/info/</code> 資料夾。此資料夾包括每個套件的延伸檔名 <code
                class="filename">.list</code>，包括屬於該套件的檔案清單。
			</div><div
              class="para">
				<code
                class="filename">/var/lib/dpkg/status</code> 檔案包括一群資料塊 (以電子郵件標頭方式呈現，RFC 2822) 描述套件的狀態。已安裝套件的 <code
                class="filename">control</code> 檔案也複製於此。
			</div></div><div
            class="para">
				一般情況下，先執行 <code
              class="filename">preinst</code> 腳本，再安裝套件，然後執行 <code
              class="filename">postinst</code>。同樣的，先執行 <code
              class="filename">prerm</code> 腳本，再移除套件，然後執行 <code
              class="filename">postrm</code>。更新套件就是先移除前個版本再安裝新的版本。沒辦法在這裡詳述所有可能發生的場景，但可以討論兩個最常發生的：安裝/更新與移除。
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>注意</em></span> 腳本名稱的象徵意義</strong></p></div></div></div><div
              class="para">
				本節描述的順序由特別名稱的組態腳本啟用，諸如 <code
                class="command">old-prerm</code> 或 <code
                class="command">new-postinst</code>。<code
                class="command">prerm</code> 腳本是套件的舊版本 (未更新前的)而 <code
                class="command">postinst</code> 腳本是在新版本 (經由更新安裝) 內。
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>提示</em></span> 狀態圖</strong></p></div></div></div><div
              class="para">
				Manoj Srivastava 以圖解釋這些組態腳本被 <code
                class="command">dpkg</code> 叫用的情況。Debian 女子計畫也有類似的圖；容易瞭解，略為不夠完整。<div
                class="url">→ <a
                  href="https://people.debian.org/~srivasta/MaintainerScripts.html">https://people.debian.org/~srivasta/MaintainerScripts.html</a></div> <div
                class="url">→ <a
                  href="https://wiki.debian.org/MaintainerScripts">https://wiki.debian.org/MaintainerScripts</a></div>
			</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="id-1.8.6.6.12"></a>5.2.2.1. 安裝與升級</h4></div></div></div><a
              id="id-1.8.6.6.12.2"
              class="indexterm"></a><div
              class="para">
					安裝 (或升級) 時候發生的事：
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="orderedlist"><ol><li
                  class="listitem"><div
                    class="para">
							升級時，<code
                      class="command">dpkg</code> 叫用 <code
                      class="command">old-prerm upgrade <em
                        class="replaceable">新版本</em></code>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							還是在升級時候，<code
                      class="command">dpkg</code> 執行 <code
                      class="command">new-preinst upgrade <em
                        class="replaceable">舊版本</em></code>；第一次安裝時，它執行 <code
                      class="command">new-preinst install</code>。若已經安裝或移除該套件 (但未合併，仍保留組態檔案)，可能在舊版本加入最新的參數。
						</div></li><li
                  class="listitem"><div
                    class="para">
							解開新的套件。取代已存在的檔案，但暫時備份舊檔案。
						</div></li><li
                  class="listitem"><div
                    class="para">
							升級時，<code
                      class="command">dpkg</code> 執行 <code
                      class="command">old-postrm upgrade <em
                        class="replaceable">新版本</em></code>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">dpkg</code> 升級所有的內部資料 (檔案清單、組態腳本等) 並且移除被取代檔案的備份。這是臨界點：<code
                      class="command">dpkg</code> 不能再近用回復稍早狀態的元素。
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">dpkg</code> 將更新組態檔案，無法自動管理此工作時，要求使用者做決定。詳情在此 <a
                      class="xref"
                      href="sect.package-meta-information.html#sect.conffiles">節 5.2.3, “校驗，組態檔案清單”</a>。
						</div></li><li
                  class="listitem"><div
                    class="para">
							最後，<code
                      class="command">dpkg</code> 執行 <code
                      class="command">new-postinst configure <em
                        class="replaceable">舊版本組態</em></code> 組態套件。
						</div></li></ol></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="id-1.8.6.6.13"></a>5.2.2.2. 移除套件</h4></div></div></div><div
              class="para">
					移除套件時發生的事：
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="orderedlist"><ol><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">dpkg</code> 呼叫 <code
                      class="command">prerm remove</code>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">dpkg</code> 移除套件所有檔案，但保留組態檔案與組態腳本。
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">dpkg</code> 執行 <code
                      class="command">postrm remove</code>。移除所有組態腳本，保留 <code
                      class="filename">postrm</code>。若使用者未選擇 “清除” 選項，則工作完成。
						</div></li><li
                  class="listitem"><div
                    class="para">
							完全清除的套件 (由 <code
                      class="command">dpkg --purge</code> 或 <code
                      class="command">dpkg -P</code> 執行此工作)，同時刪除其組態檔，以及若干複本 (<code
                      class="filename">*.dpkg-tmp</code>, <code
                      class="filename">*.dpkg-old</code>, <code
                      class="filename">*.dpkg-new</code>) 和暫存檔案；<code
                      class="command">dpkg</code> 然後執行 <code
                      class="command">postrm purge</code>。
						</div></li></ol></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>術語</em></span> Purge，完全移除</strong></p></div></div></div><a
                id="id-1.8.6.6.13.4.2"
                class="indexterm"></a><div
                class="para">
					移除 Debian 套件時，仍保留組態檔案以備未來可能重新安裝該套件。同樣的，守護進程產生的資料 (諸如 LDAP 伺服器資料夾的內容、或 SQL 伺服器資料庫的內容) 也會被保留。
				</div><div
                class="para">
					移除套件內所有資料，必須以指令 “清除” 該套件，<code
                  class="command">dpkg -P <em
                    class="replaceable">套件</em></code>、<code
                  class="command">apt-get remove --purge <em
                    class="replaceable">套件</em></code> 或 <code
                  class="command">aptitude purge <em
                    class="replaceable">套件</em></code>。
				</div><div
                class="para">
					移除該等資料，不能掉以輕心去清除。
				</div></div><a
              id="id-1.8.6.6.13.5"
              class="indexterm"></a><div
              class="para">
					<code
                class="filename">config</code> 腳本補充前述的 4 個腳本，套件以 <code
                class="command">debconf</code> 取得組態用的資訊。安裝過程中，此腳本以 <code
                class="command">debconf</code> 指令詢問使用者詳細的問題。把回應記錄在 <code
                class="command">debconf</code> 資料庫供未來的參考。在安裝之前先由 <code
                class="command">apt</code> 逐一執行該等腳本，歸納問題與回答。事前與事後安裝腳本可使用該等資訊回應使用者的期望。
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>工具</em></span> <code
                          class="command">debconf</code></strong></p></div></div></div><a
                id="id-1.8.6.6.13.7.2"
                class="indexterm"></a><div
                class="para">
					<code
                  class="command">debconf</code> 係用於解決重複出現於 Debian 的問題。Debian 所有的套件都需要 <code
                  class="command">echo</code> 與 <code
                  class="command">read</code> 命令於 <code
                  class="filename">postinst</code> 殼腳本 (及其他類似腳本) 的最低組態才能提出問題。也就是說在大型安裝或升級過程裡，使用者必須在電腦旁回應這些隨時出現的問題。感謝 <code
                  class="command">debconf</code> 工具的出現，這些人工互動幾乎全部免除了。
				</div><div
                class="para">
					<code
                  class="command">debconf</code> 包括很多有趣的功能：要求開發者指明使用者的互動；允許在地化顯示給使用者的字串 (描述互動的所有翻譯儲存在 <code
                  class="filename">templates</code> 檔案)；顯示給使用者的前端問題 (文字模式、圖形模式、非互動式)；把回應集中在資料庫供其他電腦使用 ... 但最重要的已可把所有問題，在安裝或升級之前，以一列的模式顯示給使用者。使用者可以放任系統自行安裝，不必待在電腦旁，緊盯螢幕等待問題。
				</div></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.conffiles"></a>5.2.3. 校驗，組態檔案清單</h3></div></div></div><a
            id="id-1.8.6.7.2"
            class="indexterm"></a><a
            id="id-1.8.6.7.3"
            class="indexterm"></a><a
            id="id-1.8.6.7.4"
            class="indexterm"></a><a
            id="id-1.8.6.7.5"
            class="indexterm"></a><a
            id="id-1.8.6.7.6"
            class="indexterm"></a><div
            class="para">
				除了稍早提過的維護者腳本與控制資料外，在 Debian 套件內的 <code
              class="filename">control.tar.gz</code> 可能包括若干有趣的檔案。首先，<code
              class="filename">md5sums</code>，包括套件內所有檔案的 MD5 校驗。它的優點是允許 <code
              class="command">dpkg --verify</code> (詳情見 <a
              class="xref"
              href="sect.supervision.html#sect.dpkg-verify">節 14.3.3.1, “Auditing Packages with <code
                class="command">dpkg --verify</code>”</a>) 檢查該等檔案在安裝後是否被修改。若此檔案不存在，<code
              class="command">dpkg</code> 將在安裝時動態產生一個 (並且如同其他控制檔案般儲存在 dpkg 資料庫)。
			</div><div
            class="para">
				<code
              class="filename">conffiles</code> 列出必須當成組態檔案處理的套件。管理員可修改組態檔案，升級套件時 <code
              class="command">dpkg</code> 將保留這些變動。
			</div><div
            class="para">
				實際上，在此情況下，<code
              class="command">dpkg</code> 儘可能地機靈：若在兩個版本間的標準組態檔並未改變， dpkg 就什麼事也不做。但是，若檔案改變動，就會更新此檔案。有兩種可能：管理員碰觸此組態檔時，由 <code
              class="command">dpkg</code> 自動安裝新版本；或者被管理員修改過，<code
              class="command">dpkg</code> 將要求管理員指定安裝的版本 (修訂過的舊版本、或套件提供的新版本)。為了有助於決定，<code
              class="command">dpkg</code> 提供 “<code
              class="command">diff</code>” 指令顯示兩個版本的差異。若選擇保留舊版本，新版仍儲存在同個資料夾其後綴檔名為 <code
              class="filename">.dpkg-dist</code>。若選擇使用新版本，舊仍儲存在同個資料夾其後綴檔名為 <code
              class="filename">.dpkg-old</code>。另一個作為是暫時中斷 <code
              class="command">dpkg</code> 以編輯檔案並試圖重新安裝相關的修訂 (之前被 <code
              class="command">diff</code> 驗証的差異)。
			</div><div
            class="sidebar"><a
              id="sidebar.questions-conffiles"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>進一步</em></span> 避免組態檔的問題</strong></p></div></div></div><div
              class="para">
				<code
                class="command">dpkg</code> 處理組態檔案升級，但經常中斷作業，要求管理者鍵入資料。如此一來，就不能以無中斷方式一氣呵成升級作業。此指令提供選項讓系統依同樣的邏輯自動回應：<code
                class="command">--force-confold</code> 保留該檔案的舊版本；<code
                class="command">--force-confnew</code> 使用該檔案的新版本 (即使該檔案未被管理者修改，仍使用指定的選擇，極少發生問題)。加入 <code
                class="command">--force-confdef</code> 選項告訴 <code
                class="command">dpkg</code> 在可能情況下自行決定 (換句話說，不改變原組態檔)，祗在其他的情況下，才使用 <code
                class="command">--force-confnew</code> 或 <code
                class="command">--force-confold</code>。
			</div><div
              class="para">
				這些選項適用於 <code
                class="command">dpkg</code>，但是大多數情況下，管理者選擇直接使用 <code
                class="command">aptitude</code> 或 <code
                class="command">apt-get</code> 程式。因此，需要知道給 <code
                class="command">dpkg</code> 指令用的選項語 (他們的指令介面極為類似)。
			</div><pre
              class="screen">
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>apt -o DPkg::options::="--force-confdef" -o DPkg::options::="--force-confold" full-upgrade</code></strong></pre><div
              class="para">
				此選項可直接儲存在 <code
                class="command">apt</code> 的組態內。祗需把下列這行字寫入 <code
                class="filename">/etc/apt/apt.conf.d/local</code> 檔案內：
			</div><div
              class="informalexample"><pre
                class="programlisting">
DPkg::options { "--force-confdef"; "--force-confold"; }</pre></div><div
              class="para">
				把此選項納入組態檔的意思是，將使用 <code
                class="command">aptitude</code> 之類的圖形介面。
			</div></div><div
            class="sidebar"><a
              id="sidebar.questions-conffiles-bis"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>進一步</em></span> 強迫 dpkg 詢問組態檔的問題</strong></p></div></div></div><div
              class="para">
				<code
                class="command">--force-confask</code> 選項要求 <code
                class="command">dpkg</code> 顯示有關組態檔案的問題，即使不是必要的問題也需顯示。因此，以此選項重新安裝套件時，<code
                class="command">dpkg</code> 將再詢管理者修改過的組態檔案問題。這種方式極為便利，尤其是重新安裝已經被刪除且無可用複本的原始組態檔：標準的重新安裝無效，因為 <code
                class="command">dpkg</code> 認為移除為合法的修改，且不會安裝預期的組態檔。
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="packaging-system.html"><strong>前一頁</strong>章 5. 套件系統：工具與基本原則</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>上一層</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>起始頁</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.source-package-structure.html"><strong>下一頁</strong>5.3. 原始套件的結構</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.package-meta-information.html">ar-MA</a></li><li><a
              href="../da-DK/sect.package-meta-information.html">da-DK</a></li><li><a
              href="../de-DE/sect.package-meta-information.html">de-DE</a></li><li><a
              href="../el-GR/sect.package-meta-information.html">el-GR</a></li><li><a
              href="../en-US/sect.package-meta-information.html">en-US</a></li><li><a
              href="../es-ES/sect.package-meta-information.html">es-ES</a></li><li><a
              href="../fa-IR/sect.package-meta-information.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.package-meta-information.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.package-meta-information.html">hr-HR</a></li><li><a
              href="../id-ID/sect.package-meta-information.html">id-ID</a></li><li><a
              href="../it-IT/sect.package-meta-information.html">it-IT</a></li><li><a
              href="../ja-JP/sect.package-meta-information.html">ja-JP</a></li><li><a
              href="../ko-KR/sect.package-meta-information.html">ko-KR</a></li><li><a
              href="../nb-NO/sect.package-meta-information.html">nb-NO</a></li><li><a
              href="../pl-PL/sect.package-meta-information.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.package-meta-information.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.package-meta-information.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.package-meta-information.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.package-meta-information.html">tr-TR</a></li><li><a
              href="../zh-CN/sect.package-meta-information.html">zh-CN</a></li><li><a
              href="../zh-TW/sect.package-meta-information.html">zh-TW</a></li></ul></div></body></html>
