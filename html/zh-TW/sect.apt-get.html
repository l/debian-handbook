<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">6.2. aptitude、apt-get、與 apt 命令</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-zh-TW-1.0-1" /><meta
        name="keywords"
        content="apt, apt-get, apt-cache, aptitude, synaptic, sources.list, apt-cdrom" /><link
        rel="home"
        href="index.html"
        title="The Debian Administrator's Handbook" /><link
        rel="up"
        href="apt.html"
        title="章 6. 維護與更新：APT 工具" /><link
        rel="prev"
        href="apt.html"
        title="章 6. 維護與更新：APT 工具" /><link
        rel="next"
        href="sect.apt-cache.html"
        title="6.3. The apt-cache 命令" /><meta
        name="viewport"
        content="width=device-width, initial-scale=1" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/zh-TW/sect.apt-get.html" /></head><body><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="../../"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="apt.html"><strong>前一頁</strong></a></li><li
          class="home">The Debian Administrator's Handbook</li><li
          class="next"><a
            accesskey="n"
            href="sect.apt-cache.html"><strong>下一頁</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.apt-get"></a>6.2. <code
                  class="command">aptitude</code>、<code
                  class="command">apt-get</code>、與 <code
                  class="command">apt</code> 命令</h2></div></div></div><a
          id="id-1.9.11.2"
          class="indexterm"></a><a
          id="id-1.9.11.3"
          class="indexterm"></a><a
          id="id-1.9.11.4"
          class="indexterm"></a><div
          class="para">
			APT 是個原先有圖形介面的大計畫。以包括核心應用程式的程式庫為基礎，且包括第一個前端 — 命令列指令 — <code
            class="command">apt-get</code>。<code
            class="command">apt</code> 是 APT 的第二個命令列指令包括若干處理錯誤的 <code
            class="command">apt-get</code>。
		</div><div
          class="para">
			還有很多圖形介面的延伸計襩：<code
            class="command">synaptic</code>、<code
            class="command">aptitude</code> (包括文字介面與圖形介面 — 即使尚未完成)、<code
            class="command">wajig</code>等。最被推薦的介面 <code
            class="command">apt</code> 是本節的範例。然而要注意 <code
            class="command">apt-get</code> 與 <code
            class="command">aptitude</code> 的命令列語法極為類似。<code
            class="command">apt</code>、<code
            class="command">apt-get</code> 與 <code
            class="command">aptitude</code> 還是有區別的，將詳述於下。
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.9.11.7"></a>6.2.1. 初始化</h3></div></div></div><div
            class="para">
				APT 可用的套件清單可經由 <code
              class="command">apt update</code> 更新。連線速度還不錯的話，祗需要幾秒鐘下載若干<code
              class="filename">套件</code>/<code
              class="filename">來源</code>/<code
              class="filename">Translation-<em
                class="replaceable">語系代碼</em></code> 檔案，隨著 Debian 的發展愈來愈大 (在 <code
              class="literal">main</code> 區塊至少有 10 MB 的資料)。當然，從 CD-ROM 安裝則不需要任何的下載 — 在此情況下，運作速度極快。
			</div><a
            id="id-1.9.11.7.3"
            class="indexterm"></a><a
            id="id-1.9.11.7.4"
            class="indexterm"></a><a
            id="id-1.9.11.7.5"
            class="indexterm"></a></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.9.11.8"></a>6.2.2. 安裝與移除</h3></div></div></div><a
            id="id-1.9.11.8.2"
            class="indexterm"></a><a
            id="id-1.9.11.8.3"
            class="indexterm"></a><a
            id="id-1.9.11.8.4"
            class="indexterm"></a><a
            id="id-1.9.11.8.5"
            class="indexterm"></a><div
            class="para">
				有了 APT，以指令 <code
              class="command">apt install <em
                class="replaceable">套件</em></code> 與 <code
              class="command">apt remove <em
                class="replaceable">套件</em></code>，就可以從系統新增或移除套件。以前述的指令，APT 將自動安裝必要的相依性或移除不需要的套件。<code
              class="command">apt purge <em
                class="replaceable">套件</em></code> 指令可以完全移除套件 — 同時刪除組態檔。
			</div><a
            id="id-1.9.11.8.7"
            class="indexterm"></a><a
            id="id-1.9.11.8.8"
            class="indexterm"></a><a
            id="id-1.9.11.8.9"
            class="indexterm"></a><a
            id="id-1.9.11.8.10"
            class="indexterm"></a><a
            id="id-1.9.11.8.11"
            class="indexterm"></a><a
            id="id-1.9.11.8.12"
            class="indexterm"></a><a
            id="id-1.9.11.8.13"
            class="indexterm"></a><a
            id="id-1.9.11.8.14"
            class="indexterm"></a><a
            id="id-1.9.11.8.15"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>秘訣</em></span> 同個套件安裝多次</strong></p></div></div></div><div
              class="para">
				在多部電腦安系統性地安裝相同的套件。此工作還很簡單。
			</div><div
              class="para">
				首先，取得電腦內安裝套件的清單做為複製的 “模板”。
			</div><pre
              class="screen"><code
                class="computeroutput">$ </code><strong
                class="userinput"><code>dpkg --get-selections &gt;pkg-list</code></strong></pre><div
              class="para">
				<code
                class="filename">pkg-list</code> 檔案內容是已安裝套件的清單。然後，用以下的指令把 <code
                class="filename">pkg-list</code> 檔案複製在欲更新的電腦：
			</div><pre
              class="screen">## 更新 dpkg 已知套件的資料
#<strong
                class="userinput"><code>avail=`mktemp`</code></strong>
# <strong
                class="userinput"><code>apt-cache dumpavail &gt; "$avail"</code></strong>
# <strong
                class="userinput"><code>dpkg --merge-avail "$avail"</code></strong>
# <strong
                class="userinput"><code>rm -f "$avail"</code></strong>
## 更新 dpkg 的選擇
# <strong
                class="userinput"><code>dpkg --set-selections &lt; pkg-list</code></strong>
## 要求 apt-get 安裝指定的套件
# <strong
                class="userinput"><code>apt-get dselect-upgrade</code></strong></pre><div
              class="para">
				第一個命令記錄 dpkg 資料庫內可用的套件清單，然後 <code
                class="command">dpkg --set-selections</code> 指令恢復想要安裝的套件清單，再執行 <code
                class="command">apt-get</code> 必要的操作！<code
                class="command">aptitude</code> 沒有這樣的命令。
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>秘訣</em></span> 同時移除與安裝</strong></p></div></div></div><div
              class="para">
				在命令 <code
                class="command">apt</code> (或 <code
                class="command">apt-get</code>、或 <code
                class="command">aptitude</code>) 加入後綴就可以同時安裝指定的套件與移除其他套件。在 <code
                class="command">apt install</code> 命令加入 “<code
                class="literal">-</code>” 及希望移除的套件名稱。在 <code
                class="command">apt remove</code> 命令加入 “<code
                class="literal">+</code>” 及希望安裝的套件名稱。
			</div><div
              class="para">
				以下顯示安裝 <em
                class="replaceable">套件1</em> 與移除 <em
                class="replaceable">套件2</em> 的例子。
			</div><pre
              class="screen"># <strong
                class="userinput"><code>apt install <em
                    class="replaceable">套件1</em> <em
                    class="replaceable">套件2-</em></code></strong>
[...]
# <strong
                class="userinput"><code>apt remove <em
                    class="replaceable">套件1+</em> <em
                    class="replaceable">套件2</em></code></strong>
[...]</pre><div
              class="para">
				也可刪除預設安裝的套件，例如因為 <code
                class="literal">Recommends</code>。一般來說，相依性檢查時將使用建議的資訊尋求其他的解決方案。
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>秘訣</em></span> <code
                        class="command">apt --reinstall</code> 與 <code
                        class="command">aptitude reinstall</code></strong></p></div></div></div><a
              id="id-1.9.11.8.18.2"
              class="indexterm"></a><div
              class="para">
				移除或修改套件內的檔案後，此系統可能受損。最簡易的修復方法是重新安裝受損的套件。不幸的是，套件管理系統拒絕安裝已經安裝的套件；可使用 <code
                class="literal">--reinstall</code> 選項於 <code
                class="command">apt</code> 與 <code
                class="command">apt-get</code> 命令中就能再安裝。即使已有仍可使用以下的指命令 <span
                class="pkg pkg">postfix</span> 再安裝：
			</div><pre
              class="screen"><code
                class="computeroutput"># </code><strong
                class="userinput"><code>apt --reinstall install postfix</code></strong></pre><div
              class="para">
				<code
                class="command">aptitude</code> 命令列有點不同，但其結果與 <code
                class="command">aptitude reinstall postfix</code> 命令相同。
			</div><div
              class="para">
				在 <code
                class="command">dpkg</code> 裡沒有這個問題，但管理者很少用它。
			</div><div
              class="para">
				小心！使用 <code
                class="command">apt --reinstall</code> 修復被攻擊的套件不會恢復系統原來的樣子。<a
                class="xref"
                href="sect.dealing-with-compromised-machine.html">節 14.7, “Dealing with a Compromised Machine”</a> 詳述恢復的必要步驟。
			</div></div><div
            class="para">
				若在 <code
              class="filename">sources.list</code> 內論及多個發行版，可以在套件內分給不同的版本。可以用 <code
              class="command">apt install <em
                class="replaceable">套件</em>=<em
                class="replaceable">版本</em></code> 指定套件的版本，但需指出原始的 (<span
              class="distribution distribution">穩定版</span>、<span
              class="distribution distribution">測試版</span> 或 <span
              class="distribution distribution">不穩定版</span>) — 與 <code
              class="command">apt install <em
                class="replaceable">套件</em>/<em
                class="replaceable">發行版</em></code> — 等偏好的部份。在此命令下，祗要舊版本仍列在 <code
              class="filename">sources.list</code> 之內，就可以回到套件的舊版本 (若您知道該版本較佳). 否則可以用 <code
              class="literal">snapshot.debian.org</code> 拯救它 (見專欄 <a
              class="xref"
              href="apt.html#sidebar.snapshot.debian.org"><span
                class="emphasis"><em>進階</em></span> 舊套件版本：<code
                class="literal">snapshot.debian.org</code></a>)。
			</div><div
            class="example"><a
              id="id-1.9.11.8.20"></a><p
              class="title"><strong>範例 6.3. 安裝 <span
                  class="distribution distribution">不穩定unstable</span> 版的 <span
                  class="pkg pkg">spamassassin</span></strong></p><div
              class="example-contents"><pre
                class="screen"><code
                  class="computeroutput"># </code><strong
                  class="userinput"><code>apt install spamassassin/unstable</code></strong></pre></div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>下一步</em></span> 快取 <code
                        class="filename">.deb</code> 檔</strong></p></div></div></div><div
              class="para">
				APT 把每個下載的 <code
                class="filename">.deb</code> 檔案在資料夾 <code
                class="filename">/var/cache/apt/archives/</code> 內放個複本。經常升級時，每個套件在此資料夾內佔有極多的空間；應經常整理它們。可以使用以下的兩個命令：<code
                class="command">apt-get clean</code> 清空整個資料夾；<code
                class="command">apt-get autoclean</code> 祗清除不再下載的套件 (因為已不再存放於 Debian 鏡射站) 以及清除無用的 (組態參數 <code
                class="literal">APT::Clean-Installed</code> 可防止移除正在使用的 <code
                class="filename">.deb</code> 檔案)。<code
                class="command">apt</code> 命令不支援前述的命令。
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt-upgrade"></a>6.2.3. 系統升級</h3></div></div></div><a
            id="id-1.9.11.9.2"
            class="indexterm"></a><a
            id="id-1.9.11.9.3"
            class="indexterm"></a><a
            id="id-1.9.11.9.4"
            class="indexterm"></a><a
            id="id-1.9.11.9.5"
            class="indexterm"></a><div
            class="para">
				建議使用正常的升級，因為包括最新的安全升級。升級的指令，有 <code
              class="command">apt upgrade</code>、<code
              class="command">apt-get upgrade</code> 或 <code
              class="command">aptitude safe-upgrade</code> (當然是跟著 <code
              class="command">apt update</code> 之後)。在不移除任何套件的情況下，此命令搜尋已安裝套件中可以升級的部份。換句話說，其目標是做到侵入性最小的升級。<code
              class="command">apt-get</code> 比 <code
              class="command">aptitude</code> 或 <code
              class="command">apt</code> 有更多的需求，因為拒絕安裝不曾安裝過的套件。
			</div><div
            class="sidebar"><a
              id="sidebar.apt-pdiff"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>秘訣</em></span> 增量式升級</strong></p></div></div></div><div
              class="para">
				如前所述，<code
                class="command">apt update</code> 命令係用於下載對應於 <code
                class="filename">套件</code> (或 <code
                class="filename">原始碼</code>) 檔案之用。然而，即使經過 <code
                class="command">bzip2</code> 壓縮，這些檔案還是很大 (<code
                class="filename">Packages.xz</code> 位於 <span
                class="foreignphrase"><em
                  class="foreignphrase">main</em></span> 區內的 <span
                class="distribution distribution">Jessie</span> 大於 6 MB)。若您希望定期升級，這些下載可要費相當時間。
			</div><div
              class="para">
				為了加快處理速度，APT 可以下載祗有變動內容的 “diff” 檔案，而不是整個檔案。官方的 Debian 鏡射網站發行此等檔案列出 <code
                class="filename">Packages</code> 檔案及其後續版本的不同處。每次升級與每週升級分別都有對應的檔案。每個供 <span
                class="distribution distribution">不穩定版</span> 的 “diff” 檔案祗有幾十 KB 大小，所以每週使用 <code
                class="command">apt update</code> 命令需要下載的資料不會太大。<span
                class="distribution distribution">穩定版</span> 與 <span
                class="distribution distribution">測試版</span> 的分行版，祗有極小的改變。
			</div><div
              class="para">
				然而，有的時候仍需要下載整個 <code
                class="filename">套件</code> 檔案，尤其是上回升級是很久以前的事且不適合增量式升級。若網路速度極快但機器的處理器性能不足以應付升級，下載省下的時間還不足以彌補電腦計算新版版的時間 (從舊版開始逐一地升級)。在這種情況下，可以使用組態參數 <code
                class="literal">Acquire::Pdiffs</code> 並設定為 <code
                class="literal">false</code>。
			</div></div><div
            class="para">
				<code
              class="command">apt</code> 會選擇最新的版本號 (除了來自 <span
              class="distribution distribution">實驗版</span> 與 <span
              class="distribution distribution">穩定反向植入版</span>，其預設忽略版本號)。若指定 <span
              class="distribution distribution">測試版</span> 或 <span
              class="distribution distribution">不穩定版</span> 於 <code
              class="filename">sources.list</code> 內，則 <code
              class="command">apt upgrade</code> 會把 <span
              class="distribution distribution">穩定版</span> 系統切換至 <span
              class="distribution distribution">測試版</span> 或 <span
              class="distribution distribution">不穩定版</span>，這些都不是您要的。
			</div><div
            class="para">
				搜尋升級的套件時需把特定的發行版告知 <code
              class="command">apt</code>，採用 <code
              class="literal">-t</code> 或 <code
              class="literal">--target-release</code> 選項，然後是發行版的名稱 (如：<code
              class="command">apt -t stable upgrade</code>)。為了避免每次使用 <code
              class="command">apt</code> 都需指定版本，可以把, you can add <code
              class="literal">APT::Default-Release "stable";</code> 加在 <code
              class="filename">/etc/apt/apt.conf.d/local</code> 之內。
			</div><a
            id="id-1.9.11.9.10"
            class="indexterm"></a><a
            id="id-1.9.11.9.11"
            class="indexterm"></a><a
            id="id-1.9.11.9.12"
            class="indexterm"></a><a
            id="id-1.9.11.9.13"
            class="indexterm"></a><a
            id="id-1.9.11.9.14"
            class="indexterm"></a><div
            class="para">
				重要的升級，諸如 Debian 的主要版本升級，需使用 <code
              class="command">apt full-upgrade</code>。在此指令內， 即使刪除若干老舊的套件或安裝新的相依性也會把 <code
              class="command">apt</code> 完全升級。也是每日於T Debian <span
              class="distribution distribution">不穩定版</span> 使用的命令以及逐日追蹤其變動。它的運作極簡單不需說明：APT 的名聲來自其功能性。
			</div><div
            class="para">
				不同於 <code
              class="command">apt</code> 與 <code
              class="command">aptitude</code>，<code
              class="command">apt-get</code> 不知道 <code
              class="command">full-upgrade</code> 命令。反而，您應使用 <code
              class="command">apt-get dist-upgrade</code> (”升級發行版”)，此古老且知名的命令也被 <code
              class="command">apt</code> 與 <code
              class="command">aptitude</code> 接受給讀者相當的便利。
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt-config"></a>6.2.4. 組態選項</h3></div></div></div><a
            id="id-1.9.11.10.2"
            class="indexterm"></a><a
            id="id-1.9.11.10.3"
            class="indexterm"></a><a
            id="id-1.9.11.10.4"
            class="indexterm"></a><div
            class="para">
				除了已提及的組態細目，還可在 <code
              class="filename">/etc/apt/apt.conf.d/</code> 資料夾內增加 APT 的其他組態。讓 APT 告知 <code
              class="command">dpkg</code> 忽略由 <code
              class="literal">DPkg::options { "--force-overwrite"; }</code> 引發的錯誤。
			</div><div
            class="para">
				若祗能經由代理伺服器近用網頁，新增像這樣的一列 <code
              class="literal">Acquire::http::proxy "http://<em
                class="replaceable">yourproxy</em>:3128"</code>。對 FTP 代理伺服器，用 <code
              class="literal">Acquire::ftp::proxy "ftp://<em
                class="replaceable">yourproxy</em>"</code>。更多的組態選項，參考 <span
              class="citerefentry"><span
                class="refentrytitle">apt.conf</span>(5)</span> 手冊頁以 <code
              class="command">man apt.conf</code> 命令 (手刪的詳情，見 <a
              class="xref"
              href="solving-problems.html#sect.manual-pages">節 7.1.1, “手冊頁面”</a>) 查看。
			</div><div
            class="sidebar"><a
              id="sidebar.directory.d"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>基本</em></span> 結尾是 <code
                        class="filename">.d</code> 的資料夾名稱</strong></p></div></div></div><a
              id="id-1.9.11.10.7.2"
              class="indexterm"></a><div
              class="para">
				結尾是 <code
                class="filename">.d</code> 資料使用機會愈來愈多。每個資料夾內的組態檔係供多個檔案使用。所以，在 <code
                class="filename">/etc/apt/apt.conf.d/</code> 內的檔案都是供 APT 組態之用。APT 以字順方式納入他們，最後一個檔案可以修正在前的組態。
			</div><div
              class="para">
				此結構對機器的管理者與套件維護帶來若干彈性。確實，管理者容易修改軟體的組態，祗需在有問題的資料夾新增檔案而不必變動既有的檔案。需要調整另個軟體的組態，以確保與既有軟體相依，套件維護者以同樣的方法就能達成。Debian 的政策禁止修改其他套件的組態檔 — 祗有被授權者才能修改。套件升級時，使用者應保留選擇組態檔版本的權力。外部修改此檔案時將啟動該選項，管理者就知道是外來的修改。
			</div><div
              class="para">
				沒有 <code
                class="filename">.d</code> 資料夾時，外部套件就不能在沒有修改組態檔的前提下修改程式設定。所以，必須邀請使用者選擇修改方式，並列出在檔案 <code
                class="filename">/usr/share/doc/<em
                  class="replaceable">package</em>/README.Debian</code> 內的選項。
			</div><div
              class="para">
				視應用程式的需要，可直接使用或由外部腳本管理 <code
                class="filename">.d</code> 資料夾，將所有檔案串聯成一個組態檔。更動資料夾內容後，必須再執行腳本，才能納入該等變動。還有一件重要的事，千萬不要直接執行自動生成的組態檔，因為下次執行腳本後將失去所有的東西。受到環境的限制才被迫選擇指定的方法 (直接使用 <code
                class="filename">.d</code> 資料夾或由該資料夾產生的檔案)，不論何種方法，組態的彈性收益遠大於其帶來的複雜性。Exim 4 郵件伺服器是產生檔案方法的範例之一：可用多個檔案 (<code
                class="filename">/etc/exim4/conf.d/*</code>) 組態串聯成 <code
                class="filename">/var/lib/exim4/config.autogenerated</code> 再由 <code
                class="command">update-exim4.conf</code> 命令執行。
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt.priorities"></a>6.2.5. 管理套件優先性</h3></div></div></div><div
            class="para">
				組態 APT 最重要的層面之一是管理每個套件來源的優先性。例如，從 <span
              class="distribution distribution">測試版</span>、<span
              class="distribution distribution">不穩定</span> 或 <span
              class="distribution distribution">實驗版</span> 中選取一個或多個套件。可以指令每個套件的優先性 (視其版本或發行版，同個套件可以有多個優先性)。這些優先性將影響 APT 的行為：每個套件總是選擇最優先的版本 (除非舊於已安裝的版本或優先性小於 1000)。
			</div><a
            id="id-1.9.11.11.3"
            class="indexterm"></a><a
            id="id-1.9.11.11.4"
            class="indexterm"></a><a
            id="id-1.9.11.11.5"
            class="indexterm"></a><a
            id="id-1.9.11.11.6"
            class="indexterm"></a><a
            id="id-1.9.11.11.7"
            class="indexterm"></a><a
            id="id-1.9.11.11.8"
            class="indexterm"></a><a
            id="id-1.9.11.11.9"
            class="indexterm"></a><div
            class="para">
				APT 設定若干預設的優先性。已安裝套件版本的優先性是 100。未安裝版本預設優先性為 500，若是另個釋出的目標則可跳至 990 (以 <code
              class="literal">-t</code> 命令列選項或 <code
              class="literal">APT::Default-Release</code> 組態指令調整)。
			</div><div
            class="para">
				於 <code
              class="filename">/etc/apt/preferences</code> 檔案內新增款目的方式，指名受影響套件名稱、版本、出處及其新的優先性。
			</div><div
            class="para">
				APT 永遠不會安裝舊版的套件 (就是套件的版本編號小於已安裝的套件)，除非其優先性高於 1000。APT 總是安裝優先性最高的套件。若兩個套件的優先性相同，APT 安裝最新的 (其版本編號較高)。若同版本的兩個套件優先性相同但內容不同，APT 安裝還沒有安裝的版本 (包括沒有遞增修訂編號的套件，通常是需要的)。
			</div><div
            class="para">
				更具體地說，永遠不會安裝優先性小於 0 的套件。沒有安裝其他版本時，將安裝優先性在 0 與 100 之間的套件。其他發行版沒有更新版本或可用的版本時，安裝優先性在 100 與 500 之間的套件。在目標發行版內沒有更新的版本時，安裝優先性在 501 與 990 之間的套件。已安裝的版本不是更新時，安裝優先性在 990 與 1000 之間的套件。即使使強迫 APT 降級也要安裝優先性高於greater than 1000 的套件。
			</div><div
            class="para">
				APT 檢查 <code
              class="filename">/etc/apt/preferences</code> 時，首先考量最精確的款目 (通常是指定的套件)，然後是較通用的 (包括發行版內的所有套件)。存在多個通用款目時，選用第一個。可用的選項包括套件名稱及其原始檔。每個套件來源包括 <code
              class="filename">釋出</code> 檔案，由 APT 與 <code
              class="filename">套件</code> 檔案同時下載。指定來源 (通常 “Debian” 的官方鏡射站套件，但也可以是個人的或機構的第三方典藏所)。給予發行版名稱 (通常是 Debian 提供標準發行版內的 <span
              class="distribution distribution">穩定版</span>、<span
              class="distribution distribution">測試版</span>、<span
              class="distribution distribution">不穩定版</span> 或 <span
              class="distribution distribution">實驗版</span>) 及其版本 ( 8 就是 Debian 的 <span
              class="distribution distribution">Jessie</span>)。接著以實例檢視其語法。
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>特例</em></span><span
                        class="distribution distribution">實驗性</span>的優先性</strong></p></div></div></div><a
              id="id-1.9.11.11.15.2"
              class="indexterm"></a><div
              class="para">
				若把 <span
                class="distribution distribution">Experimental</span> 列在 <code
                class="filename">sources.list</code> 檔案內，幾乎不會安裝對應套件因為其 APT 優先性為1。當然這是特例，避免使用者意外安裝 <span
                class="distribution distribution">Experimental</span> 套件。這些套件祗能以指令 <code
                class="command">aptitude install <em
                  class="replaceable">套件名稱</em>/experimental</code> 安裝 — 使用者鍵入此指令時自然知道其風險。還是有可能 (雖然 <span
                class="emphasis"><em>不</em></span> 建議) 把 <span
                class="distribution distribution">Experimental</span> 內的套件視為其他發行版而給予優先性 100。在 <code
                class="filename">/etc/apt/preferences</code> 檔案內給予特定的款目就行了：
			</div><div
              class="informalexample"><pre
                class="programlisting">Package: *
Pin: release a=experimental
Pin-Priority: 500</pre></div></div><div
            class="para">
				暫時假設您祗需用到 Debian 穩定版的套件。除非特別指明，不會安裝其他版本的套件。可以在 <code
              class="filename">/etc/apt/preferences</code> 檔案內寫入以上的款目：
			</div><div
            class="informalexample"><pre
              class="programlisting">Package: *
Pin: release a=stable
Pin-Priority: 900

Package: *
Pin: release o=Debian
Pin-Priority: -10</pre></div><div
            class="para">
				<code
              class="literal">a=stable</code> 設定發行版的名稱。<code
              class="literal">o=Debian</code> 限制來自 “Debian” 的套件。
			</div><div
            class="para">
				假設若干伺服器內的程式使用 Perl 5.14 且不希望被升級為其他版本。您需用到此款目：
			</div><div
            class="informalexample"><pre
              class="programlisting">Package: perl
Pin: version 5.14*
Pin-Priority: 1001</pre></div><div
            class="para">
				此組態檔的參考文件在手冊的 <span
              class="citerefentry"><span
                class="refentrytitle">apt_preferences</span>(5)</span>，以 <code
              class="command">man apt_preferences</code> 命令就可看到。
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>秘訣</em></span> 在 <code
                        class="filename">/etc/apt/preferences</code> 內的評論</strong></p></div></div></div><a
              id="id-1.9.11.11.22.2"
              class="indexterm"></a><a
              id="id-1.9.11.11.22.3"
              class="indexterm"></a><a
              id="id-1.9.11.11.22.4"
              class="indexterm"></a><div
              class="para">
				<code
                class="filename">/etc/apt/preferences</code> 檔案沒有放置評論的官方語法，但可以在每個款目的 “<code
                class="literal">Explanation</code>” 欄位置入若干說明：
			</div><div
              class="informalexample"><pre
                class="programlisting">Explanation: The package xserver-xorg-video-intel provided
Explanation: in experimental can be used safely
Package: xserver-xorg-video-intel
Pin: release a=experimental
Pin-Priority: 500</pre></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.apt-mix-distros"></a>6.2.6. 在多個發行版工作</h3></div></div></div><div
            class="para">
				<code
              class="command">apt</code> 是很奇妙的工具，可從其他發行版提取套件。例如，安裝 <span
              class="distribution distribution">穩定版</span> 系統之後，或許想要在不偏離系統原來狀態下，試試 <span
              class="distribution distribution">測試版</span> 或 <span
              class="distribution distribution">不穩定版</span> 的套件。
			</div><div
            class="para">
				混用不同版本套件出問題時，Even if you will occasionally encounter problems while mixing packages from different distributions, <code
              class="command">apt</code> 可以處理得極為恰當把風險降到最低。最好的方法是把所有的發行版置於 <code
              class="filename">/etc/apt/sources.list</code> 檔案內 (某些人總是置入三個發行版，不過還是要記得 <span
              class="distribution distribution">不穩定版</span> 是有經驗使用者的專屬。) 且在 <code
              class="literal">APT::Default-Release</code> 參數中設定偏好的發行版 (見 <a
              class="xref"
              href="sect.apt-get.html#sect.apt-upgrade">節 6.2.3, “系統升級”</a>) 。
			</div><div
            class="para">
				假設 <span
              class="distribution distribution">穩定版</span> 是您的參考版本，但是 <span
              class="distribution distribution">測試版</span> 與 <span
              class="distribution distribution">不穩定版</span> 也列在 <code
              class="filename">sources.list</code> 檔案內。在這個情況下，您可使用 <code
              class="command">apt install <em
                class="replaceable">套件名稱</em>/testing</code> 安裝來自 <span
              class="distribution distribution">測試版</span> 的套件。若因相依性未滿足而安裝失敗，可以在 <span
              class="distribution distribution">測試版</span> 內加入 <code
              class="literal">-t testing</code> 參數。同樣的方式也適用於 <span
              class="distribution distribution">不穩定版</span>。
			</div><div
            class="para">
				在此情況下，除了已經被其他發行版升級之外，升級 (<code
              class="command">upgrade</code> 與 <code
              class="command">full-upgrade</code>) 祗在 <span
              class="distribution distribution">穩定版</span> 內完成：其他的升級在各自的發行版內處理。稍後以 APT 預設的優先性說明此行為。請使用 <code
              class="command">apt-cache policy</code> (見專欄 <a
              class="xref"
              href="sect.apt-get.html#sidebar.apt-cache-policy"><span
                class="emphasis"><em>秘訣</em></span> <code
                class="command">apt-cache policy</code></a>) 檢視指定的優先性。
			</div><div
            class="para">
				每件事都圍繞在 APT 祗處理高於或等於已安裝版本號套件的前提下 (假設 <code
              class="filename">/etc/apt/preferences</code> 還未強迫優先性高於 1000 的某些套件)。
			</div><div
            class="sidebar"><a
              id="sidebar.apt-cache-policy"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>秘訣</em></span> <code
                        class="command">apt-cache policy</code></strong></p></div></div></div><div
              class="para">
				執行 <code
                class="command">apt-cache policy</code> 顯示每個套件來源預設的優先性，就能瞭解優先性的機制。也可使用 <code
                class="command">apt-cache policy <em
                  class="replaceable">套件名稱</em></code> 命令顯示指定套件所有可用版本的優先性。
			</div></div><div
            class="para">
				假設從Let's assume that you have installed version 1 of a first package from <span
              class="distribution distribution">穩定版</span> 安裝第一個套件的第一版且從and that version 2 and 3 are available respectively in <span
              class="distribution distribution">測試版</span> 與 <span
              class="distribution distribution">不穩定版</span> 安裝同套件的第二版與第三版水。已安裝的版本優先性為 100 但在but the version available in <span
              class="distribution distribution">穩定版</span> (相同的) 優先性為 990 (因為它是目標釋出版的一部份)。在 <span
              class="distribution distribution">測試版</span> 與 <span
              class="distribution distribution">不穩定版</span> 的套件其優先性為 500 (預設不安裝版本的優先性)。獲選者為優先性 990 的版本1。套件 “留在 <span
              class="distribution distribution">穩定版</span> 內”。
			</div><div
            class="para">
				另個套件的例子，已從 <span
              class="distribution distribution">測試版</span> 安裝版本 2。版本 1 在 <span
              class="distribution distribution">穩定版</span> 且版本 3 在 <span
              class="distribution distribution">不穩定版</span>。因為優先性小於已安裝的版本，所以版本 1 (優先性為 990 — 小於 1000) 已作廢。祗剩下優先性為 500 的版本 2 與版本 3。在此情況下，APT 選擇較新的版本，即使用 <span
              class="distribution distribution">不穩定版</span>。若不要已安裝自 <span
              class="distribution distribution">測試版</span> 的套件，可以移殖至 <span
              class="distribution distribution">不穩定版</span>，必須指定來自於 <span
              class="distribution distribution">不穩定版</span> 優先性小於 500 (例如 490) 的套件。修改 <code
              class="filename">/etc/apt/preferences</code> 檔案即可：
			</div><pre
            class="programlisting">Package: *
Pin: release a=unstable
Pin-Priority: 490</pre></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.automatic-tracking"></a>6.2.7. 自動追蹤已安裝的套件</h3></div></div></div><div
            class="para">
				<code
              class="command">apt</code> 的必要功能之一是經由相依性追蹤已安裝的套件。這些套件稱為 “自動”，且通常包括其程式庫。
			</div><div
            class="para">
				有了這些資訊後，移除套件時，套件管理者可以計算該等不再需要的自動套件 (因為沒有 “手動安裝” 套件相依於他)。<code
              class="command">apt-get autoremove</code> 會清除該等套件。<code
              class="command">aptitude</code> 與 <code
              class="command">apt</code> 沒有這個命令：辨認之後，前者自動移除它們，而使用者不需手動執行後者命令。所有的情況下，在清除訊息中列出所有影響到的套件。
			</div><a
            id="id-1.9.11.13.4"
            class="indexterm"></a><a
            id="id-1.9.11.13.5"
            class="indexterm"></a><a
            id="id-1.9.11.13.6"
            class="indexterm"></a><a
            id="id-1.9.11.13.7"
            class="indexterm"></a><div
            class="para">
				把套件標記為自動是個好習慣，不需要時就被自動移除。<code
              class="command">apt-mark auto <em
                class="replaceable">套件名稱</em></code> 會標記該套件為自動而 <code
              class="command">apt-mark manual <em
                class="replaceable">套件名稱</em></code> 則不標記。<code
              class="command">aptitude markauto</code> 與 <code
              class="command">aptitude unmarkauto</code> 作用相同祗是功能較多 (見 <a
              class="xref"
              href="sect.apt-frontends.html#sect.aptitude">節 6.4.1, “<code
                class="command">aptitude</code>”</a>)。命令互動介面的 <code
              class="command">aptitude</code> 也可檢視多個套件的 “自動旗標”。
			</div><a
            id="id-1.9.11.13.9"
            class="indexterm"></a><div
            class="para">
				自動安裝套件出現在系統內。係由於從命令列取得該等資訊，可使用 <code
              class="command">aptitude why <em
                class="replaceable">套件名稱</em></code> (<code
              class="command">apt</code> 與 <code
              class="command">apt-get</code> 沒有類似的功能)：
			</div><pre
            class="screen"><code
              class="computeroutput">$ </code><strong
              class="userinput"><code>aptitude why python-debian
</code></strong><code
              class="computeroutput">i   aptitude         Recommends apt-xapian-index         
i A apt-xapian-index Depends    python-debian (&gt;= 0.1.15)
</code></pre><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>其他</em></span> <code
                        class="command">deborphan</code> 與 <code
                        class="command">debfoster</code></strong></p></div></div></div><a
              id="id-1.9.11.13.12.2"
              class="indexterm"></a><a
              id="id-1.9.11.13.12.3"
              class="indexterm"></a><div
              class="para">
				早年 <code
                class="command">apt</code>、<code
                class="command">apt-get</code> 與 <code
                class="command">aptitude</code> 還不能追蹤自動套件時，以另外兩個指令產不必要套件清單：<code
                class="command">deborphan</code> 與 <code
                class="command">debfoster</code>。
			</div><div
              class="para">
				<code
                class="command">deborphan</code> 是兩者中最基礎的。掃瞄 <code
                class="literal">libs</code> 與 <code
                class="literal">oldlibs</code> 區塊 (沒有補充命令) 在已安裝套件中，尋找不再相依於其他套件者。其結果做為移除非必要套件的依據。
			</div><div
              class="para">
				<code
                class="command">debfoster</code> 還有其他用法，極類似 APT：維護一個已安裝的套件以及需要互調用的套件清單。系統內出現新的套件且 <code
                class="command">debfoster</code> 不知道它需要那些套件，則在螢幕顯示其相依的套件清單。此程式提供新的選擇：移除套件 (或許連同相依者)，標記為必要，或暫時忽略它。
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="apt.html"><strong>前一頁</strong>章 6. 維護與更新：APT 工具</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>上一層</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>起始頁</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.apt-cache.html"><strong>下一頁</strong>6.3. The apt-cache 命令</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.apt-get.html">ar-MA</a></li><li><a
              href="../da-DK/sect.apt-get.html">da-DK</a></li><li><a
              href="../de-DE/sect.apt-get.html">de-DE</a></li><li><a
              href="../el-GR/sect.apt-get.html">el-GR</a></li><li><a
              href="../en-US/sect.apt-get.html">en-US</a></li><li><a
              href="../es-ES/sect.apt-get.html">es-ES</a></li><li><a
              href="../fa-IR/sect.apt-get.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.apt-get.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.apt-get.html">hr-HR</a></li><li><a
              href="../id-ID/sect.apt-get.html">id-ID</a></li><li><a
              href="../it-IT/sect.apt-get.html">it-IT</a></li><li><a
              href="../ja-JP/sect.apt-get.html">ja-JP</a></li><li><a
              href="../ko-KR/sect.apt-get.html">ko-KR</a></li><li><a
              href="../nb-NO/sect.apt-get.html">nb-NO</a></li><li><a
              href="../pl-PL/sect.apt-get.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.apt-get.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.apt-get.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.apt-get.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.apt-get.html">tr-TR</a></li><li><a
              href="../zh-CN/sect.apt-get.html">zh-CN</a></li><li><a
              href="../zh-TW/sect.apt-get.html">zh-TW</a></li></ul></div></body></html>
