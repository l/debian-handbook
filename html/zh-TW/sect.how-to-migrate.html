<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">3.2. 移殖的方法</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-zh-TW-1.0-1" /><meta
        name="keywords"
        content="當前設置, 再利用, 移殖" /><link
        rel="home"
        href="index.html"
        title="The Debian Administrator's Handbook" /><link
        rel="up"
        href="existing-setup.html"
        title="章 3. 分析當前設置與移殖" /><link
        rel="prev"
        href="existing-setup.html"
        title="章 3. 分析當前設置與移殖" /><link
        rel="next"
        href="installation.html"
        title="章 4. 安裝" /><meta
        name="viewport"
        content="width=device-width, initial-scale=1" /><meta
        name="flattr:id"
        content="4pz9jq" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/zh-TW/sect.how-to-migrate.html" /></head><body><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="../../"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="existing-setup.html"><strong>前一頁</strong></a></li><li
          class="home">The Debian Administrator's Handbook</li><li
          class="next"><a
            accesskey="n"
            href="installation.html"><strong>下一頁</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.how-to-migrate"></a>3.2. 移殖的方法</h2></div></div></div><a
          id="id-1.6.5.2"
          class="indexterm"></a><div
          class="para">
			為了確保後續的服務，必須依照計畫執行移殖的作業。每種作業系統都需遵守這個原則。
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.6.5.4"></a>3.2.1. 調查與鑑定服務內容</h3></div></div></div><div
            class="para">
				如文字所述，此步驟是必要的。嚴謹的管理者知道每部伺服器的主要作用，但該等作用經常改變，有經驗的使用者偶而會安裝 “狂野” 的服務。知道他們的存在至少可以決定處理的方式，而不是胡亂地刪除它們。
			</div><div
            class="para">
				基於這個目的，移殖伺服器前先告知使用者是明智之舉。把使用者拉入計畫裡，於移殖之前先安裝常用的自由軟體於其桌面電腦中，移殖之後自然碰到 Debian、Libre Office 與 Mozilla 等軟體。
			</div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="id-1.6.5.4.4"></a>3.2.1.1. 網路與程序</h4></div></div></div><a
              id="id-1.6.5.4.4.2"
              class="indexterm"></a><div
              class="para">
					<code
                class="command">nmap</code> 工具 (在同名套件中) 可以在未登錄的前提下，快速地經由網路連結機器辨識網際網路服務。在另部機器鍵入命令連結至同個網路：
				</div><pre
              class="screen">
<code
                class="computeroutput">$ </code><strong
                class="userinput"><code>nmap mirwiz</code></strong>
<code
                class="computeroutput">Starting Nmap 7.40 ( https://nmap.org ) at 2017-06-06 14:41 CEST
Nmap scan report for mirwiz (192.168.1.104)
Host is up (0.00062s latency).
Not shown: 992 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
25/tcp   open  smtp
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
5666/tcp open  nrpe
9999/tcp open  abyss

Nmap done: 1 IP address (1 host up) scanned in 0.06 seconds</code></pre><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>替代選擇</em></span> 使用 <code
                          class="command">netstat</code> 尋找可用的服務清單</strong></p></div></div></div><div
                class="para">
					在 Linux 機器裡，<code
                  class="command">netstat -tupan</code> 指令可顯示使用中或待決的 TCP 數，以及執行程式的 UDP 埠。辨識網路提供的服務量。
				</div></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>下一步</em></span> IPv6</strong></p></div></div></div><div
                class="para">
					有些網路指令可在 IPv4 (通常是預設的) 或 IPv6 執行。包括 <code
                  class="command">nmap</code> 與 <code
                  class="command">netstat</code> 指令，以及其他，如 <code
                  class="command">route</code> 或 <code
                  class="command">ip</code>。可用 <em
                  class="parameter"><code>-6</code></em> 命令列選項啟動它們。
				</div></div><div
              class="para">
					Unix 機器的伺服器提供 shell 帳號給使用者，在擁有者缺席的情況下可以決定該程序是否在背景執行。指令 <code
                class="command">ps auxw</code> 顯示所有程序的使用者辨識碼。將此等資訊與 <code
                class="command">who</code> 指令的輸出互相比較，就能辨識出在背景執行的曖昧或不明服務與程式。以 <code
                class="filename">crontabs</code> (依使用者自動排序列出所有的作業) 可查看伺服器提供的服務資訊 (<code
                class="command">cron</code> 的完整說明在 <a
                class="xref"
                href="sect.task-scheduling-cron-atd.html">節 9.7, “以 <code
                  class="command">cron</code> 和 <code
                  class="command">atd</code> 使用排定的工作”</a>)。
				</div><div
              class="para">
					任何狀況下，都該先備份您的伺服器：使用者報告問題時，就能復原它。
				</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.6.5.5"></a>3.2.2. 備份組態</h3></div></div></div><div
            class="para">
				保留所有設備的備份供昇級後伺服器的參考。至少應備份組態檔。
			</div><div
            class="para">
				Unix 機器的組態檔，通常在 <code
              class="filename">/etc/</code> 資料夾內，有時放在 <code
              class="filename">/usr/local/</code> 的次資料夾裡。若從原始碼開始安裝程式而不是由套件安裝，組態檔就會放在前述的次資料夾內。偶而，還可在 <code
              class="filename">/opt/</code> 找到組態檔。
			</div><div
            class="para">
				在資料管理服務 (如資料庫) 時，強烈建議以標準格式匯出的資料容易被新軟體接受。通常是文字格式，也可能是從資料庫以 SQL 下載，或從 LDAP 伺服器下載 LDIF 檔案。
			</div><div
            class="figure"><a
              id="id-1.6.5.5.5"></a><div
              class="figure-contents"><div
                class="mediaobject"><img
                  src="images/existing-setup-2.png"
                  alt="備份資料庫" /></div></div><p
              class="title"><strong>圖形 3.2. 備份資料庫</strong></p></div><div
            class="para">
				每個伺服器都不一樣，不能詳述所有個案。比較各軟體的文件辨認匯出 (即，再匯入) 的方式以及需要人工處理的部份。此書處理 Linux 伺服器程式的主要組態。
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.6.5.6"></a>3.2.3. 接手現有的 Debian 伺服器</h3></div></div></div><a
            id="id-1.6.5.6.2"
            class="indexterm"></a><a
            id="id-1.6.5.6.3"
            class="indexterm"></a><a
            id="id-1.6.5.6.4"
            class="indexterm"></a><div
            class="para">
				先分析正在執行 Debian 的機器，才能有效地接管維護工作。
			</div><div
            class="para">
				第一個查看的檔案是 <code
              class="filename">/etc/debian_version</code>，通常包括 Debian 系統的版本編號 (它是 <span
              class="emphasis"><em>base-files</em></span> 套件的一部份)。若以 <code
              class="literal"><em
                class="replaceable">代碼</em>/sid</code> 方式呈現，表示此系統從該代碼版本取得的最新版套件 (測試版或不穩定版)。
			</div><div
            class="para">
				<code
              class="command">apt-show-versions</code> 程式 (from the Debian package of the same name) 檢查安裝的套件並辨識可用的版本。<code
              class="command">aptitude</code> 以表單的方式，做同樣的工作。
			</div><div
            class="para">
				查看 <code
              class="filename">/etc/apt/sources.list</code> 檔案 (以及 <code
              class="filename">/etc/apt/sources.list.d/</code> 資料夾) 可看到已安裝 Debian 套件的來源。若出現不明來源，管理員可能選擇重新安裝電腦系統確保其軟體與 Debian 相容。
			</div><div
            class="para">
				<code
              class="filename">sources.list</code> 檔案是個重要的指標：大部份的管理者保留一份使用中的 APT 來源清單。但不能忘記曾使用的來源可能被刪除，有可能以人工方式安裝 (以 <code
              class="command">dpkg</code> 指令) 從網際網路隨機抓來的套件。在此情況下，可能表面上是 “標準” Debian。碰到這種情況應放棄外來的套件 (在不尋常的資料夾出現 <code
              class="filename">deb</code> 檔案、套件版本編號出現 Debian 未使用的特殊前置字元，諸 <code
              class="literal">ubuntu</code> 或 <code
              class="literal">lmde</code>，等字樣。)
			</div><div
            class="para">
				同樣的，分析 <code
              class="filename">/usr/local/</code> 資料夾的內容，其目的是收錄編譯後與手動安裝後的程式。列出以此方式安裝的軟體清單，指出一個問題，為什麼不使用 Debian 對應的套件。
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>速看</em></span> <span
                        class="pkg pkg">cruft</span></strong></p></div></div></div><div
              class="para">
				<span
                class="pkg pkg">cruft</span> 套件列出未被其他套件擁有的檔案。就是篩選器 (有效，但過時的) 以避免報告合法的檔案 (Debian 套件產生的檔案，或未被<code
                class="command">dpkg</code> 管理的組態檔案等)。
			</div><div
              class="para">
				小心不要盲目地刪除可能被 <code
                class="command">cruft</code> 列出的檔案！
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.6.5.7"></a>3.2.4. 安裝 Debian</h3></div></div></div><div
            class="para">
				知道當前伺服器的必要資訊後，就可以關閉它並開始安裝 Debian。
			</div><a
            id="id-1.6.5.7.3"
            class="indexterm"></a><div
            class="para">
				依照電腦的架構，選擇適當的版本。近幾年的 PC，很可能是 amd64 (稍舊的是 i386)。其他的情況，則依照安裝的舊系統來判斷。
			</div><div
            class="para">
				<a
              class="xref"
              href="sect.how-to-migrate.html#tab-corresp">表格 3.1</a> 不是完整的，但相當有用。任何情況下，電腦的原始文件是最有用的資料來源。
			</div><div
            class="table"><a
              id="tab-corresp"></a><p
              class="title"><strong>表格 3.1. 作業系統與架構對照表</strong></p><div
              class="table-contents"><table
                xmlns:d="http://docbook.org/ns/docbook"
                class="lt-4-cols gt-7-rows"
                summary="作業系統與架構對照表"><colgroup><col /><col /></colgroup><thead><tr><th>作業系統</th><th>架構</th></tr></thead><tbody><tr><td>DEC Unix (OSF/1)</td><td>alpha, mipsel</td></tr><tr><td>HP Unix</td><td>ia64, hppa</td></tr><tr><td>IBM AIX</td><td>powerpc</td></tr><tr><td>Irix</td><td>mips</td></tr><tr><td>OS X</td><td>amd64, powerpc, i386</td></tr><tr><td>z/OS, MVS</td><td>s390x, s390</td></tr><tr><td>Solaris, SunOS</td><td>sparc, i386, m68k</td></tr><tr><td>Ultrix</td><td>mips</td></tr><tr><td>VMS</td><td>alpha</td></tr><tr><td>Windows 95/98/ME</td><td>i386</td></tr><tr><td>Windows NT/2000</td><td>i386, alpha, ia64, mipsel</td></tr><tr><td>Windows XP / Windows Server 2008</td><td>i386, amd64, ia64</td></tr><tr><td>Windows RT</td><td>armel, armhf, arm64</td></tr><tr><td>Windows Vista / Windows 7-8-10</td><td>i386, amd64</td></tr></tbody></table></div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>硬體</em></span> 64 位元 PC 與 32 位元 PC</strong></p></div></div></div><a
              id="id-1.6.5.7.7.2"
              class="indexterm"></a><a
              id="id-1.6.5.7.7.3"
              class="indexterm"></a><div
              class="para">
				近年的電腦使用 64 位元 Intel 或 AMD 處理器，相容於稍舊的 32 位元處理器；為 “i386” 架構編繹的軟體也適用。從另個角度來看，此相容的軟體無法充份發揮新處理器的效能。所以 Debian 提供 “amd64” 架構的版本，針對最新的 AMD 晶片以及 Intel “em64t” 處理器 (包括大多數的 Core 系列)，它們極度類似 AMD64。
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.6.5.8"></a>3.2.5. 安裝與組態選定的服務</h3></div></div></div><div
            class="para">
				Debian 安裝之後，必須逐一安裝與設定該電腦的所有服務。新的組態必須考量過去的組態才能確保轉換的順利。前述兩個步驟的資訊對於完成此部份極為重要。
			</div><div
            class="figure"><a
              id="id-1.6.5.8.3"></a><div
              class="figure-contents"><div
                class="mediaobject"><img
                  src="images/existing-setup-4.png"
                  alt="安裝指定的服務" /></div></div><p
              class="title"><strong>圖形 3.3. 安裝指定的服務</strong></p></div><div
            class="para">
				全面進入此練習前，強烈建議您閱讀本書其他部份。才能夠較精細地瞭解對預期服務的組態方式。
			</div><div
            class="para">
			</div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="existing-setup.html"><strong>前一頁</strong>章 3. 分析當前設置與移殖</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>上一層</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>起始頁</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="installation.html"><strong>下一頁</strong>章 4. 安裝</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.how-to-migrate.html">ar-MA</a></li><li><a
              href="../da-DK/sect.how-to-migrate.html">da-DK</a></li><li><a
              href="../de-DE/sect.how-to-migrate.html">de-DE</a></li><li><a
              href="../el-GR/sect.how-to-migrate.html">el-GR</a></li><li><a
              href="../en-US/sect.how-to-migrate.html">en-US</a></li><li><a
              href="../es-ES/sect.how-to-migrate.html">es-ES</a></li><li><a
              href="../fa-IR/sect.how-to-migrate.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.how-to-migrate.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.how-to-migrate.html">hr-HR</a></li><li><a
              href="../id-ID/sect.how-to-migrate.html">id-ID</a></li><li><a
              href="../it-IT/sect.how-to-migrate.html">it-IT</a></li><li><a
              href="../ja-JP/sect.how-to-migrate.html">ja-JP</a></li><li><a
              href="../ko-KR/sect.how-to-migrate.html">ko-KR</a></li><li><a
              href="../nb-NO/sect.how-to-migrate.html">nb-NO</a></li><li><a
              href="../pl-PL/sect.how-to-migrate.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.how-to-migrate.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.how-to-migrate.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.how-to-migrate.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.how-to-migrate.html">tr-TR</a></li><li><a
              href="../vi-VN/sect.how-to-migrate.html">vi-VN</a></li><li><a
              href="../zh-CN/sect.how-to-migrate.html">zh-CN</a></li><li><a
              href="../zh-TW/sect.how-to-migrate.html">zh-TW</a></li></ul></div></body></html>
