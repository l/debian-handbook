<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">Chapitre 10. Infrastructure réseau</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.1" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-fr-FR-1.0-1" /><meta
        name="keywords"
        content="Réseau, Passerelle, TCP/IP, IPv6, DNS, Bind, DHCP, QoS" /><link
        rel="home"
        href="index.html"
        title="Le cahier de l'administrateur Debian" /><link
        rel="up"
        href="index.html"
        title="Le cahier de l'administrateur Debian" /><link
        rel="prev"
        href="sect.power-management.html"
        title="9.12. Gestion de l'énergie : Advanced Configuration and Power Interface (ACPI)" /><link
        rel="next"
        href="sect.virtual-private-network.html"
        title="10.2. Réseau privé virtuel" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/fr-FR/network-infrastructure.html" /></head><body
      class="draft "><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="http://debian-handbook.info"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.power-management.html"><strong>Précédent</strong></a></li><li
          class="home">Le cahier de l'administrateur Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.virtual-private-network.html"><strong>Suivant</strong></a></li></ul><div
        xml:lang="fr-FR"
        class="chapter"
        lang="fr-FR"><div
          class="titlepage"><div><div><h1
                class="title"><a
                  id="network-infrastructure"></a>Chapitre 10. Infrastructure réseau</h1></div></div></div><div
          class="toc"><dl
            class="toc"><dt><span
                class="section"><a
                  href="network-infrastructure.html#sect.gateway">10.1. Passerelle</a></span></dt><dt><span
                class="section"><a
                  href="sect.virtual-private-network.html">10.2. Réseau privé virtuel</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.openvpn">10.2.1. OpenVPN</a></span></dt><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.ssh-vpn">10.2.2. Réseau privé virtuel avec SSH</a></span></dt><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.ipsec">10.2.3. IPsec</a></span></dt><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.pptp">10.2.4. PPTP</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.quality-of-service.html">10.3. Qualité de service</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.quality-of-service.html#sect.qos-principe">10.3.1. Principe et fonctionnement</a></span></dt><dt><span
                    class="section"><a
                      href="sect.quality-of-service.html#sect.qos-config">10.3.2. Configuration et mise en œuvre</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.dynamic-routing.html">10.4. Routage dynamique</a></span></dt><dt><span
                class="section"><a
                  href="sect.ipv6.html">10.5. IPv6</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.ipv6.html#sect.ipv6-tunneling">10.5.1. Tunnel</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.domain-name-servers.html">10.6. Serveur de noms (DNS)</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.domain-name-servers.html#sect.dns-principe">10.6.1. Principe et fonctionnement</a></span></dt><dt><span
                    class="section"><a
                      href="sect.domain-name-servers.html#sect.dns-config">10.6.2. Configuration</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.dhcp.html">10.7. DHCP</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.dhcp.html#sect.dhcp-config">10.7.1. Configuration</a></span></dt><dt><span
                    class="section"><a
                      href="sect.dhcp.html#sect.dhcp-dns">10.7.2. DHCP et DNS</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.network-diagnosis-tools.html">10.8. Outils de diagnostic réseau</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.network-diagnosis-tools.html#sect.netstat">10.8.1. Diagnostic local : <code
                        class="command">netstat</code></a></span></dt><dt><span
                    class="section"><a
                      href="sect.network-diagnosis-tools.html#sect.nmap">10.8.2. Diagnostic distant : <code
                        class="command">nmap</code></a></span></dt><dt><span
                    class="section"><a
                      href="sect.network-diagnosis-tools.html#sect.sniffers">10.8.3. Les <span
                        class="foreignphrase"><em
                          class="foreignphrase">sniffers</em></span> : <code
                        class="command">tcpdump</code> et <code
                        class="command">wireshark</code></a></span></dt></dl></dd></dl></div><div
          class="highlights"><div
            class="para">
		Linux profite du considérable héritage d'Unix dans le domaine des réseaux et Debian dispose de toute la panoplie des outils existants pour les créer et les gérer. Ce chapitre les passe en revue.
	</div></div><div
          class="section"><div
            class="titlepage"><div><div><h2
                  class="title"><a
                    id="sect.gateway"></a>10.1. Passerelle</h2></div></div></div><div
            class="para">
			Une passerelle relie plusieurs réseaux entre eux. Ce terme désigne souvent la « porte de sortie » d'un réseau local, point de passage obligé pour atteindre toutes les adresses IP externes. La passerelle est connectée à chacun des réseaux qu'elle relie et agit en tant que routeur pour faire transiter les paquets IP entre ses différentes interfaces.
		</div><a
            id="idm140565670845328"
            class="indexterm"></a><a
            id="idm140565676232560"
            class="indexterm"></a><a
            id="idm140565669477168"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>B.A.-BA</em></span> Paquet IP</strong></p></div></div></div><a
              id="idm140565675538624"
              class="indexterm"></a><div
              class="para">
			Les réseaux employant le protocole Internet (IP — <span
                class="foreignphrase"><em
                  class="foreignphrase">Internet Protocol</em></span>) pour échanger des informations fonctionnent par paquets : les données y circulent de manière intermittente dans des blocs de taille limitée. Chaque paquet contient, en plus des données, les informations nécessaires à son acheminement (ou routage).
		</div></div><div
            class="sidebar"><a
              id="sidebar.tcp-udp"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>B.A.-BA</em></span> TCP/UDP</strong></p></div></div></div><a
              id="idm140565676156048"
              class="indexterm"></a><a
              id="idm140565675788032"
              class="indexterm"></a><a
              id="idm140565675786592"
              class="indexterm"></a><a
              id="idm140565675785632"
              class="indexterm"></a><div
              class="para">
			TCP est un protocole permettant d'établir un flux de données continues entre deux points. Il repose sur IP, mais il permet aux programmes qui l'utilisent de faire abstraction des paquets eux-mêmes. Ces programmes ne voient qu'un point d'entrée dans lequel ils envoient des octets, ces octets ressortant sans perte (et dans l'ordre) au point de sortie. TCP compense en effet diverses erreurs qui peuvent apparaître au niveau réseau inférieur : les pertes de paquets déclenchent une retransmission et les données sont remises dans l'ordre le cas échéant (par exemple si tous les paquets n'empruntent pas le même itinéraire).
		</div><div
              class="para">
			UDP est également un protocole qui repose sur IP, mais à la différence de TCP il reste orienté paquet. Il n'a pas les mêmes buts non plus : il ne s'agit ici que de faire passer un paquet d'une application à une autre. Le protocole ne cherche pas à corriger les éventuelles pertes de paquets sur le réseau, pas plus qu'il ne va s'assurer que les paquets sont remis à l'application destinataire dans l'ordre où ils ont été émis. On y gagne généralement en temps de latence, puisque la perte d'un paquet ne bloque pas la réception des paquets suivants jusqu'à la retransmission du paquet perdu.
		</div><div
              class="para">
			TCP et UDP fonctionnent avec des ports, qui sont des points d'attache pour établir une connexion avec une application sur une machine. Ce concept permet d'avoir plusieurs communications différenciées avec le même interlocuteur, le numéro de port étant le critère distinctif.
		</div><div
              class="para">
			Certains de ces numéros — standardisés par l'IANA (<span
                class="foreignphrase"><em
                  class="foreignphrase">Internet Assigned Numbers Authority</em></span>, ou autorité Internet d'attribution des numéros) — sont associés à des services réseau. Par exemple, le port 25 est généralement employé par le serveur de courrier électronique. <div
                class="url">→ <a
                  href="http://www.iana.org/assignments/port-numbers">http://www.iana.org/assignments/port-numbers</a></div>
		</div></div><div
            class="para">
			Lorsqu'un réseau local utilise une plage d'adresses privées (non routables sur Internet), la passerelle doit effectuer du <span
              class="emphasis"><em>masquerading</em></span> (masquage d'adresses IP) pour que ses machines puissent communiquer avec l'extérieur. L'opération consiste à remplacer chaque connexion sortante par une connexion provenant de la passerelle elle-même (disposant, elle, d'une adresse valable sur le réseau externe) puis à faire suivre les données reçues en réponse à la machine ayant initiée la connexion. Pour mener à bien cette tâche, la passerelle dispose d'une plage de ports TCP dédiés au <span
              class="foreignphrase"><em
                class="foreignphrase">masquerading</em></span> (il s'agit souvent de numéros de port très élevés, supérieurs à 60 000). Chaque nouvelle connexion issue d'une machine interne apparaîtra à l'extérieur comme provenant de l'un de ces ports réservés. Lorsque la passerelle reçoit une réponse sur l'un d'entre eux, elle sait à quelle machine la faire suivre.
		</div><a
            id="idm140565677125344"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>CULTURE</em></span> Plages d'adresses privées</strong></p></div></div></div><a
              id="idm140565677123136"
              class="indexterm"></a><a
              id="idm140565677121696"
              class="indexterm"></a><div
              class="para">
			La RFC 1918 définit trois plages d'adresses IPv4 à ne pas router sur Internet, prévues pour un usage dans des réseaux locaux. La première, <code
                class="literal">10.0.0.0/8</code> (voir encadré <a
                class="xref"
                href="sect.network-config.html#sidebar.networking-basics"><span
                  class="emphasis"><em>B.A.-BA</em></span> Rappels réseau essentiels (Ethernet, adresse IP, sous-réseau, <span
                  class="foreignphrase"><em
                    class="foreignphrase">broadcast</em></span>...)</a>), est une plage de classe A (contenant 2<sup>24</sup> adresses IP). La deuxième, <code
                class="literal">172.16.0.0/12</code>, rassemble 16 plages de classe B (<code
                class="literal">172.16.0.0/16</code> à <code
                class="literal">172.31.0.0/16</code>) pouvant contenir chacune 2<sup>16</sup> adresses IP. La dernière, <code
                class="literal">192.168.0.0/16</code>, est une plage de classe B (regroupant les 256 plages de classe C <code
                class="literal">192.168.0.0/24</code> à <code
                class="literal">192.168.255.0/24</code>, de 256 adresses IP chacune). <div
                class="url">→ <a
                  href="http://www.faqs.org/rfcs/rfc1918.html">http://www.faqs.org/rfcs/rfc1918.html</a></div>
		</div></div><div
            class="para">
			La passerelle peut également effectuer une traduction d'adresses réseau (<span
              class="emphasis"><em>NAT</em></span>, ou <span
              class="foreignphrase"><em
                class="foreignphrase">Network Address Translation</em></span>). Il en existe de deux types. Le <span
              class="foreignphrase"><em
                class="foreignphrase">Destination NAT</em></span> (DNAT) est une technique pour altérer l'adresse IP (et/ou le port TCP ou UDP) destinataire d'une nouvelle connexion (généralement entrante). Le mécanisme de « suivi des connexions » (<span
              class="foreignphrase"><em
                class="foreignphrase">connection tracking</em></span>) altérera aussi les autres paquets de la même connexion pour assurer la continuité de la communication. Son pendant, le <span
              class="foreignphrase"><em
                class="foreignphrase">Source NAT</em></span> (SNAT), dont le <span
              class="foreignphrase"><em
                class="foreignphrase">masquerading</em></span> est un cas particulier, altère l'adresse IP (et/ou le port TCP ou UDP) source d'une nouvelle connexion (généralement sortante). Comme pour le DNAT, le suivi des connexions gère de manière adéquate les paquets suivants. Il est à noter que ce mécanisme de NAT n'est pertinent que dans le cas d'IPv4 ; l'abondance d'adresses fait que le NAT n'est pas requis sur les réseaux IPv6, ce qui simplifie les configurations puisque chaque adresse est routée directement (ce qui ne veut pas dire qu'elle soit accessible, des coupe-feu pouvant filtrer le trafic en chemin).
		</div><a
            id="idm140565685501424"
            class="indexterm"></a><a
            id="idm140565685500464"
            class="indexterm"></a><a
            id="idm140565685498704"
            class="indexterm"></a><a
            id="idm140565685497744"
            class="indexterm"></a><a
            id="idm140565685496784"
            class="indexterm"></a><a
            id="idm140565685495664"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>B.A.-BA</em></span> <span
                        class="foreignphrase"><em
                          class="foreignphrase">Port forwarding</em></span></strong></p></div></div></div><a
              id="idm140565685493104"
              class="indexterm"></a><div
              class="para">
			Le <span
                class="foreignphrase"><em
                  class="foreignphrase">port forwarding</em></span>, dont le principe est de rediriger (« faire suivre ») une connexion entrant sur un port donné vers un port d'une autre machine, se réalise facilement à partir d'une technique de DNAT. D'autres solutions techniques existent cependant pour obtenir un résultat similaire, notamment avec des redirections au niveau applicatif grâce à <code
                class="command">ssh</code> (voir <a
                class="xref"
                href="sect.remote-login.html#sect.ssh-port-forwarding">Section 9.2.1.3, « Créer des tunnels chiffrés avec le <span
                  class="foreignphrase"><em
                    class="foreignphrase">port forwarding</em></span> »</a>) ou <code
                class="command">redir</code>.
		</div></div><div
            class="para">
			Après la théorie, place à la pratique. Il est très facile de transformer un système Debian en passerelle : il suffit d'activer l'option adéquate du noyau Linux. On peut pour cela procéder par l'intermédiaire du système de fichiers virtuels <span
              class="emphasis"><em>/proc</em></span> :
		</div><pre
            class="screen">
<code
              class="computeroutput"># </code><strong
              class="userinput"><code>echo 1 &gt; /proc/sys/net/ipv4/conf/default/forwarding</code></strong></pre><div
            class="para">
			Pour activer cette option automatiquement à chaque démarrage, on positionnera dans le fichier <code
              class="filename">/etc/sysctl.conf</code> l'option <code
              class="literal">net.ipv4.conf.default.forwarding</code> à <code
              class="literal">1</code>.
		</div><div
            class="example"><a
              id="example.sysctl.conf"></a><p
              class="title"><strong>Exemple 10.1. Fichier <code
                  class="filename">/etc/sysctl.conf</code></strong></p><div
              class="example-contents"><pre
                class="programlisting">
net.ipv4.conf.default.forwarding = 1
net.ipv4.conf.default.rp_filter = 1
net.ipv4.tcp_syncookies = 1
</pre></div></div><div
            class="para">
			Pour IPv6, on remplacera simplement <code
              class="literal">ipv4</code> par <code
              class="literal">ipv6</code> dans la commande et on modifiera la ligne <code
              class="literal">net.ipv6.conf.all.forwarding</code> dans <code
              class="filename">/etc/sysctl.conf</code>.
		</div><div
            class="para">
			Activer le <span
              class="foreignphrase"><em
                class="foreignphrase">masquerading</em></span> IPv4 est une opération plus complexe, nécessitant de configurer le pare-feu <span
              class="emphasis"><em>netfilter</em></span>.
		</div><div
            class="para">
			L'emploi du NAT (en IPv4) nécessite lui aussi de configurer <span
              class="emphasis"><em>netfilter</em></span>. Comme il s'agit d'un élément logiciel dont la vocation première est de servir de filtre de paquets, il sera abordé dans le chapitre « Sécurité » (voir <a
              class="xref"
              href="sect.firewall-packet-filtering.html">Section 14.2, « Pare-feu ou filtre de paquets »</a>).
		</div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.power-management.html"><strong>Précédent</strong>9.12. Gestion de l'énergie : Advanced Configurati...</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Niveau supérieur</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Sommaire</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.virtual-private-network.html"><strong>Suivant</strong>10.2. Réseau privé virtuel</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/network-infrastructure.html">ar-MA</a></li><li><a
              href="../da-DK/network-infrastructure.html">da-DK</a></li><li><a
              href="../de-DE/network-infrastructure.html">de-DE</a></li><li><a
              href="../el-GR/network-infrastructure.html">el-GR</a></li><li><a
              href="../en-US/network-infrastructure.html">en-US</a></li><li><a
              href="../es-ES/network-infrastructure.html">es-ES</a></li><li><a
              href="../fa-IR/network-infrastructure.html">fa-IR</a></li><li><a
              href="../fr-FR/network-infrastructure.html">fr-FR</a></li><li><a
              href="../hr-HR/network-infrastructure.html">hr-HR</a></li><li><a
              href="../id-ID/network-infrastructure.html">id-ID</a></li><li><a
              href="../it-IT/network-infrastructure.html">it-IT</a></li><li><a
              href="../ja-JP/network-infrastructure.html">ja-JP</a></li><li><a
              href="../pl-PL/network-infrastructure.html">pl-PL</a></li><li><a
              href="../pt-BR/network-infrastructure.html">pt-BR</a></li><li><a
              href="../ro-RO/network-infrastructure.html">ro-RO</a></li><li><a
              href="../ru-RU/network-infrastructure.html">ru-RU</a></li><li><a
              href="../tr-TR/network-infrastructure.html">tr-TR</a></li><li><a
              href="../zh-CN/network-infrastructure.html">zh-CN</a></li></ul></div></body></html>
