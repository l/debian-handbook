<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">10.3. Qualité de service</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.1" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-fr-FR-1.0-1" /><meta
        name="keywords"
        content="Réseau, Passerelle, TCP/IP, IPv6, DNS, Bind, DHCP, QoS" /><link
        rel="home"
        href="index.html"
        title="Le cahier de l'administrateur Debian" /><link
        rel="up"
        href="network-infrastructure.html"
        title="Chapitre 10. Infrastructure réseau" /><link
        rel="prev"
        href="sect.virtual-private-network.html"
        title="10.2. Réseau privé virtuel" /><link
        rel="next"
        href="sect.dynamic-routing.html"
        title="10.4. Routage dynamique" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/fr-FR/sect.quality-of-service.html" /></head><body
      class="draft "><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="http://debian-handbook.info"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.virtual-private-network.html"><strong>Précédent</strong></a></li><li
          class="home">Le cahier de l'administrateur Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.dynamic-routing.html"><strong>Suivant</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.quality-of-service"></a>10.3. Qualité de service</h2></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.qos-principe"></a>10.3.1. Principe et fonctionnement</h3></div></div></div><div
            class="para">
				Le terme QoS (<span
              class="foreignphrase"><em
                class="foreignphrase">Quality of Service</em></span>) désigne l'ensemble des techniques permettant de garantir ou d'améliorer sensiblement la qualité de service apportée à des applications. La plus populaire consiste à traiter différemment chaque type de trafic réseau ; son application principale est le <span
              class="foreignphrase"><em
                class="foreignphrase">shaping</em></span>. Cela permet de limiter les débits attribués à certains services et/ou à certaines machines, notamment pour ne pas saturer la bande passante. Cette technique s'adapte bien au flux TCP car ce protocole s'adapte automatiquement au débit disponible.
			</div><a
            id="idm140565685667120"
            class="indexterm"></a><a
            id="idm140565685666000"
            class="indexterm"></a><a
            id="idm140565685664880"
            class="indexterm"></a><a
            id="idm140565685663440"
            class="indexterm"></a><div
            class="para">
				On peut encore modifier les priorités du trafic, ce qui permet généralement de traiter d'abord les paquets relatifs à des services interactifs (<code
              class="command">ssh</code>, <code
              class="command">telnet</code>) ou à des services échangeant de petits blocs de données.
			</div><div
            class="para">
				Les noyaux Debian intègrent le QoS et toute la panoplie des modules associés. Ils sont nombreux, et chacun offre un service différent — notamment par le biais de files d'attente pour les paquets IP (<span
              class="foreignphrase"><em
                class="foreignphrase">scheduler</em></span>, ou ordonnanceur), dont les mécanismes variés couvrent tout le spectre des besoins possibles.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>CULTURE</em></span> LARTC — <span
                        class="foreignphrase"><em
                          class="foreignphrase">Linux Advanced Routing &amp; Trafic Control</em></span></strong></p></div></div></div><div
              class="para">
				Le <span
                class="foreignphrase"><em
                  class="foreignphrase">HOWTO</em></span> du routage avancé et du contrôle de trafic sous Linux est un document de référence qui couvre de manière assez exhaustive tout ce qui concerne la qualité de service. <div
                class="url">→ <a
                  href="http://www.linux-france.org/prj/inetdoc/guides/lartc/lartc.html">http://www.linux-france.org/prj/inetdoc/guides/lartc/lartc.html</a></div>
			</div><a
              id="idm140565685655632"
              class="indexterm"></a><a
              id="idm140565685654192"
              class="indexterm"></a><a
              id="idm140565685652752"
              class="indexterm"></a></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.qos-config"></a>10.3.2. Configuration et mise en œuvre</h3></div></div></div><div
            class="para">
				Le QoS se paramètre avec le logiciel <code
              class="command">tc</code>, du paquet Debian <span
              class="pkg pkg">iproute</span>. Son interface étant extrêmement complexe, il est préférable d'employer des outils de plus haut niveau.
			</div><a
            id="idm140565685648528"
            class="indexterm"></a><a
            id="idm140565685647408"
            class="indexterm"></a><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="sect.qos-wondershaper"></a>10.3.2.1. Minimiser le temps de latence : <code
                      class="command">wondershaper</code></h4></div></div></div><div
              class="para">
					L'objectif de <code
                class="command">wondershaper</code> (du paquet Debian éponyme) est de minimiser les temps de latence quelle que soit la charge réseau. Il l'atteint en limitant le trafic total juste en deçà de la valeur de saturation de la ligne.
				</div><a
              id="idm140565685643680"
              class="indexterm"></a><a
              id="idm140565685642560"
              class="indexterm"></a><a
              id="idm140565685641600"
              class="indexterm"></a><div
              class="para">
					Après la configuration d'une interface réseau, il est possible de mettre en place ce contrôle du trafic par la commande <code
                class="command">wondershaper <em
                  class="replaceable">interface</em> <em
                  class="replaceable">débit_descendant</em> <em
                  class="replaceable">débit_montant</em></code>. L'interface sera par exemple <code
                class="literal">eth0</code> ou <code
                class="literal">ppp0</code> et les deux débits (descendant et montant) s'expriment en kilobits par seconde. La commande <code
                class="command">wondershaper remove <em
                  class="replaceable">interface</em></code> désactive le contrôle du trafic sur l'interface indiquée.
				</div><div
              class="para">
					Pour une connexion Ethernet, le plus simple est d'appeler automatiquement ce script après la configuration de l'interface en modifiant le fichier <code
                class="filename">/etc/network/interfaces</code> pour y ajouter des directives <code
                class="literal">up</code> (indiquant une commande à exécuter après configuration de l'interface) et <code
                class="literal">down</code> (indiquant une commande à exécuter après déconfiguration de l'interface) comme suit :
				</div><div
              class="example"><a
                id="example.network-interfaces"></a><p
                class="title"><strong>Exemple 10.9. Modification du fichier <code
                    class="filename">/etc/network/interfaces</code></strong></p><div
                class="example-contents"><pre
                  class="programlisting">
iface eth0 inet dhcp
    up /sbin/wondershaper eth0 500 100
    down /sbin/wondershaper remove eth0
</pre></div></div><div
              class="para">
					Dans le cas de PPP, la création d'un script appelant <code
                class="command">wondershaper</code> dans <code
                class="filename">/etc/ppp/ip-up.d/</code> activera le contrôle de trafic dès le démarrage de la connexion.
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>POUR ALLER PLUS LOIN</em></span> Configuration optimale</strong></p></div></div></div><div
                class="para">
					Le fichier <code
                  class="filename">/usr/share/doc/wondershaper/README.Debian.gz</code> détaille la méthode de configuration recommandée par le mainteneur du paquet. Il conseille d'effectuer des mesures de vitesses de téléchargement pour mieux évaluer les limites réelles.
				</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="sect.qos-config-standard"></a>10.3.2.2. Configuration standard</h4></div></div></div><div
              class="para">
					En l'absence d'une configuration particulière de QoS, le noyau Linux emploie la file d'attente <code
                class="literal">pfifo_fast</code>, qui propose déjà quelques fonctionnalités intéressantes. Pour établir les priorités des paquets IP, elle utilise leur champ ToS (<span
                class="foreignphrase"><em
                  class="foreignphrase">Type of Service</em></span>, ou type de service) — qu'il suffira donc de modifier pour bénéficier de cette file. Ce champ peut recevoir cinq valeurs :
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="itemizedlist"><ul><li
                  class="listitem"><div
                    class="para">
							<span
                      class="foreignphrase"><em
                        class="foreignphrase">Normal-Service</em></span> (0) (service normal) ;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<span
                      class="foreignphrase"><em
                        class="foreignphrase">Minimize-Cost</em></span> (2) (minimiser le coût) ;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<span
                      class="foreignphrase"><em
                        class="foreignphrase">Maximize-Reliability</em></span> (4) (maximiser la fiabilité) ;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<span
                      class="foreignphrase"><em
                        class="foreignphrase">Maximize-Throughput</em></span> (8) (maximiser le débit) ;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<span
                      class="foreignphrase"><em
                        class="foreignphrase">Minimize-Delay</em></span> (16) (minimiser le délai).
						</div></li></ul></div><a
              id="idm140565686322704"
              class="indexterm"></a><a
              id="idm140565686321744"
              class="indexterm"></a><div
              class="para">
					Le champ ToS peut être positionné par les applications qui génèrent des paquets IP ou modifié à la volée par <span
                class="emphasis"><em>netfilter</em></span>. Avec la règle ci-dessous, il est ainsi possible d'améliorer l'interactivité du service SSH d'un serveur :
				</div><pre
              class="programlisting scale">
iptables -t mangle -A PREROUTING -p tcp --sport ssh -j TOS --set-tos Minimize-Delay
iptables -t mangle -A PREROUTING -p tcp --dport ssh -j TOS --set-tos Minimize-Delay
</pre></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.virtual-private-network.html"><strong>Précédent</strong>10.2. Réseau privé virtuel</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Niveau supérieur</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Sommaire</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.dynamic-routing.html"><strong>Suivant</strong>10.4. Routage dynamique</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.quality-of-service.html">ar-MA</a></li><li><a
              href="../da-DK/sect.quality-of-service.html">da-DK</a></li><li><a
              href="../de-DE/sect.quality-of-service.html">de-DE</a></li><li><a
              href="../el-GR/sect.quality-of-service.html">el-GR</a></li><li><a
              href="../en-US/sect.quality-of-service.html">en-US</a></li><li><a
              href="../es-ES/sect.quality-of-service.html">es-ES</a></li><li><a
              href="../fa-IR/sect.quality-of-service.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.quality-of-service.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.quality-of-service.html">hr-HR</a></li><li><a
              href="../id-ID/sect.quality-of-service.html">id-ID</a></li><li><a
              href="../it-IT/sect.quality-of-service.html">it-IT</a></li><li><a
              href="../ja-JP/sect.quality-of-service.html">ja-JP</a></li><li><a
              href="../pl-PL/sect.quality-of-service.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.quality-of-service.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.quality-of-service.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.quality-of-service.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.quality-of-service.html">tr-TR</a></li><li><a
              href="../zh-CN/sect.quality-of-service.html">zh-CN</a></li></ul></div></body></html>
