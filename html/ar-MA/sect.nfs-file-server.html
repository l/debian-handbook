<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">11.4. مخدم الملفات NFS</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-ar-MA-1.0-1" /><meta
        name="keywords"
        content="Postfix, Apache, NFS, Samba, Squid, OpenLDAP, SIP" /><link
        rel="home"
        href="index.html"
        title="دفتر مدير دبيان" /><link
        rel="up"
        href="network-services.html"
        title="فصل 11. خدمات الشبكة: Postfix،‏ Apache،‏ NFS،‏ Samba،‏ Squid،‏ LDAP،‏ SIP،‏ XMPP،‏ TURN" /><link
        rel="prev"
        href="sect.ftp-file-server.html"
        title="11.3. مخدم الملفات FTP" /><link
        rel="next"
        href="sect.windows-file-server-with-samba.html"
        title="11.5. إعداد مشاركات ويندوز باستخدام سامبا" /><meta
        name="viewport"
        content="width=device-width, initial-scale=1" /><meta
        name="flattr:id"
        content="4pz9jq" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/ar-MA/sect.nfs-file-server.html" /></head><body
      dir="rtl"><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="../../"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.ftp-file-server.html"><strong>السابق</strong></a></li><li
          class="home">دفتر مدير دبيان</li><li
          class="next"><a
            accesskey="n"
            href="sect.windows-file-server-with-samba.html"><strong>التالي</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.nfs-file-server"></a>11.4. مخدم الملفات NFS</h2></div></div></div><div
          class="para">
			NFS ‏(<span
            class="emphasis"><em>Network File System</em></span>) هو بروتوكول يسمح بالوصول البعيد لنظم الملفات عبر الشبكة. تستطيع جميع نظم يونكس العمل مع هذا البروتوكول؛ لكن إذا دخلت نظم ويندوز على الصورة فلا بدَّ من استخدام Samba بدلاً منه.
		</div><a
          id="id-1.14.7.3"
          class="indexterm"></a><a
          id="id-1.14.7.4"
          class="indexterm"></a><a
          id="id-1.14.7.5"
          class="indexterm"></a><a
          id="id-1.14.7.6"
          class="indexterm"></a><a
          id="id-1.14.7.7"
          class="indexterm"></a><div
          class="para">
			أداة قوية جداً ولكنه يعاني، منذ الأزل، من قيود كثيرة، معظمها حلت في الإصدار 4 من البروتوكول. ولكن العيب هو أن إعداد الإصدار الأخير من NFS أصعب عندما ترغب باستخدام مزايا الحماية البسيطة مثل المصادقة والتشفير لأنه يعتمد على Kerberos في هذه الأجزاء. وإذا لم تستخدم هذه المزايا عليك الاقتصار على استخدام بروتوكول NFS في الشبكات المحلية الموثوقة فقط لأن البيانات تنتقل عبر الشبكة دون تشفير (يستطيع <span
            class="emphasis"><em>sniffer</em></span> التقاطها) كما تعطى صلاحيات الوصول اعتماداً على عنوان IP الخاص بالعميل (الذي يمكن تزويره).
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>توثيق</em></span> NFS HOWTO</strong></p></div></div></div><div
            class="para">
			لا توجد وثائق جيدة كثيرة تشرح استخدام NFSv4. إليك بعض المؤشرات إلى محتوى بمستويات جودة مختلفة لكن يجب على الأقل أن تعطيك تلميحات عما يجب أن تفعل. <div
              class="url">→ <a
                href="https://help.ubuntu.com/community/NFSv4Howto">https://help.ubuntu.com/community/NFSv4Howto</a></div> <div
              class="url">→ <a
                href="http://wiki.linux-nfs.org/wiki/index.php/Nfsv4_configuration">http://wiki.linux-nfs.org/wiki/index.php/Nfsv4_configuration</a></div>
		</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.14.7.10"></a>11.4.1. تأمين NFS</h3></div></div></div><a
            id="id-1.14.7.10.2"
            class="indexterm"></a><div
            class="para">
				إذا لم تكن تستخدم مزايا الأمان التي تعتمد على Kerberos فلا بد أن تضمن أن الأجهزة التي يسمح لها باستخدام NFS هي الوحيدة التي تستطيع الاتصال بمختلف مخدمات RPC اللازمة، لأن البروتوكول البسيط يثق بالمعلومات التي يستقبلها من الشبكة. يجب أن يمنع الجدار الناري أيضاً تزوير عناوين IP ‏(<span
              class="emphasis"><em>IP spoofing</em></span>) بحيث لا يسمح لأي جهاز خارجي أن ينتحل شخصية جهاز داخلي، ويجب حصر الوصول إلى المنافذ المعنية بالأجهزة التي يسمح لها بالوصول لمشاركات NFS.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>أساسيات</em></span> RPC</strong></p></div></div></div><div
              class="para">
				RPC ‏(<span
                class="emphasis"><em>Remote Procedure Call</em></span>، أو استدعاء الإجراءات البعيدة) هو معيار في يونكس للخدمات البعيدة. NFS هي واحدة من هذه الخدمات.
			</div><a
              id="id-1.14.7.10.4.3"
              class="indexterm"></a><a
              id="id-1.14.7.10.4.4"
              class="indexterm"></a><div
              class="para">
				تُسجَّل خدمات RPC في دليل يعرف باسم <span
                class="emphasis"><em>portmapper</em></span>. يتصل العميل الذي يرغب بإجراء طلب NFS مع <span
                class="emphasis"><em>portmapper</em></span> أولاً (على المنفذ 111، إما TCP أو UDP)، ويسأل عن مخدم NFS؛ يتضمن الرد عادة المنفذ 2049 (منفذ NFS الافتراضي). لا يشترط أن تستخدم جميع خدمات RPC منافذ ثابتة.
			</div></div><div
            class="para">
				كانت النسخ الأقدم من البروتوكول تتطلب خدمات RPC أخرى التي كانت تستخدم منافذ تتعين ديناميكياً. لحسن الحظ، لم تعد هناك حاجة إلا إلى المنفذ 2049 (لخدمة NFS) والمنفذ 111 (من أجل portmapper) وهذا يسهل إعداد الجدران النارية.
			</div><a
            id="id-1.14.7.10.6"
            class="indexterm"></a></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.14.7.11"></a>11.4.2. مخدم NFS</h3></div></div></div><div
            class="para">
				مخدم NFS جزء من النواة لينكس؛ وهو مبني كوحدة في النَوَى التي تقدمها دبيان. إذا كان هناك رغبة بتشغيل مخدم NFS تلقائياً عند الإقلاع، يجب تثبيت الحزمة <span
              class="pkg pkg">nfs-kernel-server</span>؛ فهي تحوي سكربتات بدء التشغيل المناسبة.
			</div><div
            class="para">
				يسرد ملف إعداد مخدم NFS، ‏<code
              class="filename">/etc/exports</code>،المجلدات التي سيوفرها على الشبكة (المجلدات المُصدّرة <span
              class="emphasis"><em>exported</em></span>). بالنسبة لكل مشاركة NFS، تمنح صلاحيات الوصول فقط للأجهزة المذكورة بجوارها. يمكن التحكم بالوصول بدقة أكبر باستخدام بضعة خيارات. صيغة الملف بسيطة جداً:
			</div><a
            id="id-1.14.7.11.4"
            class="indexterm"></a><a
            id="id-1.14.7.11.5"
            class="indexterm"></a><pre
            class="programlisting">
/directory/to/share machine1(option1,option2,...) machine2(...) ...
</pre><div
            class="para">
				لاحظ أنه في NFSv4، يجب أن تكون جميع المجلدات المصدرة تابعة لشجرة مجلدات واحدة وأن جذر تلك الشجرة يجب تصديره حتماً وتعريفه بالخيار <code
              class="literal">fsid=0</code> أو الخيار <code
              class="literal">fsid=root</code>.
			</div><div
            class="para">
				يمكن التعرف على الأجهزة باسم DNS أو بعنوان IP الخاص بها. كما يمكن تحديد مجموعات من الأجهزة باستخدام صيغة مثل <code
              dir="ltr"
              class="literal">*.falcot.com</code> أو مجال من عناوين IP مثل <code
              class="literal">192.168.0.0/255.255.255.0</code> أو <code
              class="literal">192.168.0.0/24</code>.
			</div><div
            class="para">
				تُصدّر المجلدات في وضع القراءة فقط افتراضياً (أو باستخدام الخيار <code
              class="literal">ro</code>). يمنح الخيار <code
              class="literal">rw</code> صلاحيات القراءة والكتابة. يتصل عملاء NFS نموذجياً من منفذ مخصص للمستخدم الجذر (أي أنه أقل من 1024)؛ يمكن رفع هذا القيد باستخدام الخيار <code
              class="literal">insecure</code> (الخيار <code
              class="literal">secure</code> ضمني، لكن يمكن كتابته صراحة للتوضيح إذا اقتضت الحاجة).
			</div><a
            id="id-1.14.7.11.10"
            class="indexterm"></a><div
            class="para">
				افتراضياً، يجيب المخدم فقط على طلبات NFS بعد إتمام العملية على القرص (الخيار <code
              class="literal">sync</code>)؛ لكن يمكن تعطيل هذا بالخيار <code
              class="literal">async</code>. تزيد عمليات الكتابة غير المتزامنة الأداء قليلاً، لكنها تخفض الموثوقية بسبب احتمال خسارة البيانات إذا انهار المخدم في الفترة ما بين إرسال تأكيد الكتابة وبين إنهاء الكتابة الفعلية على القرص. بما أن القيمة الافتراضية تغيرت مؤخراً (مقارنة بالقيمة التاريخية في NFS)، يُفضّل استخدام خيار صريح.
			</div><div
            class="para">
				يعتبر المخدم جميع الطلبات التي تبدو أنها واردة من المستخدم الجذر على أنها ترد من المستخدم <code
              class="literal">nobody</code>، وذلك في سبيل عدم منح صلاحيات الجذر على نظام الملفات لأي عميل NFS. هذا السلوك يوافق الخيار <code
              class="literal">root_squash</code>، وهو مُفعّل افتراضياً. أما الخيار <code
              class="literal">no_root_squash</code>، الذي يُعطّل هذا السلوك، فهو خطر ويجب استخدامه فقط في البيئات المسيطر عليها. يسمح الخياران <code
              class="literal">anonuid=<em
                class="replaceable">uid</em></code> و<code
              class="literal">anongid=<em
                class="replaceable">gid</em></code> بتحديد مستخدم زائف آخر لاستخدامه بدلاً من UID/GID 65534 (التي توافق المستخدم <code
              class="literal">nobody</code> والمجموعة <code
              class="literal">nogroup</code>).
			</div><div
            class="para">
				في NFSv4، يمكنك إضافة الخيار <code
              class="literal">sec</code> لتحديد مستوى الحماية الذي تريد: <code
              class="literal">sec=sys</code> هو الافتراضي وليس له خصائص أمنية مميزة، أما المستوى <code
              class="literal">sec=krb5</code> فيفعل المصادقة فقط، والمستوى <code
              class="literal">sec=krb5i</code> يضيف التحقق من سلامة المعلومات المنقولة، والمستوى <code
              class="literal">sec=krb5p</code> هو أكمل المستويات حيث يتضمن حماية الخصوصية (عبر تشفير البيانات). سوف تحتاج لإعداد Kerberos حتى تعمل هذه المستويات (هذه الخدمة غير مشروحة في هذا الكتاب).
			</div><div
            class="para">
				هناك خيارات أخرى متاحة؛ وهي موثّقة في صفحة الدليل <span
              class="citerefentry"><span
                class="refentrytitle">exports</span>(5)</span>‎.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>تحذير</em></span> التثبيت الأول</strong></p></div></div></div><div
              class="para">
				يبدأ سكربت الإقلاع <code
                dir="ltr"
                class="filename">/etc/init.d/nfs-kernel-server</code> تشغيل المخدم فقط إذا كان الملف <code
                dir="ltr"
                class="filename">/etc/exports</code> يذكر مشاركة NFS صالحة واحدة أو أكثر. عند الإعداد أول مرة، يجب تشغيل مخدم NFS يدوياً بعد تحرير هذا الملف باستخدام الأمر التالي:
			</div><pre
              class="screen">
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>service nfs-kernel-server start</code></strong></pre></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.14.7.12"></a>11.4.3. عميل NFS</h3></div></div></div><a
            id="id-1.14.7.12.2"
            class="indexterm"></a><a
            id="id-1.14.7.12.3"
            class="indexterm"></a><div
            class="para">
				كما في نظم الملفات الأخرى، يجب ربط (mount) مشاركات NFS في شجرة ملفات النظام لمدجها معها. بما أن نظام الملفات هذا له خصوصياته، فقد أضيفت بعض التعديلات على صيغة الأمر <code
              class="command">mount</code> والملف <code
              dir="ltr"
              class="filename">/etc/fstab</code>.
			</div><div
            class="example"><a
              id="id-1.14.7.12.5"></a><p
              class="title"><strong>مثال 11.22. الربط اليدوي باستخدام الأمر <code
                  class="command">mount</code></strong></p><div
              class="example-contents"><pre
                class="screen">
          <code
                  class="computeroutput"># </code><strong
                  class="userinput"><code>mount -t nfs4 -o rw,nosuid arrakis.internal.falcot.com:/shared /srv/shared</code></strong></pre></div></div><div
            class="example"><a
              id="id-1.14.7.12.6"></a><p
              class="title"><strong>مثال 11.23. مدخلة NFS في الملف <code
                  dir="ltr"
                  class="filename">/etc/fstab</code></strong></p><div
              class="example-contents"><pre
                class="programlisting">
arrakis.internal.falcot.com:/shared /srv/shared nfs4 rw,nosuid 0 0</pre></div></div><div
            class="para">
				تعمل المدخلة المبينة أعلاه على ربط مجلد NFS ‏<code
              class="filename">/shared/</code> من المخدم <code
              class="literal">arrakis</code> مع المجلد المحلي <code
              class="filename">/srv/shared/</code> عند إقلاع النظام. صلاحيات الكتابة والقراءة مطلوبة (ولذلك استخدم الخيار <code
              class="literal">rw</code>). أما الخيار <code
              class="literal">nosuid</code> فهو للحماية حيث يزيل بتات <code
              class="literal">setuid</code> أو <code
              class="literal">setgid</code> من البرامج المخزّنة على المشاركة. إذا كان القصد من مشاركة NFS تخزين المستندات فقط، فهناك خيار آخر ننصح به هو <code
              class="literal">noexec</code>، الذي يمنع تنفيذ البرامج المُخزَّنة على المشاركة. لاحظ أن المجلد <code
              class="filename">shared</code> على المخدم يقع تحت جذر التصدير في NFSv4 (مثلاً <code
              dir="ltr"
              class="filename">/export/shared</code>)، وليس مجلداً من المستوى الأعلى.
			</div><div
            class="para">
				تشرح صفحة الدليل <span
              class="citerefentry"><span
                class="refentrytitle">nfs</span>(5)</span>‎ ‎جميع الخيارات بشيء من التفصيل.
			</div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.ftp-file-server.html"><strong>السابق</strong>11.3. مخدم الملفات FTP</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>أعلى</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>البداية</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.windows-file-server-with-samba.html"><strong>التالي</strong>11.5. إعداد مشاركات ويندوز باستخدام سامبا</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.nfs-file-server.html">ar-MA</a></li><li><a
              href="../da-DK/sect.nfs-file-server.html">da-DK</a></li><li><a
              href="../de-DE/sect.nfs-file-server.html">de-DE</a></li><li><a
              href="../el-GR/sect.nfs-file-server.html">el-GR</a></li><li><a
              href="../en-US/sect.nfs-file-server.html">en-US</a></li><li><a
              href="../es-ES/sect.nfs-file-server.html">es-ES</a></li><li><a
              href="../fa-IR/sect.nfs-file-server.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.nfs-file-server.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.nfs-file-server.html">hr-HR</a></li><li><a
              href="../id-ID/sect.nfs-file-server.html">id-ID</a></li><li><a
              href="../it-IT/sect.nfs-file-server.html">it-IT</a></li><li><a
              href="../ja-JP/sect.nfs-file-server.html">ja-JP</a></li><li><a
              href="../ko-KR/sect.nfs-file-server.html">ko-KR</a></li><li><a
              href="../nb-NO/sect.nfs-file-server.html">nb-NO</a></li><li><a
              href="../pl-PL/sect.nfs-file-server.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.nfs-file-server.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.nfs-file-server.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.nfs-file-server.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.nfs-file-server.html">tr-TR</a></li><li><a
              href="../vi-VN/sect.nfs-file-server.html">vi-VN</a></li><li><a
              href="../zh-CN/sect.nfs-file-server.html">zh-CN</a></li><li><a
              href="../zh-TW/sect.nfs-file-server.html">zh-TW</a></li></ul></div></body></html>
