<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">5.2. Metainformação do Pacote</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.1" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-pt-BR-1.0-1" /><meta
        name="keywords"
        content="Pacote Binário, Pacote fonte, dpkg, dependências, conflitos" /><link
        rel="home"
        href="index.html"
        title="O Manual do Administrador Debian" /><link
        rel="up"
        href="packaging-system.html"
        title="Capítulo 5. Sistema de Pacotes: Ferramentas e Princípios Fundamentais" /><link
        rel="prev"
        href="packaging-system.html"
        title="Capítulo 5. Sistema de Pacotes: Ferramentas e Princípios Fundamentais" /><link
        rel="next"
        href="sect.source-package-structure.html"
        title="5.3. Estrutura de um Pacote Fonte" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/pt-BR/sect.package-meta-information.html" /></head><body
      class="draft "><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="http://debian-handbook.info"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="packaging-system.html"><strong>Anterior</strong></a></li><li
          class="home">O Manual do Administrador Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.source-package-structure.html"><strong>Próxima</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.package-meta-information"></a>5.2. Metainformação do Pacote</h2></div></div></div><a
          id="idm140194937523760"
          class="indexterm"></a><a
          id="idm140194937522832"
          class="indexterm"></a><div
          class="para">
			The Debian package is not only an archive of files intended for installation. It is part of a larger whole, and it describes its relationship with other Debian packages (dependencies, conflicts, suggestions). It also provides scripts that enable the execution of commands at different stages in the package's lifecycle (installation, removal, upgrades). These data are used by the package management tools but are not part of the packaged software; they are, within the package, what is called its “meta-information” (information about other information).
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.control"></a>5.2.1. Descrição: O arquivo <code
                    class="filename">control</code></h3></div></div></div><a
            id="idm140194932648224"
            class="indexterm"></a><a
            id="idm140194932647296"
            class="indexterm"></a><a
            id="idm140194932645856"
            class="indexterm"></a><div
            class="para">
				This file uses a structure similar to email headers (as defined by RFC 2822). For example, for <span
              class="pkg pkg">apt</span>, the <code
              class="filename">control</code> file looks like the following:
			</div><pre
            class="screen">
<code
              class="computeroutput">$ </code><strong
              class="userinput"><code>apt-cache show apt</code></strong>
<code
              class="computeroutput">Package: apt
Version: 1.0.9.6
Installed-Size: 3788
Maintainer: APT Development Team &lt;deity@lists.debian.org&gt;
Architecture: amd64
Replaces: manpages-it (&lt;&lt; 2.80-4~), manpages-pl (&lt;&lt; 20060617-3~), openjdk-6-jdk (&lt;&lt; 6b24-1.11-0ubuntu1~), sun-java5-jdk (&gt;&gt; 0), sun-java6-jdk (&gt;&gt; 0)
Depends: libapt-pkg4.12 (&gt;= 1.0.9.6), libc6 (&gt;= 2.15), libgcc1 (&gt;= 1:4.1.1), libstdc++6 (&gt;= 4.9), debian-archive-keyring, gnupg
Suggests: aptitude | synaptic | wajig, dpkg-dev (&gt;= 1.17.2), apt-doc, python-apt
Conflicts: python-apt (&lt;&lt; 0.7.93.2~)
Breaks: manpages-it (&lt;&lt; 2.80-4~), manpages-pl (&lt;&lt; 20060617-3~), openjdk-6-jdk (&lt;&lt; 6b24-1.11-0ubuntu1~), sun-java5-jdk (&gt;&gt; 0), sun-java6-jdk (&gt;&gt; 0)
Description-en: commandline package manager
 This package provides commandline tools for searching and
 managing as well as querying information about packages
 as a low-level access to all features of the libapt-pkg library.
 .
 These include:
  * apt-get for retrieval of packages and information about them
    from authenticated sources and for installation, upgrade and
    removal of packages together with their dependencies
  * apt-cache for querying available information about installed
    as well as installable packages
  * apt-cdrom to use removable media as a source for packages
  * apt-config as an interface to the configuration settings
  * apt-key as an interface to manage authentication keys
Description-md5: 9fb97a88cb7383934ef963352b53b4a7
Tag: admin::package-management, devel::lang:ruby, hardware::storage,
 hardware::storage:cd, implemented-in::c++, implemented-in::perl,
 implemented-in::ruby, interface::commandline, network::client,
 protocol::ftp, protocol::http, protocol::ipv6, role::program,
 role::shared-lib, scope::application, scope::utility, sound::player,
 suite::debian, use::downloading, use::organizing, use::searching,
 works-with::audio, works-with::software:package, works-with::text
Section: admin
Priority: important
Filename: pool/main/a/apt/apt_1.0.9.6_amd64.deb
Size: 1107560
MD5sum: a325ccb14e69fef2c50da54e035a4df4
SHA1: 635d09fcb600ec12810e3136d51e696bcfa636a6
SHA256: 371a559ce741394b59dbc6460470a9399be5245356a9183bbeea0f89ecaabb03</code></pre><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DE VOLTA AO BÁSICO</em></span> RFC — Padrões da Internet</strong></p></div></div></div><a
              id="idm140194932638336"
              class="indexterm"></a><a
              id="idm140194932637376"
              class="indexterm"></a><div
              class="para">
				RFC é a sigla de “Request For Comments” (requisitando comentários). Um RFC é geralmente um documento técnico que descreve o que se tornará um padrão de Internet. Antes de se padronizar e congelar, estes padrões são submetidos para revisão pública (por isto o nome). O IETF (Internet Engineering Task Force - Força-tarefa de Engenharia da Internet) decide sobre a evolução do status destes documentos (proposed standard - padrão proposto, draft standard - padrão rascunho ou standard - padrão).
			</div><div
              class="para">
				RFC 2026 define o processo de padronização dos protocolos de Internet. <div
                class="url">→ <a
                  href="http://www.faqs.org/rfcs/rfc2026.html">http://www.faqs.org/rfcs/rfc2026.html</a></div>
			</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="idm140194932634144"></a>5.2.1.1. Dependências: o campo <code
                      class="literal">Depends</code> (depende de)</h4></div></div></div><a
              id="idm140194932632864"
              class="indexterm"></a><a
              id="idm140194932631904"
              class="indexterm"></a><a
              id="idm140194932630624"
              class="indexterm"></a><div
              class="para">
					The dependencies are defined in the <code
                class="literal">Depends</code> field in the package header. This is a list of conditions to be met for the package to work correctly — this information is used by tools such as <code
                class="command">apt</code> in order to install the required libraries, in appropriate versions fulfilling the dependencies of the package to be installed. For each dependency, it is possible to restrict the range of versions that meet that condition. In other words, it is possible to express the fact that we need the package <span
                class="pkg pkg">libc6</span> in a version equal to or greater than “2.15” (written “<code
                class="command">libc6 (&gt;= 2.15)</code>”). Version comparison operators are as follows:
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="itemizedlist"><ul><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">&lt;&lt;</code>: menor que;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">&lt;=</code>: menor ou igual que;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">=</code>: igual a (obs, este “<code
                      class="literal">2.6.1</code>” não é igual a “<code
                      class="literal">2.6.1-1</code>”);
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">&gt;=</code>: maior ou igual que;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">&gt;&gt;</code>: maior que.
						</div></li></ul></div><div
              class="para">
					Numa lista de condições para serem satisfeitas, a vírgula serve como um separador. Ela deve ser interpretada como um "e" lógico. Em condicionais, a barra vertical ("|") expressa um "ou" lógico (é um "ou" inclusivo, não um "ou isto ou aquilo"). Tem prioridade sobre o "e", pode ser usado tanto quanto necessário. Portanto, a dependência "(A ou B) e C" é escrita como <code
                class="command">A | B, C</code>. Por outro lado, a expressão "A ou (B e C)" deve ser escrita como "(A ou B) e (A ou C)", uma vez que o campo <code
                class="literal">Depends</code> não aceita parêntesis que mudem a ordem de prioridades entre os operadores lógicos "ou" e "e". Ele poderia ser escrito, portanto, como <code
                class="command">A | B, A | C</code>. <div
                class="url">→ <a
                  href="http://www.debian.org/doc/debian-policy/ch-relationships.html">http://www.debian.org/doc/debian-policy/ch-relationships.html</a></div>
				</div><a
              id="idm140194932614384"
              class="indexterm"></a><div
              class="para">
					O sistema de dependências é um bom mecanismo para garantir a operação de um programa, mas ele tem outro uso com os "meta-pacotes". Estes são pacotes vazios que apenas descrevem dependências. Eles facilitam a instalação de um grupo consistente de programas pré-selecionados pelo mantenedor do meta-pacote; assim, <code
                class="command">apt-get install <em
                  class="replaceable">meta-package</em></code> vai instalar automaticamente todos os programas nas dependências do meta-pacote. Os pacotes <span
                class="pkg pkg">gnome</span>, <span
                class="pkg pkg">kde-full</span> e <span
                class="pkg pkg">linux-image-amd64</span> são exemplos de meta-pacotes.
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>DEBIAN POLICY</em></span> <code
                          class="literal">Pre-Depends</code>, um <code
                          class="literal">Depends</code> mais exigente</strong></p></div></div></div><a
                id="idm140194932607808"
                class="indexterm"></a><a
                id="idm140194932606528"
                class="indexterm"></a><div
                class="para">
					“Pré-dependências”, que são listadas no campo “<code
                  class="literal">Pre-Depends</code>” nos cabeçalhos dos pacotes, completam as dependências normais; suas sintaxes são idênticas. Uma dependência normal indica que o pacote em questão deve ser desempacotado antes do pacote que declarou dependência. Uma pré-dependência estipula que o pacote em questão deve ser desempacotado e configurado antes da execução do script de pré-instalação do pacote declarando dependência, que é antes da sua instalação.
				</div><div
                class="para">
					Uma pré-dependência é muito pesada para o <code
                  class="command">apt</code>, por que ela adiciona uma restrição estrita na ordem dos pacotes a instalar. Desta forma, pré-dependências são desencorajadas a menos que absolutamente necessárias. É até mesmo recomendado consultar outros desenvolvedores no <code
                  class="email"><a
                    class="email"
                    href="mailto:debian-devel@lists.debian.org">debian-devel@lists.debian.org</a></code> antes de adicionar uma pré-dependência. Geralmente é possível encontrar outra solução que resolva o problema.
				</div></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong>Os campos <span
                          class="emphasis"><em>DEBIAN POLICY</em></span>, <code
                          class="literal">Recommends</code>, <code
                          class="literal">Suggests</code> e <code
                          class="literal">Enhances</code></strong></p></div></div></div><a
                id="idm140194932599712"
                class="indexterm"></a><a
                id="idm140194932598432"
                class="indexterm"></a><div
                class="para">
					Os campos <code
                  class="literal">Recommends</code> e <code
                  class="literal">Suggests</code> descrevem dependências que não são compulsórias. As dependências "recomendadas" (recommended), as mais importantes, melhoram consideravelmente a funcionalidade oferecida pelo pacote mas não são indispensáveis para seu funcionamento. As dependências "sugeridas" (suggested), de importância secundária, indicam que certos pacotes podem complementar e melhorar suas funcionalidades, mas é perfeitamente normal instalar o pacotes sem estas "sugestões".
				</div><div
                class="para">
					você deve sempre instalar os pacotes “recomendados”, a menos que você saiba exatamente por que você não precisa deles. Por outro lado, não é necessário instalar pacotes “sugeridos” a menos que você saiba por que precisa deles.
				</div><a
                id="idm140194932594544"
                class="indexterm"></a><div
                class="para">
					O campo <code
                  class="literal">Enhances</code> também descreve uma sugestão, mas num contexto diferente. Ele é, na verdade, localizado no pacote sugerido, e não no pacote que se beneficia da sugestão. Seu interesse reside no fato de ser possível adicionar uma sugestão sem ter que modificar o pacote beneficiado. Assim, todos os extras, plugins e outras extensões de um programa podem, então, aparecer na lista de sugestões relativas ao software. Embora exista a vários anos, este último campo ainda é bastante ignorado por vários programas como o <code
                  class="command">apt-get</code> ou o <code
                  class="command">synaptic</code>. O objetivo é que uma sugestão feita pelo campo <code
                  class="literal">Enhances</code> apareça para o usuário junto com as sugestões adicionais — encontradas no campo <code
                  class="literal">Suggests</code>.
				</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="idm140194932589632"></a>5.2.1.2. Conflicts: o campo <code
                      class="literal">Conflicts</code></h4></div></div></div><a
              id="idm140194932588512"
              class="indexterm"></a><a
              id="idm140194932587552"
              class="indexterm"></a><a
              id="idm140194932586272"
              class="indexterm"></a><div
              class="para">
					O campo <code
                class="literal">Conflicts</code> indica quando um pacote não pode ser instalado simultaneamente com outro. As razões mais comuns para isto é que ambos os pacotes incluem um arquivo de mesmo nome, ou fornecem o mesmo serviço na mesma porta TCP, ou vão atrapalhar a operação um do outro.
				</div><div
              class="para">
					O <code
                class="command">dpkg</code> vai se recusar a instalar um pacote se ele iniciar um conflito com um pacote já instalado, a menos que o novo pacote especifique que ele "substitui" o pacote instalado, e neste caso o <code
                class="command">dpkg</code> vai escolher substituir o pacote antigo pelo novo. O <code
                class="command">apt-get</code> sempre vai seguir suas instruções: se você escolher instalar um novo pacote, ele vai automaticamente se oferecer para desinstalar o pacote que apresentar um problema.
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="idm140194932581232"></a>5.2.1.3. Incompatibilidades: o campo <code
                      class="literal">Breaks</code></h4></div></div></div><a
              id="idm140194932580144"
              class="indexterm"></a><a
              id="idm140194932579184"
              class="indexterm"></a><a
              id="idm140194932577904"
              class="indexterm"></a><div
              class="para">
					O campo <code
                class="literal">Breaks</code> tem um efeito similar ao do campo <code
                class="literal">Conflicts</code>, mas com um significado especial. Ele assinala que a instalação de um pacote vai "quebrar" outro pacote (ou versões específicas dele). Em geral, esta incompatibilidade entre dois pacotes é transitória, e a relação <code
                class="literal">Breaks</code> se refere especificamente a estas versões incompatíveis.
				</div><div
              class="para">
					O <code
                class="command">dpkg</code> vai se recusar a instalar um pacote que quebra um pacote já instalado, e o <code
                class="command">apt-get</code> vai tentar resolver o problema atualizando o pacote que vai ser quebrado para uma nova versão (que se espera que tenha sido corrigida, logo, voltou a ser compatível).
				</div><div
              class="para">
					Este tipo de situação pode ocorrer no caso de atualizações sem retrocompatibilidade: este é o caso se a nova versão não funciona mais com a versão antiga, e causa um mal funcionamento em outro programa sem fazer "provisões especiais". O campo <code
                class="literal">Breaks</code> evita que o usuário se ponha nestes tipos de problemas.
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="idm140194932571344"></a>5.2.1.4. Itens fornecidos: o campo <code
                      class="literal">Provides</code></h4></div></div></div><a
              id="idm140194932570256"
              class="indexterm"></a><div
              class="para">
					Este campo introduz o interessante conceito de "pacote virtual". Ele tem muitos papéis, mas dois são de especial importância. O primeiro consiste em usar um pacote virtual para associar um serviço genérico com ele (o pacote "fornece" o serviço). O segundo indica que um pacote substitui completamente o outro, e que para este propósito ele também pode satisfazer as dependências que o outro satisfaz. É também possível criar um pacote de substituição sem ter que usar o mesmo nome de pacote.
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>VOCABULARY</em></span> Meta-pacote e pacote virtual</strong></p></div></div></div><a
                id="idm140194932566912"
                class="indexterm"></a><a
                id="idm140194932565952"
                class="indexterm"></a><a
                id="idm140194932564512"
                class="indexterm"></a><div
                class="para">
					É essencial distinguir claramente meta-pacotes de pacotes virtuais. Os primeiros são pacotes reais (incluindo arquivos <code
                  class="filename">.deb</code> reais), cujo único propósito é expressar dependências.
				</div><div
                class="para">
					Pacotes virtuais, por outro lado, não existem fisicamente; eles são simplesmente um meio de identificar pacotes reais basedo em critérios lógicos, comuns (serviço fornecido, compatibilidade com um programa padrão ou um pacote pré-existente, etc.).
				</div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        id="idm140194932561536"></a>5.2.1.4.1. Fornecendo um “Serviço”</h5></div></div></div><div
                class="para">
						Let us discuss the first case in greater detail with an example: all mail servers, such as <span
                  class="pkg pkg">postfix</span> or <span
                  class="pkg pkg">sendmail</span> are said to “provide” the <span
                  class="pkg pkg">mail-transport-agent</span> virtual package. Thus, any package that needs this service to be functional (e.g. a mailing list manager, such as <span
                  class="pkg pkg">smartlist</span> or <span
                  class="pkg pkg">sympa</span>) simply states in its dependencies that it requires a <span
                  class="pkg pkg">mail-transport-agent</span> instead of specifying a large yet incomplete list of possible solutions (e.g. <code
                  class="command">postfix | sendmail | exim4 | …</code>). Furthermore, it is useless to install two mail servers on the same machine, which is why each of these packages declares a conflict with the <span
                  class="pkg pkg">mail-transport-agent</span> virtual package. A conflict between a package and itself is ignored by the system, but this technique will prohibit the installation of two mail servers side by side.
					</div><div
                class="sidebar"><div
                  class="titlepage"><div><div><p
                        class="title"><strong><span
                            class="emphasis"><em>DEBIAN POLICY</em></span> Lista de pacotes virtuais</strong></p></div></div></div><a
                  id="idm140194932553792"
                  class="indexterm"></a><div
                  class="para">
						Para que pacotes virtuais sejam úteis, todos têm que concordar com seus nomes. É por isto que eles são padronizados na Política Debian. A lista inclui entre outros <span
                    class="pkg pkg">mail-transport-agent</span> para servidores de e-mail, <span
                    class="pkg pkg">c-compiler</span> para compiladores de linguagem C, <span
                    class="pkg pkg">www-browser</span> para navegadores web, <span
                    class="pkg pkg">httpd</span> para servidores web, <span
                    class="pkg pkg">ftp-server</span> para servidores FTP, <span
                    class="pkg pkg">x-terminal-emulator</span> para emuladores de terminal em modo gráfico (<code
                    class="command">xterm</code>) e <span
                    class="pkg pkg">x-window-manager</span> para gerenciadores de janelas.
					</div><div
                  class="para">
						A lista completa pode ser encontrada na rede. <div
                    class="url">→ <a
                      href="http://www.debian.org/doc/packaging-manuals/virtual-package-names-list.txt">http://www.debian.org/doc/packaging-manuals/virtual-package-names-list.txt</a></div>
					</div></div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        id="idm140194932545216"></a>5.2.1.4.2. "Interchangeability" com outro pacote</h5></div></div></div><div
                class="para">
						The <code
                  class="literal">Provides</code> field is also interesting when the content of a package is included in a larger package. For example, the <span
                  class="pkg pkg">libdigest-md5-perl</span> Perl module was an optional module in Perl 5.6, and has been integrated as standard in Perl 5.8 (and later versions, such as 5.20 present in <span
                  class="distribution distribution">Jessie</span>). As such, the package <span
                  class="pkg pkg">perl</span> has since version 5.8 declared <code
                  class="literal">Provides: libdigest-md5-perl</code> so that the dependencies on this package are met if the user has Perl 5.8 (or newer). The <span
                  class="pkg pkg">libdigest-md5-perl</span> package itself has eventually been deleted, since it no longer had any purpose when old Perl versions were removed.
					</div><div
                class="figure"><a
                  id="idm140194932540112"></a><div
                  class="figure-contents"><div
                    class="mediaobject"><img
                      src="images/virtual-package.png"
                      alt="Uso de um campo Provides para não quebrar dependências" /></div></div><p
                  class="title"><strong>Figura 5.1. Uso de um campo <code
                      class="literal">Provides</code> para não quebrar dependências</strong></p></div><div
                class="para">
						Esta funcionalidade é muito útil, já que nunca é possível antecipar os caprichos do desenvolvimento, e é preciso poder se renomear, e fazer outras substituições automáticas, de software obsoleto.
					</div><div
                class="sidebar"><div
                  class="titlepage"><div><div><p
                        class="title"><strong><span
                            class="emphasis"><em>DE VOLTA AO BÁSICO</em></span> Perl, uma linguagem de programação</strong></p></div></div></div><a
                  id="idm140194932535104"
                  class="indexterm"></a><a
                  id="idm140194932534144"
                  class="indexterm"></a><div
                  class="para">
						Perl (Practical Extraction and Report Language) é uma linguagem de programação muito popular. Ela tem muitos módulos prontos-para-usar que cobrem um vasto espectro de aplicações e que são distribuídas pelos servidores CPAN (Comprehensive Perl Archive Network), uma ampla rede de pacotes Perl. <div
                    class="url">→ <a
                      href="http://www.perl.org/">http://www.perl.org/</a></div> <div
                    class="url">→ <a
                      href="http://www.cpan.org/">http://www.cpan.org/</a></div>
					</div><div
                  class="para">
						Como é uma linguagem interpretada, um programa escrito em Perl não precisa de compilação antes da execução. É por isto que são chamados "scripts Perl".
					</div></div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        id="idm140194932530048"></a>5.2.1.4.3. Past Limitations</h5></div></div></div><div
                class="para">
						Virtual packages used to suffer from some limitations, the most significant of which was the absence of a version number. To return to the previous example, a dependency such as <code
                  class="literal">Depends: libdigest-md5-perl (&gt;= 1.6)</code>, despite the presence of Perl 5.10, would never be considered as satisfied by the packaging system — while in fact it most likely is satisfied. Unaware of this, the package system chose the least risky option, assuming that the versions do not match.
					</div><div
                class="para">
						This limitation has been lifted in <span
                  class="pkg pkg">dpkg</span> 1.17.11, and is no longer relevant in Jessie.
					</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="idm140194932526496"></a>5.2.1.5. Substituindo arquivos: o campo <code
                      class="literal">Replaces</code></h4></div></div></div><a
              id="idm140194932525408"
              class="indexterm"></a><a
              id="idm140194932524448"
              class="indexterm"></a><a
              id="idm140194932523168"
              class="indexterm"></a><div
              class="para">
					The <code
                class="literal">Replaces</code> field indicates that the package contains files that are also present in another package, but that the package is legitimately entitled to replace them. Without this specification, <code
                class="command">dpkg</code> fails, stating that it can not overwrite the files of another package (technically, it is possible to force it to do so with the <code
                class="literal">--force-overwrite</code> option, but that's not considered standard operation). This allows identification of potential problems and requires the maintainer to study the matter prior to choosing whether to add such a field.
				</div><div
              class="para">
					O uso deste campo é justificado quando os nomes dos pacotes mudam ou quando um pacote é incluído em outro. Também acontece quando o mantenedor decide distribuir arquivos diferentes entre vários pacotes binários produzidos a partir do mesmo fonte: um arquivo substituído não pertence mais ao pacote antigo, mas apenas ao novo.
				</div><div
              class="para">
					Se todos os arquivos num pacote instalado foram substituídos, o pacote é considerado "a ser removido". Finalmente, este campo também encoraja o <code
                class="command">dpkg</code> a remover o pacote substituido onde existir conflito.
				</div><div
              class="sidebar"><a
                id="sidebar.debtags"></a><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>INDO ALÉM</em></span> O campo <code
                          class="literal">Tag</code></strong></p></div></div></div><div
                class="para">
					No exemplo do <span
                  class="pkg pkg">apt</span> acima, vimos um campo que ainda não descrevemos, O campo <code
                  class="literal">Tag</code> ("etiqueta"). Este campo não descreve uma relação entre pacotes, é simplesmente uma forma de categorizar um pacote numa taxonomia temática. Esta classificação de pacote de acordo com vários critérios (tipo de interface, linguagem de programação, domínio de aplicação, etc) está disponível a muito tempo. Apesar disto, nem todos os pacotes têm etiquetas precisas e estas ainda não estão integradas em todas as ferramentas Debian; o <code
                  class="command">aptitude</code> mostra estas etiquetas, e permite que elas sejam usadas como critério de busca. Para os que fogem dos critérios de busca do <code
                  class="command">aptitude</code>, os seguintes sítios permitem navegação no banco de dados de etiquetas: <div
                  class="url">→ <a
                    href="http://debtags.alioth.debian.org/">http://debtags.alioth.debian.org/</a></div>
				</div></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="idm140194932511376"></a>5.2.2. Scripts de Configuração</h3></div></div></div><a
            id="idm140194932510608"
            class="indexterm"></a><a
            id="idm140194932509488"
            class="indexterm"></a><a
            id="idm140194932508368"
            class="indexterm"></a><a
            id="idm140194932507248"
            class="indexterm"></a><a
            id="idm140194932506128"
            class="indexterm"></a><div
            class="para">
				Além do arquivo <code
              class="filename">control</code>, o arquivamento <code
              class="filename">control.tar.gz</code> para cada pacote Debian pode conter vários scripts, chamados pelo <code
              class="command">dpkg</code> em diferentes estágios do processamento de um pacote. A política Debian descreve os possíveis casos em detalhes, especificando os scripts e os argumentos que eles recebem. Estas sequências podem se complicadas, já que se um dos scripts falha, o <code
              class="command">dpkg</code> vai tentar retornar a um estado satisfatório cancelando a instalação ou a remoção em andamento (na medida do possível).
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>INDO ALÉM</em></span> banco de dados do <code
                        class="command">dpkg</code></strong></p></div></div></div><a
              id="idm140194932500768"
              class="indexterm"></a><a
              id="idm140194932499648"
              class="indexterm"></a><div
              class="para">
				Todos os scripts de configuração para pacotes instalados são armazenados no diretório <code
                class="filename">/var/lib/dpkg/info/</code>, na forma de um arquivo prefixado com o nome do pacote. Este diretório também inclui um arquivo com a extensão <code
                class="filename">.list</code> para cada pacote, contendo a lista de arquivos que pertencem a este pacote.
			</div><div
              class="para">
				O arquivo <code
                class="filename">/var/lib/dpkg/status</code> contém uma série de blocos de dados (no formato dos famosos mail headers, RFC 2822) descrevendo o status de cada pacote. A informação do arquivo <code
                class="filename">control</code> dos pacotes instalados é duplicada aqui.
			</div></div><div
            class="para">
				Em geral, o script <code
              class="filename">preinst</code> é executado antes da instalação do pacote, enquanto que o <code
              class="filename">postinst</code> é logo depois. Da mesma forma, o <code
              class="filename">prerm</code> é chamado antes da remoção de um pacote e o <code
              class="filename">postrm</code> depois. Uma atualização de um pacote é equivalente à remoção da versão anterior e a instalação do novo. Não é possível descrever em detalhes todos os cenários possíveis aqui, mas vamos discutir os dois mais comuns: uma instalação/atualização e uma remoção.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ATENÇÃO</em></span> nomes simbólicos dos scripts</strong></p></div></div></div><div
              class="para">
				As sequências descritas nesta seção chamam scripts de configuração por nomes específicos, como <code
                class="command">old-prerm</code> ou <code
                class="command">new-postinst</code>. Eles são, respectivamente, o script <code
                class="command">prerm</code> contido na versão antiga do pacote (instalado antes da atualização) e o script <code
                class="command">postinst</code> contido na nova versão (instalado pela atualização).
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DICA</em></span> Diagramas de estado</strong></p></div></div></div><div
              class="para">
				Manoj Srivastava fez estes diagramas explicando como os scripts de configuração são chamados pelo <code
                class="command">dpkg</code>. Diagramas similares também foram desenvolvidos pelo Projeto Debian Women; Eles são um pouco mais simples de entender, mas menos completos. <div
                class="url">→ <a
                  href="http://people.debian.org/~srivasta/MaintainerScripts.html">http://people.debian.org/~srivasta/MaintainerScripts.html</a></div> <div
                class="url">→ <a
                  href="http://wiki.debian.org/MaintainerScripts">http://wiki.debian.org/MaintainerScripts</a></div>
			</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="idm140194934188576"></a>5.2.2.1. Instalação e upgrade (atualização)</h4></div></div></div><a
              id="idm140194934187808"
              class="indexterm"></a><div
              class="para">
					Aqui está o que acontece durante uma instalação (ou uma atualização):
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="orderedlist"><ol><li
                  class="listitem"><div
                    class="para">
							Para uma atualização ("update"), o <code
                      class="command">dpkg</code> chama o <code
                      class="command">old-prerm upgrade <em
                        class="replaceable">new-version</em></code>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							Ainda para uma atualização, o <code
                      class="command">dpkg</code> então executa <code
                      class="command">new-preinst upgrade <em
                        class="replaceable">old-version</em></code>; para uma primeira instalação, ele executa <code
                      class="command">new-preinst install</code>. Ele pode adicionar a versão antiga no último parâmetro, se o pacote já foi instalado e removido "since" (mas não "purged", os arquivos de configuração foram "retained").
						</div></li><li
                  class="listitem"><div
                    class="para">
							Os arquivos do novo pacote são então desempacotados, se algum arquivo já existe, ele é substituído, mas uma cópia de backup é temporariamente feita.
						</div></li><li
                  class="listitem"><div
                    class="para">
							Para uma atualização, o <code
                      class="command">dpkg</code> executa <code
                      class="command">old-postrm upgrade <em
                        class="replaceable">new-version</em></code>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">dpkg</code> atualiza todos os dados internos (lista de arquivos, scripts de configuração, etc.) e remove os backups dos arquivos substituídos. Este é o ponto sem volta: o <code
                      class="command">dpkg</code> não tem mais acesso a todos os elementos necessários para retornar ao estado anterior.
						</div></li><li
                  class="listitem"><div
                    class="para">
							O <code
                      class="command">dpkg</code> vai atualizar os arquivos de configuração, pedindo ao usuário para decidir se ele não for capaz de decidir tudo sozinho. Os detalhes deste procedimento são discutidos em <a
                      class="xref"
                      href="sect.package-meta-information.html#sect.conffiles">Seção 5.2.3, “Checksums, Lista de arquivos de configuração”</a>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							Finalmente, o <code
                      class="command">dpkg</code> configura o pacote executando <code
                      class="command">new-postinst configure <em
                        class="replaceable">last-version-configured</em></code>.
						</div></li></ol></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="idm140194934170288"></a>5.2.2.2. Remoção de pacote</h4></div></div></div><div
              class="para">
					Aqui temos o que acontece durante uma remoção de pacote:
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="orderedlist"><ol><li
                  class="listitem"><div
                    class="para">
							o <code
                      class="command">dpkg</code> chama <code
                      class="command">prerm remove</code>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							O <code
                      class="command">dpkg</code> remove todos os arquivos do pacote, exceto os arquivos de configuração e os scripts de configuração.
						</div></li><li
                  class="listitem"><div
                    class="para">
							O <code
                      class="command">dpkg</code> executa <code
                      class="command">postrm remove</code>. Todos os scripts de configuração, exceto <code
                      class="filename">postrm</code>, são removidos. Se o usuário não usou a opção “purge", os processos param aqui.
						</div></li><li
                  class="listitem"><div
                    class="para">
							Para um purge completo do pacote (comando lançado com <code
                      class="command">dpkg --purge</code> ou <code
                      class="command">dpkg -P</code>), os arquivos de configuração são também apagados, assim como uma certa quantidade de cópias (<code
                      class="filename">*.dpkg-tmp</code>, <code
                      class="filename">*.dpkg-old</code>, <code
                      class="filename">*.dpkg-new</code>) e arquivos temporários; então o <code
                      class="command">dpkg</code> executa um <code
                      class="command">postrm purge</code>.
						</div></li></ol></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>VOCABULARY</em></span> Purge, remoção completa</strong></p></div></div></div><a
                id="idm140194934157072"
                class="indexterm"></a><div
                class="para">
					Quando um pacote Debian é removido, os arquivos de configuração são mantidos para facilitar uma possível reinstalação. Do mesmo modo, dados gerados por um serviço (como o conteúdo de um servidor de diretórios LDAP ou o banco de dados de um servidor SQL) são normalmente mantidos.
				</div><div
                class="para">
					Para remover todos os dados associados a um pacote, é necessário fazer “purge” no pacote com o comando, <code
                  class="command">dpkg -P <em
                    class="replaceable">pacote</em></code>, <code
                  class="command">apt-get remove --purge <em
                    class="replaceable">pacote</em></code> ou <code
                  class="command">aptitude purge <em
                    class="replaceable">pacote</em></code>.
				</div><div
                class="para">
					Given the definitive nature of such data removals, a purge should not be taken lightly.
				</div></div><a
              id="idm140194934151648"
              class="indexterm"></a><div
              class="para">
					Os quatro scripts detalhados acima são complementados por um script <code
                class="filename">config</code>, fornecido por pacotes usando <code
                class="command">debconf</code> para adquirir informações do usuário para a configuração. Durante a instalação, este script define em detalhes as perguntas feitas pelo <code
                class="command">debconf</code>. As respostas são gravadas no banco de dados do <code
                class="command">debconf</code> para futura referência. O script é geralmente executado pelo <code
                class="command">apt</code> antes de instalar pacotes, um a um para agrupar todas as perguntas e fazê-las todas ao usuário no começo do processo. Os scripts de pre- e pos-instalação podem então usar esta informação para operar de acordo com o que o usuário espera.
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>FERRAMENTA</em></span> <code
                          class="command">debconf</code></strong></p></div></div></div><a
                id="idm140194934145408"
                class="indexterm"></a><div
                class="para">
					O <code
                  class="command">debconf</code> foi criado para resolver um problema recorrente no Debian. Todos os pacotes Debian que não funcionavam sem um mínimo de configuração costumavam fazer perguntas através de chamadas aos comandos <code
                  class="command">echo</code> e <code
                  class="command">read</code> em scripts shell <code
                  class="filename">postinst</code> (e outros scripts similares). Mas acontecia que durante uma grande instalação ou atualização, o usuário tinha que ficar junto ao computador para responder a várias perguntas que apareciam a qualquer momento. Estas interações manuais agora foram quase que completamente dispensadas, graças à ferramenta <code
                  class="command">debconf</code>.
				</div><div
                class="para">
					O <code
                  class="command">debconf</code> tem muitas funcionalidades interessantes: ele pede que o desenvolvedor especifique a interação com o usuário; Ele permite localização de todas as strings de caracteres mostradas para o usuário (todas as traduções são guardadas no arquivo <code
                  class="filename">templates</code> descrevendo as interações); tem modelos de visualização diferentes para apresentar as perguntas ao usuário (modo texto, modo gráfico, não-interativo); e permite a criação de um banco de dados central de respostas para compartilhar a mesma configuração com vários computadores... mas o mais importante é que agora é possível apresentar todas as perguntas de uma vez para o usuário antes de começar uma longa instalação ou atualização. O usuário pode fazer outras coisas enquanto o sistema cuida da instalação sozinho, sem ter que ficar olhando para um tela a espera da próxima pergunta.
				</div></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.conffiles"></a>5.2.3. Checksums, Lista de arquivos de configuração</h3></div></div></div><a
            id="idm140194934137024"
            class="indexterm"></a><a
            id="idm140194934135904"
            class="indexterm"></a><a
            id="idm140194934134784"
            class="indexterm"></a><a
            id="idm140194934133856"
            class="indexterm"></a><a
            id="idm140194934132448"
            class="indexterm"></a><div
            class="para">
				além dos scripts de mantenedor e dados de controle mencionados nas seções anteriores, o arquivo <code
              class="filename">control.tar.gz</code> de um pacote Debian pode conter outros arquivos interessantes. O primeiro, <code
              class="filename">md5sums</code>, contém as somas de verificação (checksums) de todos os arquivos do pacote. Sua principal vantagem é que permite que uma ferramenta como o <code
              class="command">debsums</code> (que vamos estudar em <a
              class="xref"
              href="sect.supervision.html#sect.debsums">Seção 14.3.3.1, “Auditando Pacotes: <code
                class="command">debsums</code> e seus limites”</a>) verifique se estes arquivos foram modificados desde a instalação deles. Repare que quando este arquivo não existe, o <code
              class="command">dpkg</code> vai gerar ele dinamicamente em tempo de instalação (e armazenar ele num banco de dados do dpkg assim como os outros arquivos de controle).
			</div><div
            class="para">
				<code
              class="filename">conffiles</code> lista arquivos do pacote que devem ser manipulados como arquivos de configuração. Arquivos de configuração podem ser modificados pelo administrador, e o <code
              class="command">dpkg</code> tentará preservar estas mudanças durante uma atualização de pacote.
			</div><div
            class="para">
				Com efeito, nesta situação, o <code
              class="command">dpkg</code> se comporta o mais inteligente possível: se o arquivo de configuração padrão não mudou entre duas versões, ele não faz nada. Se, entretanto, o arquivo mudou, ele vai tentar atualizar o arquivo. Dos casos são possíveis: ou o administrador não tocou neste arquivo de configuração, e neste caso o <code
              class="command">dpkg</code> automaticamente instala a nova versão; ou o arquivo foi modificado, e neste caso o <code
              class="command">dpkg</code> pergunta ao administrador qual versão ele quer usar (a antiga com modificações ou a nova que o pacote fornece). Para auxiliar nesta decisão, o <code
              class="command">dpkg</code> se oferece para mostrar um “<code
              class="command">diff</code>” que mostra a diferença entre as duas versões. Se o usuário escolhe manter a versão antiga, a nova vai ser armazenada na mesma localização em um arquivo com o sufixo <code
              class="filename">.dpkg-dist</code>. Se o usuário escolhe a nova versão, a antiga é mentida num arquivo com o sufixo <code
              class="filename">.dpkg-old</code>. Outra ação disponível consiste em interromper momentaneamente o <code
              class="command">dpkg</code> para editar o arquivo e tentar reinstalar as modificações relevantes (previamente identificadas com o <code
              class="command">diff</code>).
			</div><div
            class="sidebar"><a
              id="sidebar.questions-conffiles"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>INDO ALÉM</em></span> Evitando as perguntas do arquivo de configuração</strong></p></div></div></div><div
              class="para">
				O <code
                class="command">dpkg</code> cuida de atualizações de arquivos de configuração, mas enquanto faz isto, regularmente interrompe seu trabalho para pedir uma entrada do administrador. Isto não é agradável para aqueles que desejam executar atualizações de uma forma não-iterativa. É por isto que este programa oferece opções para o sistema responder automaticamente de acordo com a mesma lógica: <code
                class="command">--force-confold</code> retém a versão antiga do arquivo; <code
                class="command">--force-confnew</code> vai usar a nova versão do arquivo (estas escolhas são respeitadas, mesmo se o arquivo não tiver sido mudado pelo administrador, o que apenas raramente tem o efeito desejado). Adicionando a opção <code
                class="command">--force-confdef</code> diz ao <code
                class="command">dpkg</code> para decidir por si só quando uma escolha é apresentada (em outras palavras, quando o arquivo de configuração original não foi alterado), e apenas usa <code
                class="command">--force-confnew</code> ou <code
                class="command">--force-confold</code> para outros casos.
			</div><div
              class="para">
				Estas opções se aplicam ao <code
                class="command">dpkg</code>, mas na maioria das vezes o administrador vai trabalhar diretamente com os programas <code
                class="command">aptitude</code> ou <code
                class="command">apt-get</code>. É, então, necessário saber a sintaxe usada para indicar as opções passadas ao comando <code
                class="command">dpkg</code> (suas interfaces em linha de comando são muito similares).
			</div><pre
              class="screen">
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>apt-get -o DPkg::options::="--force-confdef" -o DPkg::options::="--force-confold" dist-upgrade</code></strong></pre><div
              class="para">
				Estas opções podem ser armazenadas diretamente na configuração do <code
                class="command">apt</code>. Para isto, simplesmente escreva a linha seguinte no arquivo <code
                class="filename">/etc/apt/apt.conf.d/local</code>:
			</div><div
              class="informalexample"><pre
                class="programlisting">
DPkg::options { "--force-confdef"; "--force-confold"; }
</pre></div><div
              class="para">
				Ao incluir esta opção no arquivo de configuração faz com que ela possa ser usada também numa interface gráfica, como o <code
                class="command">aptitude</code>.
			</div></div><div
            class="sidebar"><a
              id="sidebar.questions-conffiles-bis"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>INDO ALÉM</em></span> Forçar o dpkg a perguntar sobre arquivos de configuração</strong></p></div></div></div><div
              class="para">
				A opção <code
                class="command">--force-confask</code> pede ao <code
                class="command">dpkg</code> para mostrar as perguntas sobre os arquivos de configuração, mesmo nos casos onde eles normalmente não são necessários. Portanto, quando estiver resinstalando um pacote com esta opção, o <code
                class="command">dpkg</code> vai refazer as perguntas para todos os arquivos de configuração modificados pelo administrador. Isto é bastante conveniente, especialmente para reinstalar o arquivo de configuração original se este foi apagado e nenhuma outra cópia estiver disponível: uma re-instalação normal não vai funcionar, já que o <code
                class="command">dpkg</code> considera a remoção uma forma de modificação legítima, e, portanto, não instala o arquivo de configuração desejado.
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="packaging-system.html"><strong>Anterior</strong>Capítulo 5. Sistema de Pacotes: Ferramentas e Pri...</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Acima</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Principal</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.source-package-structure.html"><strong>Próxima</strong>5.3. Estrutura de um Pacote Fonte</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.package-meta-information.html">ar-MA</a></li><li><a
              href="../da-DK/sect.package-meta-information.html">da-DK</a></li><li><a
              href="../de-DE/sect.package-meta-information.html">de-DE</a></li><li><a
              href="../el-GR/sect.package-meta-information.html">el-GR</a></li><li><a
              href="../en-US/sect.package-meta-information.html">en-US</a></li><li><a
              href="../es-ES/sect.package-meta-information.html">es-ES</a></li><li><a
              href="../fa-IR/sect.package-meta-information.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.package-meta-information.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.package-meta-information.html">hr-HR</a></li><li><a
              href="../id-ID/sect.package-meta-information.html">id-ID</a></li><li><a
              href="../it-IT/sect.package-meta-information.html">it-IT</a></li><li><a
              href="../ja-JP/sect.package-meta-information.html">ja-JP</a></li><li><a
              href="../pl-PL/sect.package-meta-information.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.package-meta-information.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.package-meta-information.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.package-meta-information.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.package-meta-information.html">tr-TR</a></li><li><a
              href="../zh-CN/sect.package-meta-information.html">zh-CN</a></li></ul></div></body></html>
