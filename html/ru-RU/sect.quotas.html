<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">9.9. Квоты</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-ru-RU-1.0-1" /><meta
        name="keywords"
        content="Загрузка системы, Сценарии инициализации, SSH, Telnet, Права, Привилегии, Инспектирование, Inetd, Cron, Резервное копирование, Горячее подключение, PCMCIA, APM, ACPI" /><link
        rel="home"
        href="index.html"
        title="Настольная книга администратора Debian" /><link
        rel="up"
        href="unix-services.html"
        title="Глава 9. Сервисы Unix" /><link
        rel="prev"
        href="sect.asynchronous-task-scheduling-anacron.html"
        title="9.8. Планирование асинхронных задач: anacron" /><link
        rel="next"
        href="sect.backup.html"
        title="9.10. Резервное копирование" /><meta
        name="viewport"
        content="width=device-width, initial-scale=1" /><meta
        name="flattr:id"
        content="4pz9jq" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/ru-RU/sect.quotas.html" /></head><body><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="../../"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.asynchronous-task-scheduling-anacron.html"><strong>Пред.</strong></a></li><li
          class="home">Настольная книга администратора Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.backup.html"><strong>След.</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.quotas"></a>9.9. Квоты</h2></div></div></div><a
          id="id-1.12.12.2"
          class="indexterm"></a><div
          class="para">
			Система квот позволяет ограничить размер дискового пространства, выделенного пользователю или группе пользователей. При желании использовать её, вы должны вначале убедиться, что имеете ядро с поддержкой квот (то есть ядро должно быть скомпилировано с опцией <code
            class="varname">CONFIG_QUOTA</code>) — как это реализовано в ядрах, собранных для дистибутивов Debian. Программное обеспечение для управления квотами находится в Debian пакете <span
            class="pkg pkg">quota</span>.
		</div><div
          class="para">
			Для активирования квоты в файловой системе, вам надо в явной форме указать опции <code
            class="literal">usrquota</code> и <code
            class="literal">grpquota</code> в файле <code
            class="filename">/etc/fstab</code>, применив их к тем пользователям и группам, которым вы хотите установить квоты, соответственно. Во время перезагрузки компьютера, при отсутствии активности жёсткого диска, будет выполнено обновление квот (это необходимое условия для правильного учёта уже использованного дискового пространства).
		</div><div
          class="para">
			команда <code
            class="command">edquota <em
              class="replaceable">пользователь</em></code> (или <code
            class="command">edquota -g <em
              class="replaceable">группа</em></code>) позволяет изменить лимиты, проверив текущее использование дискового пространства.
		</div><a
          id="id-1.12.12.6"
          class="indexterm"></a><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>УГЛУБЛЯЕМСЯ</em></span> Определение квот с помощью сценария</strong></p></div></div></div><a
            id="id-1.12.12.7.2"
            class="indexterm"></a><div
            class="para">
			Программа <code
              class="command">setquota</code> может использоваться в сценарии для автоматического изменения множества квот. На её странице руководства <span
              class="citerefentry"><span
                class="refentrytitle">setquota</span>(8)</span> подробно описан используемый синтаксис.
		</div></div><div
          class="para">
			Система квот позволяет задать четыре лимита:
		</div><div
          xmlns:d="http://docbook.org/ns/docbook"
          class="itemizedlist"><ul><li
              class="listitem"><div
                class="para">
					два лимита (называемые «мягким» и «жёстким») соответствуют числу используемых блоков. Если файловая система создана с размером блока 1 кибибайт, блок содержит фрагмент файла длиной 1024 байта. Незаполненные блоки поэтому приводят к потере дискового пространства. Квота в 100 блоков, теоретически позволяющая хранить 102.400 байтов, будет исчерпана всего 100 файлами размером по 500 байтов каждый, что составляет в сумме всего 50.000 байтов.
				</div></li><li
              class="listitem"><div
                class="para">
					два лимита (мягкий и жёсткий) соответствуют числу использованных записей inode. Каждый файл занимает как минимум один inode для хранения информации о себе (разрешения, владелец, временная метка последнего доступа и т. д.). Поэтому фактически это лимит на число файлов пользователя.
				</div></li></ul></div><div
          class="para">
			«Мягкий» лимит может быть временно превышен; пользователь просто получит предупреждение о превышении квоты от команды <code
            class="command">warnquota</code>, обычно вызываемой <code
            class="command">cron</code>. «Жёсткий» лимит никогда не может быть превышен: система отклонит любую операцию, приводящую к превышению жёсткой квоты.
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>СЛОВАРЬ</em></span> Блоки и inode</strong></p></div></div></div><a
            id="id-1.12.12.11.2"
            class="indexterm"></a><a
            id="id-1.12.12.11.3"
            class="indexterm"></a><div
            class="para">
			Файловая система делит диск на блоки — маленькие неразрывные области. Размер этих областей определяется при создании файловой системы и обычно имеет значение от 1 до 8 кибибайт.
		</div><div
            class="para">
			Блок может использоваться или для хранения данных файла, или для хранения метаданных, используемых файловой системой. Среди этих метаданных особо выделяются inode. Inode занимает блок на жёстком диске (но этот блок не учитывается квотой на блоки, только квотой на inode) и содержит информацию о соответствующем файле (имя, владелец, разрешения и т. д.) и указатели на занятые блоки данных. Для очень больших файлов, занимающих слишком большое число блоков, чтобы на них можно было сослаться из одного inode, существует непрямая система блоков; inode ссылается на список блоков, которые содержат не сами данные, а другой список блоков.
		</div></div><a
          id="id-1.12.12.12"
          class="indexterm"></a><div
          class="para">
			С помощью команды <code
            class="command">edquota -t</code> можно определить максимально дозволенный «кредитный период», в течение которого может быть превышен мягкий лимит. По истечении этого периода мягкий лимит будет обрабатываться как жёсткий, и пользователю нужно будет уменьшить использование дискового пространства в соответствии с этим лимитом, чтобы получить возможность записи чего бы то ни было на жёсткий диск.
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>УГЛУБЛЯЕМСЯ</em></span> Установка квоты по умолчанию для новых пользователей</strong></p></div></div></div><div
            class="para">
			Чтобы автоматически устанавливать квоту для новых пользователей, нужно настроить шаблонного пользователя (с помощью <code
              class="command">edquota</code> или <code
              class="command">setquota</code>) и указать его имя пользователя в переменной <code
              class="varname">QUOTAUSER</code> в файле <code
              class="filename">/etc/adduser.conf</code>. Эта настройка квоты будет автоматически применяться ко всем новым пользователям, созданным с помощью команды <code
              class="command">adduser</code>.
		</div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.asynchronous-task-scheduling-anacron.html"><strong>Пред.</strong>9.8. Планирование асинхронных задач: anacron</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Наверх</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Начало</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.backup.html"><strong>След.</strong>9.10. Резервное копирование</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.quotas.html">ar-MA</a></li><li><a
              href="../da-DK/sect.quotas.html">da-DK</a></li><li><a
              href="../de-DE/sect.quotas.html">de-DE</a></li><li><a
              href="../el-GR/sect.quotas.html">el-GR</a></li><li><a
              href="../en-US/sect.quotas.html">en-US</a></li><li><a
              href="../es-ES/sect.quotas.html">es-ES</a></li><li><a
              href="../fa-IR/sect.quotas.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.quotas.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.quotas.html">hr-HR</a></li><li><a
              href="../id-ID/sect.quotas.html">id-ID</a></li><li><a
              href="../it-IT/sect.quotas.html">it-IT</a></li><li><a
              href="../ja-JP/sect.quotas.html">ja-JP</a></li><li><a
              href="../ko-KR/sect.quotas.html">ko-KR</a></li><li><a
              href="../nb-NO/sect.quotas.html">nb-NO</a></li><li><a
              href="../pl-PL/sect.quotas.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.quotas.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.quotas.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.quotas.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.quotas.html">tr-TR</a></li><li><a
              href="../vi-VN/sect.quotas.html">vi-VN</a></li><li><a
              href="../zh-CN/sect.quotas.html">zh-CN</a></li><li><a
              href="../zh-TW/sect.quotas.html">zh-TW</a></li></ul></div></body></html>
