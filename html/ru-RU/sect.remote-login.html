<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">9.2. Удалённый вход</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-ru-RU-1.0-1" /><meta
        name="keywords"
        content="Загрузка системы, Сценарии инициализации, SSH, Telnet, Права, Привилегии, Инспектирование, Inetd, Cron, Резервное копирование, Горячее подключение, PCMCIA, APM, ACPI" /><link
        rel="home"
        href="index.html"
        title="Настольная книга администратора Debian" /><link
        rel="up"
        href="unix-services.html"
        title="Глава 9. Сервисы Unix" /><link
        rel="prev"
        href="unix-services.html"
        title="Глава 9. Сервисы Unix" /><link
        rel="next"
        href="sect.rights-management.html"
        title="9.3. Управление правами" /><meta
        name="viewport"
        content="width=device-width, initial-scale=1" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/ru-RU/sect.remote-login.html" /></head><body><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="../../"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="unix-services.html"><strong>Пред.</strong></a></li><li
          class="home">Настольная книга администратора Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.rights-management.html"><strong>След.</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.remote-login"></a>9.2. Удалённый вход</h2></div></div></div><div
          class="para">
			Для администратора крайне важно иметь возможность подключиться к компьютеру удалённо. Серверы, заключённые в своей собственной комнате, редко оснащаются постоянными клавиатурами и мониторами — но они подключены к сети.
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>К ОСНОВАМ</em></span> Клиент, сервер</strong></p></div></div></div><a
            id="id-1.12.5.3.2"
            class="indexterm"></a><a
            id="id-1.12.5.3.3"
            class="indexterm"></a><div
            class="para">
			Система, в которой несколько процессов взаимодействуют друг с другом, часто описывается с помощью терминов «клиент» и «сервер». Сервер — это программа, принимающая запрос от клиента и выполняющая его. Все действия контролируются клиентом, сервер сам по себе не проявляет никакой инициативы.
		</div></div><a
          id="id-1.12.5.4"
          class="indexterm"></a><a
          id="id-1.12.5.5"
          class="indexterm"></a><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.ssh"></a>9.2.1. Защищённый удалённый вход: SSH</h3></div></div></div><a
            id="id-1.12.5.6.2"
            class="indexterm"></a><a
            id="id-1.12.5.6.3"
            class="indexterm"></a><div
            class="para">
				Протокол <span
              class="emphasis"><em>SSH</em></span> (<span
              class="foreignphrase"><em
                class="foreignphrase">Secure SHell</em></span> — защищённая командная оболочка) был разработан из соображений безопасности и надёжности. Соединения, использующие SSH, защищены: другая сторона аутентифицируется, а весь обмен данными зашифрован.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>КУЛЬТУРА</em></span> Telnet и RSH устарели</strong></p></div></div></div><a
              id="id-1.12.5.6.5.2"
              class="indexterm"></a><a
              id="id-1.12.5.6.5.3"
              class="indexterm"></a><div
              class="para">
				До SSH основными средствами удалённого доступа были <span
                class="emphasis"><em>Telnet</em></span> и <span
                class="emphasis"><em>RSH</em></span>. Сейчас они сильно устарели, и их не следует использовать, хотя они всё ещё есть в Debian.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>СЛОВАРЬ</em></span> Аутентификация, шифрование</strong></p></div></div></div><div
              class="para">
				Безопасность важна, когда необходимо дать клиенту возможность управления или выполнения действий на сервере. Необходимо надёжно идентифицировать клиента; это называется аутентификацией. Для идентификации обычно используется пароль, который должен храниться в секрете, иначе другой клиент мог бы воспользоваться им. Для этого служит шифрование — форма кодирования, позволяющая двум системам обмениваться конфиденциальной информацией по публичному каналу, защищая её от чтения другими.
			</div><div
              class="para">
				Аутентификация и шифрование часто упоминаются вместе, потому что они часто используются совместно, и потому что они обычно основываются на сходных математических принципах.
			</div></div><div
            class="para">
				В состав SSH также входят две транспортных службы. <code
              class="command">scp</code> — это инструмент командной строки, который можно использовать наподобие <code
              class="command">cp</code> с той разницей, что любой путь к другой машине начинается с указания её имени, за которым следует двоеточие.
			</div><pre
            class="screen"><code
              class="computeroutput">$ </code><strong
              class="userinput"><code>scp file machine:/tmp/</code></strong></pre><div
            class="para">
				<code
              class="command">sftp</code> — это интерактивная команда, похожая на <code
              class="command">ftp</code>. В рамках одной сессии <code
              class="command">sftp</code> может передать несколько файлов, а также с её помощью можно манипулировать удалёнными файлами (удалять, переименовывать, менять права доступа и т. д.).
			</div><a
            id="id-1.12.5.6.10"
            class="indexterm"></a><a
            id="id-1.12.5.6.11"
            class="indexterm"></a><div
            class="para">
				В Debian используется OpenSSH — свободная реализация SSH, развиваемая в рамках проекта <code
              class="command">OpenBSD</code> (свободной операционной системы, основанной на ядре BSD и делающей акцент на безопасности), и являющаяся ответвлением оригинальной программы SSH, разработанной финской компанией SSH Communications Security Corp. Эта компания изначально разрабатывала SSH как свободное ПО, но впоследствии решила продолжить разработку под собственнической лицензией. Тогда проект OpenBSD создал OpenSSH, чтобы развивать свободную версию SSH.
			</div><a
            id="id-1.12.5.6.13"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>К ОСНОВАМ</em></span> Ответвление (<span
                        class="foreignphrase"><em
                          class="foreignphrase">fork</em></span>)</strong></p></div></div></div><a
              id="id-1.12.5.6.14.2"
              class="indexterm"></a><div
              class="para">
				В области программного обеспечения «ответвление» или «форк» означает новый проект, начатый как клон существующего проекта и конкурирующий с ним. В дальнейшем оба программных продукта как правило быстро расходятся в плане новых доработок. Форк часто является результатом конфликтов внутри команды разработчиков.
			</div><div
              class="para">
				Возможность создать ответвление прямо следует из самой природы свободного ПО; форк — это здоровое явление, если оно позволяет продолжить развитие проекта как свободного ПО (например в случае изменения лицензии). Форк, возникающий из-за технических или личных разногласий зачастую является транжирством человеческого ресурса; другое решение было бы более предпочтительным. Случаются и слияния двух проектов, ранее разошедшихся вследствие форка.
			</div></div><div
            class="para">
				OpenSSH разделён на два пакета: клиент <span
              class="pkg pkg">openssh-client</span> и сервер <span
              class="pkg pkg">openssh-server</span>. Мета-пакет <span
              class="pkg pkg">ssh</span> устанавливает оба (<code
              class="command">apt install ssh</code>).
			</div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="sect.ssh-key-based-auth"></a>9.2.1.1. Аутентификация по ключу</h4></div></div></div><div
              class="para">
					При каждом входе по SSH удалённый сервер запрашивает пароль, чтобы аутентифицировать пользователя. Это может создать проблему, если хочется автоматизировать соединение, или если используется некий инструмент, которому нужно часто устанавливать соединения через SSH. По этой причине в SSH предусмотрен механизм аутентификации по ключу.
				</div><div
              class="para">
					Пользователь создаёт на клиентской машине пару ключей с помощью <code
                class="command">ssh-keygen -t rsa</code>; публичный ключ сохраняется в <code
                class="filename">~/.ssh/id_rsa.pub</code>, а соответствующий ему секретный ключ — в <code
                class="filename">~/.ssh/id_rsa</code>. Затем пользователь с помощью команды <code
                class="command">ssh-copy-id <em
                  class="replaceable">сервер</em></code> добавляет публичный ключ в файл <code
                class="filename">~/.ssh/authorized_keys</code> на сервере. Если секретный ключ не был при создании защищён «парольной фразой», все последующие входы на сервер будут работать без пароля. В противном случае потребуется расшифровывать секретный ключ каждый раз, вводя парольную фразу. К счастью, <code
                class="command">ssh-agent</code> позволяет хранить секретные ключи в памяти, чтобы не приходилось то и дело вводить пароль. Для этого ипользуется <code
                class="command">ssh-add</code> (однократно за рабочую сессию) при условии, что сессия уже ассощиирована с работающим экземпляром <code
                class="command">ssh-agent</code>. Debian активирует его по умолчанию в графических сессиях, но это можно отключить, изменив <code
                class="filename">/etc/X11/Xsession.options</code>. Для консольной сессии можно запустить его вручную с помощью <code
                class="command">eval $(ssh-agent)</code>.
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>БЕЗОПАСНОСТЬ</em></span> Защита секретного ключа</strong></p></div></div></div><div
                class="para">
					Кто угодно, имеющий секретный ключ, может войти в настроенную таким образом учётную запись. Поэтому доступ к секретному ключу защищается «парольной фразой». Некто, получивший копию секретного ключа (например <code
                  class="filename">~/.ssh/id_rsa</code>) всё равно должен знать эту фразу, чтобы иметь возможность воспользоваться им. Эта дополнительная защита не является, однако, неприступной, и если есть основания полагать, что данный файл был скомпроментирован, лучше отключить этот ключ на компьютерах, на которые он был установлен, (путём удаления его из файлов <code
                  class="filename">authorized_keys</code>) и заменить его вновь созданным ключом.
				</div></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>КУЛЬТУРА</em></span> Уязвимость OpenSSL в Debian <span
                          class="distribution distribution">Etch</span></strong></p></div></div></div><div
                class="para">
					У библиотеки OpenSSL в том виде, в каком она поставлялась в Debian <span
                  class="distribution distribution">Etch</span>, была серьёзная проблема с генератором случайных чисел (ГСЧ). На самом деле сопровождающий Debian внёс изменение, чтобы приложения, используемые библиотекой, перестали выводить предупреждения при анализе их инструментами тестирования памяти вроде <code
                  class="command">valgrind</code>. К сожалению, это изменение также привело к тому, что ГСЧ стал использовать только один источник энтропии, соответствующий идентификатору процесса (PID), 32.000 возможных значений которого не обеспечивают должного уровня случайности. <div
                  class="url">→ <a
                    href="http://www.debian.org/security/2008/dsa-1571">http://www.debian.org/security/2008/dsa-1571</a></div>
				</div><div
                class="para">
					В частности, когда OpenSSL использовалась для генерации ключа, она всегда создавала ключ из известного набора нескольких сотен тысяч ключей (32.000, помноженные на небольшое число длин ключей). Это затронуло ключи SSH и SSL, а также сертификаты X.509, используемые многочисленными приложениями, такими как OpenVPN. Взломщику оставалось только перепробовать все ключи, чтобы получить неавторизованный доступ. Чтобы уменьшить последствия этой проблемы, демон SSH был модифицирован таким образом, чтобы отклонять проблемные ключи, перечисленные в пакетах <span
                  class="pkg pkg">openssh-blacklist</span> и <span
                  class="pkg pkg">openssh-blacklist-extra</span>. Кроме того, команда <code
                  class="command">ssh-vulnkey</code> позволяет обнаружить возможно скомпроментированные ключи в системе.
				</div><div
                class="para">
					Более детальный анализ выявил, что это результат нескольких (небольших) проблем и в проекте OpenSSL и у сопровождающего пакет Debian. Такие широко используемые библиотеки как OpenSSL должны без изменений проходить тест <code
                  class="command">valgrind</code> без предупреждений. Более того, код (особенно чувствительные части, как RNG) должен быть лучше сопровождён комментариями для предотвращения таких ошибок. Сопровождающий пакета Debian хотел согласовать изменения вместе с разработчиками OpenSSL, но просто объяснил их, не предоставив соответствующий патч для проверки и не уведомил о своей роли в Debian. Наконец, его выбор не был оптимальным: изменения в исходном коде не были отчётливо сопровождены комментариями. Они были сохранены в репозитории Subversion, затем свалены в один патч во время создания пакета с исходным кодом.
				</div><div
                class="para">
					При таких условиях трудно найти средства для предотвращения подобных инцидентов в будущем. Урок, который можно вынести из этого — каждое изменение, внесённое Debian в апстрим программное обеспечение, должно быть подтверждено, документировано, внесено в проект и широко оглашено. В соответствии с этим разработан новый формат для исходников («3.0 (quilt)») и веб-сервис. <div
                  class="url">→ <a
                    href="http://sources.debian.net">http://sources.debian.net</a></div>
				</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="sect.ssh-x11"></a>9.2.1.2. Использование удалённых приложений X11</h4></div></div></div><div
              class="para">
					Протокол SSH позволяет пересылать графические данные (сессию «X11», по названию наиболее широко распространённой в Unix графической системы); в таком случае сервер сохраняет выделенный канал для этих данных. Так, графическая программа, запущенная удалённо, может быть отображена сервером X.org на локальном экране, и вся сессия (ввод и отображение) будет защищена. Поскольку эта возможность позволяет удалённым приложениям перекрываться с локальной системой, она отключена по умолчанию. Её можно включить, указав <code
                class="literal">X11Forwarding yes</code> в конфигурационном файле сервера (<code
                class="filename">/etc/ssh/sshd_config</code>). Пользователь также должен явно запросить её, добавив опцию <code
                class="literal">-X</code> к командной строке <code
                class="command">ssh</code>.
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="sect.ssh-port-forwarding"></a>9.2.1.3. Создание шифрованных туннелей</h4></div></div></div><a
              id="id-1.12.5.6.18.2"
              class="indexterm"></a><div
              class="para">
					Опции <code
                class="literal">-R</code> и <code
                class="literal">-L</code> указывают <code
                class="command">ssh</code>, что нужно создать «шифрованный туннель» между двумя машинами, безопасно перенаправив локальный порт TCP (см. врезку <a
                class="xref"
                href="network-infrastructure.html#sidebar.tcp-udp"><span
                  class="emphasis"><em>К ОСНОВАМ</em></span> TCP/UDP</a>) на удалённую машину или наоборот.
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>СЛОВАРЬ</em></span> Туннель</strong></p></div></div></div><a
                id="id-1.12.5.6.18.4.2"
                class="indexterm"></a><a
                id="id-1.12.5.6.18.4.3"
                class="indexterm"></a><div
                class="para">
					Интернет, как и большинство подключённых к нему локальных сетей, работает в пакетном режиме, а не в подключённом. Это означает, что пакет, отправленный одним компьютером другому, будет останавливаться на нескольких промежуточных маршрутизаторах для выяснения пути к его месту назначения. Но всё же можно симулировать подключённую работу, энкапсулируя поток в обычные пакеты IP. Эти пакеты следуют своим обычным путём, а поток восстанавливается в неизменном виде в месте назначения. Это называется «туннелем» по аналогии с дорожным туннелем, по которому автомобили следуют напрямую от въезда (ввод) к выезду (вывод) без каких бы то ни было перекрёстков, в противоположность движению по поверхности, где встречались бы перекрёстки и менялось направление движения.
				</div><div
                class="para">
					Эту возможность можно использовать, чтобы добавить шифрование в туннель: поток, идущий через него, не распознаваем извне, но возвращается к расшифрованному виду на выходе из туннеля.
				</div></div><div
              class="para">
					<code
                class="command">ssh -L 8000:server:25 intermediary</code> устанавливает сессию SSH с узлом <em
                class="replaceable">intermediary</em> и слушает локальный порт 8000 (см. <a
                class="xref"
                href="sect.remote-login.html#figure.ssh-L">Рисунок 9.3, «Перенаправление локального порта с помощью SSH»</a>). Для любого соединения, установленного на этом порту, <code
                class="command">ssh</code> инициирует соединение с машины<em
                class="replaceable">intermediary</em> на порт 25 машины <em
                class="replaceable">server</em> и свяжет оба соединения друг с другом.
				</div><div
              class="para">
					<code
                class="command">ssh -R 8000:server:25 intermediary</code> также устанавливают сессию SSH с компьютером <em
                class="replaceable">intermediary</em>, но слушает порт 8000 уже на этой машине (см. <a
                class="xref"
                href="sect.remote-login.html#figure.ssh-R">Рисунок 9.4, «Перенаправление удалённого порта с помощью SSH»</a>). Любое соединение с этим портом заставит <code
                class="command">ssh</code> открыть соединение с локальной машины на порт 25 машины <em
                class="replaceable">server</em> и связать между собой два соединения.
				</div><div
              class="para">
					В обоих случаях соединения устанавливаются с портом 25 узла <em
                class="replaceable">server</em>, проходя через туннель SSH между локальной машиной и машиной <em
                class="replaceable">intermediary</em>. В первом случае входом в туннель является локальный порт 8000, и данные идут на машину <em
                class="replaceable">intermediary</em> перед тем, как направиться на <em
                class="replaceable">server</em> в «публичной» сети. Во втором случае вход и выход из туннеля меняются местами; входом является порт 8000 на машине <em
                class="replaceable">intermediary</em>, а выход расположен на локальном узле, и данные затем направляются на <em
                class="replaceable">server</em>. На практике сервером обычно является либо локальная машина, либо промежуточная. В таком случае SSH защищает соединение от одного конца до другого.
				</div><div
              class="figure"><a
                id="figure.ssh-L"></a><div
                class="figure-contents"><div
                  class="mediaobject"><img
                    src="images/ssh-L.png"
                    alt="Перенаправление локального порта с помощью SSH" /></div></div><p
                class="title"><strong>Рисунок 9.3. Перенаправление локального порта с помощью SSH</strong></p></div><div
              class="figure"><a
                id="figure.ssh-R"></a><div
                class="figure-contents"><div
                  class="mediaobject"><img
                    src="images/ssh-R.png"
                    alt="Перенаправление удалённого порта с помощью SSH" /></div></div><p
                class="title"><strong>Рисунок 9.4. Перенаправление удалённого порта с помощью SSH</strong></p></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.remote-desktops"></a>9.2.2. Использование удалённых графических рабочих столов</h3></div></div></div><div
            class="para">
				VNC (<span
              class="foreignphrase"><em
                class="foreignphrase">Virtual Network Computing</em></span>) позволяет удалённо подключаться к графическим рабочим столам.
			</div><a
            id="id-1.12.5.7.3"
            class="indexterm"></a><a
            id="id-1.12.5.7.4"
            class="indexterm"></a><a
            id="id-1.12.5.7.5"
            class="indexterm"></a><a
            id="id-1.12.5.7.6"
            class="indexterm"></a><a
            id="id-1.12.5.7.7"
            class="indexterm"></a><div
            class="para">
				Этот инструмент используется в основном для технической помощи; администратор может видеть ошибки, с которыми сталкивается пользователь, и показывать ему правильный путь их решения без необходимости стоять у него за спиной.
			</div><a
            id="id-1.12.5.7.9"
            class="indexterm"></a><a
            id="id-1.12.5.7.10"
            class="indexterm"></a><a
            id="id-1.12.5.7.11"
            class="indexterm"></a><div
            class="para">
				Для начала, пользователь должен разрешить доступ к сессии. Графическая среда GNOME в <span
              class="distribution distribution">Jessie</span> включает эту возможность (на конфигурационной панели, хотя в предыдущих выпусках Debian пользователь должен был устанавливать и запускать <code
              class="command">vino</code>). В KDE нужно использовать <code
              class="command">krfb</code> для предоставления доступа к существующей сессии через VNC. Для остальных сред следует использовать команду (пакет имеет аналогичное название) <code
              class="command">x11vnc</code>; для пользователя, вы можете создать значок для запуска.
			</div><a
            id="id-1.12.5.7.13"
            class="indexterm"></a><a
            id="id-1.12.5.7.14"
            class="indexterm"></a><a
            id="id-1.12.5.7.15"
            class="indexterm"></a><a
            id="id-1.12.5.7.16"
            class="indexterm"></a><div
            class="para">
				Когда всё готово для VNC, администратор должен использовать VNC-клиент для соединения. GNOME использует <code
              class="command">vinagre</code> и <code
              class="command">remmina</code>, KDE использует <code
              class="command">krdc</code> (в меню <span
              class="guimenu"><strong>K</strong></span> → <span
              class="guisubmenu"><strong>Интернет</strong></span> → <span
              class="guimenuitem"><strong>Клиент удалённого рабочего стола</strong></span>). Существуют другие VNC-клиенты, использующие консоль, например <code
              class="command">xvnc4viewer</code> — пакет Debian имеет такое же название. После подключения, администратор может видеть что происходит, работать на машине удалённо и показать пользователю как действовать.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>БЕЗОПАСНОСТЬ</em></span> VNC через SSH</strong></p></div></div></div><a
              id="id-1.12.5.7.18.2"
              class="indexterm"></a><div
              class="para">
				Если хочется подключиться по VNC, но так, чтобы данные не передавались по сети в открытом виде, можно энкапсулировать их в SSH-туннель (см. <a
                class="xref"
                href="sect.remote-login.html#sect.ssh-port-forwarding">Раздел 9.2.1.3, «Создание шифрованных туннелей»</a>). Для этого нужно только знать, что по умолчанию VNC использует порт 5900 для первого экрана (называемого «localhost:0»), 5901 — для второго (называемого «localhost:1») и т. д.
			</div><div
              class="para">
				Команда <code
                class="command">ssh -L localhost:5901:localhost:5900 -N -T <em
                  class="replaceable">machine</em></code> создаёт туннель между портом 5901 локального интерфейса и портом 5900 узла <em
                class="replaceable">machine</em>. Первое слово «localhost» указывает SSH, что надо слушать только этот интерфейс на локальной машине. Второе вхождение «localhost» указывает интерфейс на удалённой машине, который будет получать трафик, входящий в «localhost:5901». В таком случае команда <code
                class="command">vncviewer localhost:1</code> установит подключение клиента VNC к удалённому экрану, хотя ей и указано имя локальной машины.
			</div><div
              class="para">
				После закрытия сессии VNC не забудьте также закрыть туннель путём выхода из соответствующей сессии SSH.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>К ОСНОВАМ</em></span> Менеджер дисплея</strong></p></div></div></div><a
              id="id-1.12.5.7.19.2"
              class="indexterm"></a><a
              id="id-1.12.5.7.19.3"
              class="indexterm"></a><a
              id="id-1.12.5.7.19.4"
              class="indexterm"></a><a
              id="id-1.12.5.7.19.5"
              class="indexterm"></a><a
              id="id-1.12.5.7.19.6"
              class="indexterm"></a><a
              id="id-1.12.5.7.19.7"
              class="indexterm"></a><div
              class="para">
				<code
                class="command">gdm3</code>, <code
                class="command">kdm</code>, <code
                class="command">lightdm</code>, и <code
                class="command">xdm</code> — менеджеры рабочего стола. Они используются для регистрации пользователей, запускаются после загрузки системы и используют графический интерфейс. После регистрации пользователя, они запускают программы, необходимые для запуска рабочей графической сессии.
			</div></div><div
            class="para">
				VNC также подходит для мобильных пользователей или для руководителей компании, которым время от времени требуется получать доступ к удалённому рабочему столу из своего дома, как если бы они были на работе. Настройка такого сервиса сложнее: сперва нужно установить пакет <span
              class="pkg pkg">vnc4server</span>, изменить настройки менеджера дисплея, чтобы он принимал запросы <code
              class="literal">XDMCP Query</code> (для <code
              class="command">gdm3</code> это делается путём добавления строки <code
              class="literal">Enable=true</code> в раздел «xdmcp» файла <code
              class="filename">/etc/gdm3/daemon.conf</code>) и, наконец, запустить сервер VNC с помощью <code
              class="command">inetd</code>, чтобы сессия автоматически запускалась при попытке пользователя войти в систему. Например, можно добавить следующую строчку в <code
              class="filename">/etc/inetd.conf</code>:
			</div><pre
            class="programlisting">5950  stream  tcp  nowait  nobody.tty  /usr/bin/Xvnc Xvnc -inetd -query localhost -once -geometry 1024x768 -depth 16 securitytypes=none</pre><div
            class="para">
				Перенаправление входящих соединений к менеджеру рабочего стола решает проблему идентификации, т. к. только пользователи с локальными учётными записями могут быть зарегистрированы через <code
              class="command">gdm3</code> (или эквиваленты <code
              class="command">kdm</code>, <code
              class="command">xdm</code>, и прочие). Так как возможны одновременные многочисленные регистрации (сервер должен быть достаточно мощным для этого), удалённые пользователи (или менее мощные системы, сконфигурированные как тонкие клиенты) могут использовать машину как полноценную систему. Пользователи должны регистрироваться с <code
              class="command">vncviewer <em
                class="replaceable">server</em>:50</code>, т. к. используется порт 5950.
			</div><a
            id="id-1.12.5.7.23"
            class="indexterm"></a></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="unix-services.html"><strong>Пред.</strong>Глава 9. Сервисы Unix</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Наверх</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Начало</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.rights-management.html"><strong>След.</strong>9.3. Управление правами</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.remote-login.html">ar-MA</a></li><li><a
              href="../da-DK/sect.remote-login.html">da-DK</a></li><li><a
              href="../de-DE/sect.remote-login.html">de-DE</a></li><li><a
              href="../el-GR/sect.remote-login.html">el-GR</a></li><li><a
              href="../en-US/sect.remote-login.html">en-US</a></li><li><a
              href="../es-ES/sect.remote-login.html">es-ES</a></li><li><a
              href="../fa-IR/sect.remote-login.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.remote-login.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.remote-login.html">hr-HR</a></li><li><a
              href="../id-ID/sect.remote-login.html">id-ID</a></li><li><a
              href="../it-IT/sect.remote-login.html">it-IT</a></li><li><a
              href="../ja-JP/sect.remote-login.html">ja-JP</a></li><li><a
              href="../ko-KR/sect.remote-login.html">ko-KR</a></li><li><a
              href="../nb-NO/sect.remote-login.html">nb-NO</a></li><li><a
              href="../pl-PL/sect.remote-login.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.remote-login.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.remote-login.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.remote-login.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.remote-login.html">tr-TR</a></li><li><a
              href="../vi-VN/sect.remote-login.html">vi-VN</a></li><li><a
              href="../zh-CN/sect.remote-login.html">zh-CN</a></li><li><a
              href="../zh-TW/sect.remote-login.html">zh-TW</a></li></ul></div></body></html>
