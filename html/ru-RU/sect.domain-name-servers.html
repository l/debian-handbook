<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">10.6. Система Доменных Имен Серверов (DNS)</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-ru-RU-1.0-1" /><meta
        name="keywords"
        content="Сеть, Шлюз, TCP/IP, IPv6, DNS, Bind, DHCP, QoS" /><link
        rel="home"
        href="index.html"
        title="Настольная книга администратора Debian" /><link
        rel="up"
        href="network-infrastructure.html"
        title="Глава 10. Сетевая инфраструктура" /><link
        rel="prev"
        href="sect.ipv6.html"
        title="10.5. IPv6" /><link
        rel="next"
        href="sect.dhcp.html"
        title="10.7. DHCP" /><meta
        name="viewport"
        content="width=device-width, initial-scale=1" /><meta
        name="flattr:id"
        content="4pz9jq" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/ru-RU/sect.domain-name-servers.html" /></head><body><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="../../"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.ipv6.html"><strong>Пред.</strong></a></li><li
          class="home">Настольная книга администратора Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.dhcp.html"><strong>След.</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.domain-name-servers"></a>10.6. Система Доменных Имен Серверов (DNS)</h2></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.dns-principe"></a>10.6.1. Принципы и механизм</h3></div></div></div><a
            id="id-1.13.9.2.2"
            class="indexterm"></a><a
            id="id-1.13.9.2.3"
            class="indexterm"></a><div
            class="para">
				Система Доменных Имен Серверов или <span
              class="emphasis"><em>Domain Name Service</em></span> (DNS) является одним из фундаментальных понятий сети Internet: она представляет из себя таблицу преобразования узлов сети в IP адреса (и наоборот), что позволяет использовать строку вида <code
              class="literal">www.debian.org</code> взамен цифровых <code
              class="literal">5.153.231.4</code> или <code
              class="literal">2001:41c8:1000:21::21:4</code>.
			</div><div
            class="para">
				Записи DNS организованы по зонам; каждая зона соответствует какому-нибудь домену (или субдомену) или указанному диапазону IP адресов (в котором IP адреса, включённые в диапазон, расположены обычно последовательно). Главный сервер является авторитетным и содержит таблицу по зоне; вторичные серверы, обычно располагаемые на отдельных машинах, содержат регулярно обновляемые копии файла таблицы главной зоны.
			</div><a
            id="id-1.13.9.2.6"
            class="indexterm"></a><a
            id="id-1.13.9.2.7"
            class="indexterm"></a><div
            class="para">
				Каждая зона может содержать записи различных видов (<span
              class="emphasis"><em>Resource Records</em></span>):
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">A</code>: адрес IPv4. <a
                    id="id-1.13.9.2.9.1.1.2"
                    class="indexterm"></a>
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">CNAME</code>: псевдоним или alias (<span
                    class="emphasis"><em>canonical name</em></span>). <a
                    id="id-1.13.9.2.9.2.1.3"
                    class="indexterm"></a>
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">MX</code>: <span
                    class="emphasis"><em>mail exchange</em></span>, почтовый сервер. Эту информацию используют другие почтовые серверы для определения способа отправки письма по указанному адресу. Каждой записи MX присвоен свой приоритет. Сервер с наивысшим приоритетом (с наименьшим номером) используется в первую очередь (смотри вкладку <a
                    class="xref"
                    href="network-services.html#sidebar.smtp"><span
                      class="emphasis"><em>НАЗАД К ОСНОВАМ</em></span> SMTP</a>); с другими серверами связываются в порядке уменьшения их приоритетов в случае, если первый сервер не отвечает. <a
                    id="id-1.13.9.2.9.3.1.4"
                    class="indexterm"></a>
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">PTR</code>: преобразование IP адресов в текстовое имя. Такая запись хранится в зоне, названной “reverse DNS” (“обратная DNS”) после диапазона IP адресов. Для примера, <code
                    class="literal">1.168.192.in-addr.arpa</code> является зоной, содержащей обратное отображение всех адресов в диапазоне <code
                    class="literal">192.168.1.0/24</code>. <a
                    id="id-1.13.9.2.9.4.1.4"
                    class="indexterm"></a>
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">AAAA</code>: адреса IPv6. <a
                    id="id-1.13.9.2.9.5.1.2"
                    class="indexterm"></a>
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">NS</code>: отображает имя сервера имён (name server или NS). Каждый домен должен иметь по крайней мере хотя бы одну запись NS. Эти записи указывают на DNS сервер, который может ответить на запросы касательно данного домена; они обычно указывают на главный или вторичный серверы для данного домена. Кроме этого записи могут также позволить делегировать часть полномочий DNS кому-то; например, зона <code
                    class="literal">falcot.com</code> может быть включена как NS запись для <code
                    class="literal">internal.falcot.com</code>, а это означает, что внутренняя зона <code
                    class="literal">internal.falcot.com</code> будет обрабатываться другим (не первым) сервером. Конечно в этом случае данный сервер должен быть предварительно объявлен в зоне <code
                    class="literal">internal.falcot.com</code>. <a
                    id="id-1.13.9.2.9.6.1.6"
                    class="indexterm"></a>
					</div></li></ul></div><a
            id="id-1.13.9.2.10"
            class="indexterm"></a><a
            id="id-1.13.9.2.11"
            class="indexterm"></a><div
            class="para">
				Справочный сервер имён, Bind, был создан и в настоящее время поддерживается организацией ISC (<span
              class="emphasis"><em>Internet Software Consortium</em></span>). В Debian он включён в пакет <span
              class="pkg pkg">bind9</span>. По сравнения с предыдущей версией, в версию 9 включили два важных изменения. Первое: DNS сервер может теперь запускаться от лица непривилегированного пользователя. Это в свою очередь не позволит атакующему (систему), при возможно имеющихся секретных уязвимостях на сервере, воспользоваться правами суперпользователя (как можно было ранее неоднократно видеть, начиная с версий 8.x).
			</div><div
            class="para">
				Второе: Bind поддерживает стандарт DNSSEC для подписывания (и поэтому для выполнения идентификации) записей DNS. А это, в свою очередь, позволит блокировать любые изменённые данные (в записях DNS) в момент осуществления атаки "man-in-the-middle attacks".
			</div><a
            id="id-1.13.9.2.14"
            class="indexterm"></a><a
            id="id-1.13.9.2.15"
            class="indexterm"></a><a
            id="id-1.13.9.2.16"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>КУЛЬТУРА</em></span> DNSSEC</strong></p></div></div></div><a
              id="id-1.13.9.2.17.2"
              class="indexterm"></a><div
              class="para">
				Стандарт DNSSEC довольно сложный; это отчасти объясняет, почему он ещё не используется широко (даже несмотря на то, что он прекрасно взаимодействует с серверами DNS, не знающими о существовании DNSSEC). Чтобы понять все тонкости, следует ознакомиться со следующей статьёй. <div
                class="url">→ <a
                  href="https://ru.wikipedia.org/wiki/DNSSEC">https://ru.wikipedia.org/wiki/DNSSEC</a></div>
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.dns-config"></a>10.6.2. Настройка</h3></div></div></div><div
            class="para">
				Файлы настройки программы <code
              class="command">bind</code>, независимо от версии, имеют одинаковую структуру.
			</div><div
            class="para">
				Администраторы компании Falcot создали первичную зону <code
              class="literal">falcot.com</code>, в которой располагается информация, касающаяся данного домена, и зону <code
              class="literal">168.192.in-addr.arpa</code> для обратного преобразования IP адресов в адреса локальной сети (то есть сопоставления их).
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ПРЕДОСТЕРЕЖЕНИЕ</em></span> Преобразование имён зон</strong></p></div></div></div><a
              id="id-1.13.9.3.4.2"
              class="indexterm"></a><a
              id="id-1.13.9.3.4.3"
              class="indexterm"></a><a
              id="id-1.13.9.3.4.4"
              class="indexterm"></a><a
              id="id-1.13.9.3.4.5"
              class="indexterm"></a><a
              id="id-1.13.9.3.4.6"
              class="indexterm"></a><div
              class="para">
				Преобразованные зоны имеют особенные имена. Зона, включающая в себя сеть <code
                class="literal">192.168.0.0/16</code>, должна быть названа как <code
                class="literal">168.192.in-addr.arpa</code>: 1-ая и 2-ая части IP адреса записаны наоборот, и далее следует суффикс <code
                class="literal">in-addr.arpa</code>.
			</div><div
              class="para">
				Для сетей IPv6 суффиксом будет <code
                class="literal">ip6.arpa</code> и используются части IP адреса. Полная шестнадцатеричная последовательность символов, включённых в IP адрес (без учёта ":"), записывается наоборот следующим образом - каждый символ отдельно (с использованием в качестве разделителя "точки"). То есть для сети <code
                class="literal">2001:0bc8:31a0::/48</code> будет использоваться имя зоны <code
                class="literal">0.a.1.3.8.c.b.0.1.0.0.2.ip6.arpa</code>.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>СОВЕТ</em></span> Тестирование сервера DNS</strong></p></div></div></div><div
              class="para">
				Команда <code
                class="command">host</code> (в пакете <span
                class="pkg pkg">bind9-host</span>) делает запросы на сервер DNS, а кроме этого может быть использована и для тестирования настроенного сервера. Для примера, <code
                class="command">host machine.falcot.com localhost</code> проверит ответ локального сервера на запрос от <code
                class="literal">machine.falcot.com</code>. А команда <code
                class="command">host <em
                  class="replaceable">ipaddress</em> localhost</code> тестирует обратное преобразование имён.
			</div><a
              id="id-1.13.9.3.5.3"
              class="indexterm"></a></div><div
            class="para">
				Следующие выдержки взяты из файлов настройки, использующихся в компании Falcot, и могут послужить отправной точкой для настраивания сервера DNS:
			</div><a
            id="id-1.13.9.3.7"
            class="indexterm"></a><a
            id="id-1.13.9.3.8"
            class="indexterm"></a><div
            class="example"><a
              id="example.bind-named.conf.local"></a><p
              class="title"><strong>Пример 10.12. Выдержка из <code
                  class="filename">/etc/bind/named.conf.local</code></strong></p><div
              class="example-contents"><pre
                class="programlisting">
zone "falcot.com" {
        type master;
        file "/etc/bind/db.falcot.com";
        allow-query { any; };
        allow-transfer {
                195.20.105.149/32 ; // ns0.xname.org
                193.23.158.13/32 ; // ns1.xname.org
        };
};

zone "internal.falcot.com" {
        type master;
        file "/etc/bind/db.internal.falcot.com";
        allow-query { 192.168.0.0/16; };
};

zone "168.192.in-addr.arpa" {
        type master;
        file "/etc/bind/db.192.168";
        allow-query { 192.168.0.0/16; };
};
</pre></div></div><div
            class="example"><a
              id="example.bind-db.falcot.com"></a><p
              class="title"><strong>Пример 10.13. Выдержка из <code
                  class="filename">/etc/bind/db.falcot.com</code></strong></p><div
              class="example-contents"><pre
                class="programlisting">; falcot.com Zone 
; admin.falcot.com. =&gt; zone contact: admin@falcot.com
$TTL    604800
@       IN      SOA     falcot.com. admin.falcot.com. (
                        20040121        ; Serial
                         604800         ; Refresh
                          86400         ; Retry
                        2419200         ; Expire
                         604800 )       ; Negative Cache TTL
;
; The @ refers to the zone name ("falcot.com" here)
; or to $ORIGIN if that directive has been used
;
@       IN      NS      ns
@       IN      NS      ns0.xname.org.

internal IN      NS      192.168.0.2

@       IN      A       212.94.201.10
@       IN      MX      5 mail
@       IN      MX      10 mail2

ns      IN      A       212.94.201.10
mail    IN      A       212.94.201.10
mail2   IN      A       212.94.201.11
www     IN      A       212.94.201.11

dns     IN      CNAME   ns
</pre></div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ПРЕДОСТЕРЕЖЕНИЕ</em></span> Синтаксис имени</strong></p></div></div></div><div
              class="para">
				Синтаксис формирования имён машин придерживается строгих правил. Например, <code
                class="literal">machine</code> означает <code
                class="literal">machine.<em
                  class="replaceable">domain</em></code>. Если доменное имя не добавлено к имени, то указанное имя должно быть записано как <code
                class="literal">machine.</code> (с добавлением в качестве суффикса "точки"). А синтаксис имени внешнего DNS по отношению к данному домену должен быть такой <code
                class="literal">machine.otherdomain.com.</code> (с указанием в конце "точки").
			</div></div><div
            class="example"><a
              id="example.bind-db.192.168"></a><p
              class="title"><strong>Пример 10.14. Выдержка из <code
                  class="filename">/etc/bind/db.192.168</code></strong></p><div
              class="example-contents"><pre
                class="programlisting">; Reverse zone for 192.168.0.0/16
; admin.falcot.com. =&gt; zone contact: admin@falcot.com
$TTL    604800
@       IN      SOA     ns.internal.falcot.com. admin.falcot.com. (
                        20040121        ; Serial
                         604800         ; Refresh
                          86400         ; Retry
                        2419200         ; Expire
                         604800 )       ; Negative Cache TTL

        IN      NS      ns.internal.falcot.com.

; 192.168.0.1 -&gt; arrakis
1.0     IN      PTR     arrakis.internal.falcot.com.
; 192.168.0.2 -&gt; neptune
2.0     IN      PTR     neptune.internal.falcot.com.

; 192.168.3.1 -&gt; pau
1.3     IN      PTR     pau.internal.falcot.com.
</pre></div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.ipv6.html"><strong>Пред.</strong>10.5. IPv6</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Наверх</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Начало</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.dhcp.html"><strong>След.</strong>10.7. DHCP</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.domain-name-servers.html">ar-MA</a></li><li><a
              href="../da-DK/sect.domain-name-servers.html">da-DK</a></li><li><a
              href="../de-DE/sect.domain-name-servers.html">de-DE</a></li><li><a
              href="../el-GR/sect.domain-name-servers.html">el-GR</a></li><li><a
              href="../en-US/sect.domain-name-servers.html">en-US</a></li><li><a
              href="../es-ES/sect.domain-name-servers.html">es-ES</a></li><li><a
              href="../fa-IR/sect.domain-name-servers.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.domain-name-servers.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.domain-name-servers.html">hr-HR</a></li><li><a
              href="../id-ID/sect.domain-name-servers.html">id-ID</a></li><li><a
              href="../it-IT/sect.domain-name-servers.html">it-IT</a></li><li><a
              href="../ja-JP/sect.domain-name-servers.html">ja-JP</a></li><li><a
              href="../ko-KR/sect.domain-name-servers.html">ko-KR</a></li><li><a
              href="../nb-NO/sect.domain-name-servers.html">nb-NO</a></li><li><a
              href="../pl-PL/sect.domain-name-servers.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.domain-name-servers.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.domain-name-servers.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.domain-name-servers.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.domain-name-servers.html">tr-TR</a></li><li><a
              href="../vi-VN/sect.domain-name-servers.html">vi-VN</a></li><li><a
              href="../zh-CN/sect.domain-name-servers.html">zh-CN</a></li><li><a
              href="../zh-TW/sect.domain-name-servers.html">zh-TW</a></li></ul></div></body></html>
