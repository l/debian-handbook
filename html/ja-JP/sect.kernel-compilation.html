<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">8.10. カーネルのコンパイル</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-ja-JP-1.0-1" /><meta
        name="keywords"
        content="設定, 地域化, ロケール, ネットワーク, 名前解決, ユーザ, グループ, アカウント, コマンドラインインタプリタ, シェル, 印刷, ブートローダ, カーネルのコンパイル" /><link
        rel="home"
        href="index.html"
        title="Debian 管理者ハンドブック" /><link
        rel="up"
        href="basic-configuration.html"
        title="第 8 章 基本設定、ネットワーク、アカウント、印刷..." /><link
        rel="prev"
        href="sect.config-misc.html"
        title="8.9. その他の設定、時刻同期、ログ、共有アクセス…" /><link
        rel="next"
        href="sect.kernel-installation.html"
        title="8.11. カーネルのインストール" /><meta
        name="viewport"
        content="width=device-width, initial-scale=1" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/ja-JP/sect.kernel-compilation.html" /></head><body><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="../../"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.config-misc.html"><strong>戻る</strong></a></li><li
          class="home">Debian 管理者ハンドブック</li><li
          class="next"><a
            accesskey="n"
            href="sect.kernel-installation.html"><strong>次へ</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.kernel-compilation"></a>8.10. カーネルのコンパイル</h2></div></div></div><a
          id="id-1.11.14.2"
          class="indexterm"></a><a
          id="id-1.11.14.3"
          class="indexterm"></a><div
          class="para">
			Debian の提供するカーネルは、既存のハードウェア構成の広い領域をカバーするために、できる限り多くの機能およびドライバを組み込んでいます。このため、一部のユーザにとっては本当に必要なものだけを含める目的でカーネルを再コンパイルするほうが良い場合もあります。カーネルを再コンパイルする理由は 2 つあります。1 つ目は、メモリ消費量を最適化できるかもしれないからです。全く使われないカーネルコードは無駄にメモリを専有するため (カーネルコードは決してスワップ領域に「移動」されません。なぜなら、カーネルコードがスワップ用の RAM 領域を管理しているからです)、システム全体のパフォーマンスを低下させます。2 つ目は、カーネルを自前でコンパイルすればカーネルコードのごく一部をコンパイルして実行することになり、セキュリティ問題の危険性を限定することが可能だからです。
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>NOTE</em></span> セキュリティ更新</strong></p></div></div></div><div
            class="para">
			自前でカーネルをコンパイルする場合、以下の点に同意しなければいけません。それは、Debian は自前でコンパイルしたカスタムカーネルに対するセキュリティ更新を保証できないという点です。Debian が提供するカーネルを使うことにすれば、Debian プロジェクトのセキュリティチームが用意した更新の恩恵を受けることができます。
		</div></div><div
          class="para">
			さらに、パッチの形でしか供給されていない (標準的なカーネルのバージョンに含まれていない) 特定の機能を使いたい場合もカーネルの再コンパイルが必要です。
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>GOING FURTHER</em></span> Debian カーネルハンドブック</strong></p></div></div></div><a
            id="id-1.11.14.7.2"
            class="indexterm"></a><div
            class="para">
			Debian カーネルチームは「Debian カーネルハンドブック」をメンテナンスしています (「Debian カーネルハンドブック」は <span
              class="pkg pkg">debian-kernel-handbook</span> パッケージからも入手できます)。「Debian カーネルハンドブック」ではカーネル関連の作業と公式 Debian カーネルパッケージの取り扱い方法が包括的に説明されています。「Debian カーネルハンドブック」はこの節で提供される情報よりも詳しい情報が必要になった場合に最初に調べるべき文書です。<div
              class="url">→ <a
                href="http://kernel-handbook.alioth.debian.org">http://kernel-handbook.alioth.debian.org</a></div>
		</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.kernel-compilation-prerequisites"></a>8.10.1. 前置きと前提条件</h3></div></div></div><div
            class="para">
				当然ながら、Debian はパッケージの形でカーネルを管理します。このやり方はカーネルをコンパイルおよびインストールする伝統的な方法とは異なります。しかしながら、カーネルをパッケージングシステムの制御下に置くことで、カーネルを完全に削除したり複数のマシンに配備したりすることが可能になります。さらに、カーネルのパッケージに関連付けられたスクリプトのおかげで、ブートローダと initrd ジェネレータとの連動が自動化されます。
			</div><div
            class="para">
				上流開発の Linux ソースには、カーネルの Debian パッケージをビルドするために必要な要素のすべてが含まれています。しかし、Debian パッケージをビルドするのに必要なツールを確実にそろえるためには <span
              class="pkg pkg">build-essential</span> のインストールも必要です。さらに、カーネルを設定するためには <span
              class="pkg pkg">libncurses5-dev</span> パッケージも必要です。最後に、<span
              class="pkg pkg">fakeroot</span> パッケージを使えば管理者権限を使わずに Debian パッケージを作成することも可能になります。
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>CULTURE</em></span> <span
                        class="pkg pkg">kernel-package</span> の古き良き時代</strong></p></div></div></div><a
              id="id-1.11.14.8.4.2"
              class="indexterm"></a><div
              class="para">
				Linux ビルドシステムに適切な Debian パッケージをビルドする能力がなかった時代、Debian パッケージをビルドするのに推奨されていた方法は <span
                class="pkg pkg">kernel-package</span> パッケージに含まれる <code
                class="command">make-kpkg</code> を使うやり方でした。
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.kernel-sources"></a>8.10.2. ソースを入手</h3></div></div></div><a
            id="id-1.11.14.9.2"
            class="indexterm"></a><a
            id="id-1.11.14.9.3"
            class="indexterm"></a><a
            id="id-1.11.14.9.4"
            class="indexterm"></a><div
            class="para">
				Debian システム上で便利に使えるプログラムと同様に、Linux カーネルソースはパッケージとして提供されています。Linux カーネルソースを手に入れるには、<span
              class="pkg pkg">linux-source-<em
                class="replaceable">version</em></span> パッケージをインストールしてください。Debian がパッケージングしたカーネルのさまざまなバージョンを確認するには <code
              class="command">apt-cache search ^linux-source</code> コマンドを使ってください。最新のバージョンは<span
              class="distribution distribution">不安定版</span>ディストリビューションに含まれています。すなわち、大して危険性を伴わずにカーネルの最新バージョンを入手できます (特に APT が<a
              class="xref"
              href="sect.apt-get.html#sect.apt-mix-distros">第 6.2.6 節「複数ディストリビューションの利用」</a>の説明に従って設定されている場合、大きな危険性はないと言えます)。Debian のカーネルソースパッケージに含まれるソースコードは Linus Torvalds とカーネル開発者が公開したソースコードと全く同じものではないという点に注意してください。すべてのディストリビューションと同様に、Debian もまたカーネルソースに数多くのパッチを適用します。このパッチは今後 Linux の上流開発版に取り込まれるかもしれません (取り込まれない場合もあります)。これらの変更には新しいカーネルバージョンに追加された修正/機能/ドライバのバックポート、まだ上流開発の Linux ツリーに (完全に) マージされていない新機能、場合によっては Debian 特有の変更が含まれます。
			</div><div
            class="para">
				この節のこれ以降の説明では、Linux カーネルのバージョン 3.16 を例に挙げます。しかしながら、この例はもちろん他のカーネルの特定のバージョンにも適用できます。
			</div><div
            class="para">
				<span
              class="pkg pkg">linux-source-3.16</span> パッケージがインストール済みと仮定します。<span
              class="pkg pkg">linux-source-3.16</span> パッケージには、カーネルソースの圧縮アーカイブである <code
              class="filename">/usr/src/linux-source-3.16.tar.xz</code> が含まれます。この圧縮アーカイブを新しいディレクトリに展開してください (<code
              class="filename">/usr/src/</code> の下のディレクトリに展開しないよう注意してください。なぜなら、Linux カーネルをコンパイルするのに特別なパーミッションは必要ないからです)。すなわち <code
              class="filename">~/kernel/</code> に展開することが適切です。
			</div><pre
            class="screen">
<code
              class="computeroutput">$ </code><strong
              class="userinput"><code>mkdir ~/kernel; cd ~/kernel</code></strong>
<code
              class="computeroutput">$ </code><strong
              class="userinput"><code>tar -xaf /usr/src/linux-source-3.16.tar.xz</code></strong></pre><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>CULTURE</em></span> カーネルソースの場所</strong></p></div></div></div><div
              class="para">
				伝統的に、Linux カーネルソースは <code
                class="filename">/usr/src/linux/</code> に置かれているので、カーネルをコンパイルするには root 権限が必要です。しかしながら、その必要がないにも関わらず管理者権限を使って作業するべきではありません。<code
                class="literal">src</code> グループのメンバーは <code
                class="filename">/usr/src/</code> ディレクトリの中で作業することを許されていますが、それでもなおこのディレクトリの中で作業するべきではありません。カーネルソースを個人ディレクトリに置けば、あらゆる点でセキュリティを確保できます。つまり <code
                class="filename">/usr/</code> 以下に存在するファイルはパッケージングシステムの知っているファイルだけになりますし、使用中のカーネルの情報を収集しようとして <code
                class="filename">/usr/src/linux</code> を読むプログラムを間違った方向に導く危険性もなくなります。
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.config-kernel"></a>8.10.3. カーネルの設定</h3></div></div></div><a
            id="id-1.11.14.10.2"
            class="indexterm"></a><a
            id="id-1.11.14.10.3"
            class="indexterm"></a><a
            id="id-1.11.14.10.4"
            class="indexterm"></a><div
            class="para">
				次の段階で、必要性に応じてカーネルを設定します。完全な手順はその目標に依存します。
			</div><div
            class="para">
				より最近のカーネルのバージョンを再コンパイルする場合 (おそらく追加的パッチを適用する場合)、その設定は Debian の提案する設定と可能な限り似たものになるでしょう。この場合、すべてを最初から再設定するのではなく、<code
              class="filename">/boot/config-<em
                class="replaceable">version</em></code> ファイル (ここで version は現在使っているカーネルで、<code
              class="command">uname -r</code> コマンドでわかります) をカーネルソースに含まれるディレクトリ内の <code
              class="filename">.config</code> ファイルにコピーするだけで十分です。
			</div><pre
            class="screen">
<code
              class="computeroutput">$ </code><strong
              class="userinput"><code>cp /boot/config-3.16.0-4-amd64 ~/kernel/linux-source-3.16/.config</code></strong></pre><div
            class="para">
				設定を変更する必要がなければ、ここまでで止めて<a
              class="xref"
              href="sect.kernel-compilation.html#sect.kernel-build">第 8.10.4 節「パッケージのコンパイルとビルド」</a>に進むことも可能です。一方で、設定を変更する必要があったり最初からすべてを再設定する場合、時間をかけてカーネルを設定しなければいけません。カーネルソースディレクトリには <code
              class="command">make <em
                class="replaceable">target</em></code> コマンドを呼び出して使うさまざまな専用のインターフェースがあります。ここで <em
              class="replaceable">target</em> は以下に説明するものの 1 つです。
			</div><div
            class="para">
				<code
              class="command">make menuconfig</code> は階層構造でオプションを案内するテキストモードインターフェースをコンパイルして実行します (コンパイルおよび実行には <span
              class="pkg pkg">libncurses5-dev</span> パッケージが必要です)。<span
              class="keycap"><strong>Space</strong></span> キーで選択されたオプションの値を変更します。<span
              class="keycap"><strong>Enter</strong></span> キーで画面の下部にある選択状態のボタンを押します。さらに <span
              class="guibutton"><strong>Select</strong></span> ボタンで選択されたサブメニューを返します。さらに <span
              class="guibutton"><strong>Exit</strong></span> ボタンで現在の画面を閉じて階層を一段階上に戻ります。さらに <span
              class="guibutton"><strong>Help</strong></span> ボタンで選択されたオプションの役割に関するより詳細な情報を表示します。矢印キーでオプションリストとボタンの間を移動します。設定プログラムを終了するには、メインメニューから <span
              class="guibutton"><strong>Exit</strong></span> ボタンを選択してください。すると、このプログラムは変更を保存するよう提案します。そして変更内容に満足したら、保存してください。
			</div><div
            class="para">
				他のインターフェースも同様の機能を持っていますが、より現代的なグラフィカルインターフェースで機能します。<code
              class="command">make xconfig</code> は Qt グラフィカルインターフェース、<code
              class="command">make gconfig</code> は GTK+ を使います。<code
              class="command">make xconfig</code> には <span
              class="pkg pkg">libqt4-dev</span> が必要で、<code
              class="command">make gconfig</code> には <span
              class="pkg pkg">libglade2-dev</span> と <span
              class="pkg pkg">libgtk2.0-dev</span> が必要です。
			</div><div
            class="para">
				これらの設定インターフェースのうち 1 つを使う場合、合理的なデフォルト設定から始めるのが良いアイディアです。カーネルのデフォルト設定は <code
              class="filename">arch/<em
                class="replaceable">arch</em>/configs/*_defconfig</code> に置かれています。この設定ファイルを適切な場所に置くには、<code
              class="command">make x86_64_defconfig</code> (64 ビット PC の場合) や <code
              class="command">make i386_defconfig</code> (32 ビット PC の場合) などのコマンドを使います。
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>TIP</em></span> 古い <code
                        class="filename">.config</code> ファイルに対処する</strong></p></div></div></div><div
              class="para">
				他の (通常古い) カーネルバージョンで生成された <code
                class="filename">.config</code> ファイルを使う場合、内容を更新しなければいけません。内容を更新するには <code
                class="command">make oldconfig</code> を使います。このコマンドは新しい設定オプションに関する質問を対話的に尋ねます。すべての質問に対してデフォルトの答えを使う場合、<code
                class="command">make olddefconfig</code> を使ってください。すべての質問にデフォルトと反対の答えを使う場合、<code
                class="command">make oldnoconfig</code> を使ってください。
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.kernel-build"></a>8.10.4. パッケージのコンパイルとビルド</h3></div></div></div><a
            id="id-1.11.14.11.2"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>NOTE</em></span> 再ビルド前の片付け</strong></p></div></div></div><div
              class="para">
				既にそのディレクトリの中で 1 回コンパイルした状態で、(たとえばカーネル設定を大幅に変更したなどの理由で) すべてを最初から再ビルドしたい場合、<code
                class="command">make clean</code> を実行してコンパイル済みファイルを削除しなければいけません。<code
                class="command">make distclean</code> はさらに生成されたファイルも削除します。この中には <code
                class="filename">.config</code> ファイルも含まれますので、忘れずにバックアップしてください。
			</div></div><div
            class="para">
				カーネル設定の準備が完了したら、<code
              class="command">make deb-pkg</code> で 5 つの Debian パッケージが生成されます。具体的に言えば、カーネルイメージと関連モジュールを含む <span
              class="pkg pkg">linux-image-<em
                class="replaceable">version</em></span>、外部モジュールのビルドに必要なヘッダファイルを含む <span
              class="pkg pkg">linux-headers-<em
                class="replaceable">version</em></span>、一部のドライバから要求されるファームウェアファイルを含む <span
              class="pkg pkg">linux-firmware-image-<em
                class="replaceable">version</em></span> (Debian の配布しているカーネルソースからカーネルをビルドする場合、このパッケージは生成されないかもしれません)、カーネルイメージとモジュールのデバッグシンボルを含む <span
              class="pkg pkg">linux-image-<em
                class="replaceable">version</em>-dbg</span>、GNU glibc などのユーザ空間ライブラリに関連するヘッダを含む <span
              class="pkg pkg">linux-libc-dev</span> が生成されます。
			</div><div
            class="para">
				ここで <em
              class="replaceable">version</em> は上流開発バージョン (<code
              class="filename">Makefile</code> 中の <code
              class="literal">VERSION</code>、<code
              class="literal">PATCHLEVEL</code>、<code
              class="literal">SUBLEVEL</code>、<code
              class="literal">EXTRAVERSION</code> から定義されます)、<code
              class="literal">LOCALVERSION</code> 設定パラメータ、<code
              class="literal">LOCALVERSION</code> 環境変数を連結したものです。パッケージバージョンは <em
              class="replaceable">version</em> に規則正しく増え続けるリビジョン番号 (<code
              class="filename">.version</code> に保存されています) を付け加えたものになります。ただし、<code
              class="literal">KDEB_PKGVERSION</code> 環境変数を使えばパッケージバージョンを上書きすることも可能です。
			</div><pre
            class="screen"><code
              class="computeroutput">$ </code><strong
              class="userinput"><code>make deb-pkg LOCALVERSION=-falcot KDEB_PKGVERSION=$(make kernelversion)-1
</code></strong><code
              class="computeroutput">[...]
$ </code><strong
              class="userinput"><code>ls ../*.deb
</code></strong><code
              class="computeroutput">../linux-headers-3.16.7-ckt4-falcot_3.16.7-1_amd64.deb
../linux-image-3.16.7-ckt4-falcot_3.16.7-1_amd64.deb
../linux-image-3.16.7-ckt4-falcot-dbg_3.16.7-1_amd64.deb
../linux-libc-dev_3.16.7-1_amd64.deb
</code></pre></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.modules-build"></a>8.10.5. 外部モジュールのコンパイル</h3></div></div></div><a
            id="id-1.11.14.12.2"
            class="indexterm"></a><a
            id="id-1.11.14.12.3"
            class="indexterm"></a><a
            id="id-1.11.14.12.4"
            class="indexterm"></a><div
            class="para">
				いくつかのモジュールは公式の Linux カーネルの外でメンテナンスされています。このような外部モジュールを使うには、適合するカーネルと一緒にモジュールをコンパイルしなければいけません。Debian は専用パッケージの形で数多くのサードパーティ製の外部モジュールを配布しています。たとえば、<span
              class="pkg pkg">xtables-addons-source</span> (iptables 用の追加モジュール)、<span
              class="pkg pkg">oss4-source</span> (Open Sound System、代替音声ドライバ) などがその一例です。
			</div><div
            class="para">
				これらの外部モジュール用パッケージは多種多様で、ここですべてを挙げることはできません。外部モジュール用パッケージを検索するには <code
              class="command">apt-cache search source$</code> コマンドを使います。しかしながら、完全なリストがあったとしても、それは特に役立つわけではありません。なぜなら、外部モジュールが必要であるとわかっている場合を除いて、外部モジュールをコンパイルする特別な理由はないからです。デバイスの動作に外部モジュールが必要になる場合、デバイスの文書が Linux でそのデバイスを機能させるために必要な特定のモジュールについて詳しく説明している場合が多いです。
			</div><div
            class="para">
				たとえば、<span
              class="pkg pkg">xtables-addons-source</span> パッケージを見てみましょう。インストールの後、モジュールのソース <code
              class="filename">.tar.bz2</code> が <code
              class="filename">/usr/src/</code> に保存されます。手作業でこの tarball を展開してモジュールをビルドすることも可能ですが、実際のところ、DKMS を使ってビルド作業を自動化する方が良いです。多くのモジュールは、パッケージ名が <code
              class="literal">-dkms</code> サフィックスで終わるパッケージの中で、DKMS 統合に必要な要素を提供します。今回の場合、インストール済みカーネルに対応する <span
              class="pkg pkg">linux-headers-*</span> パッケージを持っているならば、現在のカーネル用のカーネルモジュールをコンパイルするために必要な作業は <span
              class="pkg pkg">xtables-addons-dkms</span> をインストールするだけです。たとえば、<span
              class="pkg pkg">linux-image-amd64</span> を使っている場合、<span
              class="pkg pkg">linux-headers-amd64</span> をインストールする必要があります。
			</div><pre
            class="screen">
<code
              class="computeroutput">$ </code><strong
              class="userinput"><code>sudo apt install xtables-addons-dkms</code></strong>
<code
              class="computeroutput">
[...]
xtables-addons-dkms (2.6-1) を設定しています ...
Loading new xtables-addons-2.6 DKMS files...
First Installation: checking all kernels...
Building only for 3.16.0-4-amd64
Building initial module for 3.16.0-4-amd64
Done.

xt_ACCOUNT:
Running module version sanity check.
 - Original module
   - No original module exists within this kernel
 - Installation
   - Installing to /lib/modules/3.16.0-4-amd64/updates/dkms/
[...]
DKMS: install completed.
$ </code><strong
              class="userinput"><code>sudo dkms status</code></strong>
<code
              class="computeroutput">xtables-addons, 2.6, 3.16.0-4-amd64, x86_64: installed
$ </code><strong
              class="userinput"><code>sudo modinfo xt_ACCOUNT</code></strong>
<code
              class="computeroutput">filename:       /lib/modules/3.16.0-4-amd64/updates/dkms/xt_ACCOUNT.ko
license:        GPL
alias:          ipt_ACCOUNT
author:         Intra2net AG &lt;opensource@intra2net.com&gt;
description:    Xtables: per-IP accounting for large prefixes
[...]
</code></pre><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ALTERNATIVE</em></span> module-assistant</strong></p></div></div></div><a
              id="id-1.11.14.12.9.2"
              class="indexterm"></a><div
              class="para">
				DKMS 以前、カーネルモジュールをビルドして配置する最も簡単な解決策は <span
                class="pkg pkg">module-assistant</span> でした。特に DKMS 統合されていないパッケージはまだ <span
                class="pkg pkg">module-assistant</span> を使っています。このようなパッケージでは、単純なコマンド <code
                class="command">module-assistant auto-install xtables-addons</code> (または短縮コマンドの <code
                class="command">m-a a-i xtables-addons</code>) を使えば、モジュールを現在のカーネル用にコンパイルして新しい Debian パッケージを作成できます。作成したパッケージはその場でインストールできます。
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.kernel-patch"></a>8.10.6. カーネルパッチの適用</h3></div></div></div><a
            id="id-1.11.14.13.2"
            class="indexterm"></a><a
            id="id-1.11.14.13.3"
            class="indexterm"></a><div
            class="para">
				一部の機能は完成度の低さやカーネルメンテナとの意見の不一致が原因で標準的なカーネルに含まれていません。そのような機能をカーネルソースに対して自由に適用できるようにするために、これをパッチの形で配布する場合があります。
			</div><div
            class="para">
				Debian はいくつかのパッチを <span
              class="pkg pkg">linux-patch-*</span> や <span
              class="pkg pkg">kernel-patch-*</span> パッケージの形で配布します (たとえば、<span
              class="pkg pkg">linux-patch-grsecurity2</span> はカーネルのセキュリティポリシーを厳しくするパッチです)。これらのパッケージは <code
              class="filename">/usr/src/kernel-patches/</code> ディレクトリにファイルをインストールします。
			</div><div
            class="para">
				インストール済みパッチをカーネルに適用するには、ソースディレクトリの中で <code
              class="command">patch</code> コマンドを使い、上で述べた通り、カーネルのコンパイルを始めてください。
			</div><pre
            class="screen">
<code
              class="computeroutput">$ </code><strong
              class="userinput"><code>cd ~/kernel/linux-source-3.16</code></strong>
<code
              class="computeroutput">$ </code><strong
              class="userinput"><code>make clean</code></strong>
<code
              class="computeroutput">$ </code><strong
              class="userinput"><code>zcat /usr/src/kernel-patches/diffs/grsecurity2/grsecurity-3.0-3.17.1-201410250027.patch.gz | patch -p1</code></strong></pre><div
            class="para">
				与えられたパッチがカーネルのどのバージョンでも動作するとは限らないことに注意してください。さらに、カーネルソースにパッチを適用する際に、<code
              class="command">patch</code> が失敗することもあります。エラーメッセージが表示され、失敗に関する詳細が表示されるでしょう。この場合、そのパッチの Debian パッケージで利用できる文書 (<code
              class="filename">/usr/share/doc/linux-patch-*/</code> ディレクトリに含まれます) を参照してください。多くの場合、メンテナはそのパッチがどのカーネルバージョンを対象にしたものかを書いています。
			</div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.config-misc.html"><strong>戻る</strong>8.9. その他の設定、時刻同期、ログ、共有アクセス…</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>上に戻る</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>ホーム</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.kernel-installation.html"><strong>次へ</strong>8.11. カーネルのインストール</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.kernel-compilation.html">ar-MA</a></li><li><a
              href="../da-DK/sect.kernel-compilation.html">da-DK</a></li><li><a
              href="../de-DE/sect.kernel-compilation.html">de-DE</a></li><li><a
              href="../el-GR/sect.kernel-compilation.html">el-GR</a></li><li><a
              href="../en-US/sect.kernel-compilation.html">en-US</a></li><li><a
              href="../es-ES/sect.kernel-compilation.html">es-ES</a></li><li><a
              href="../fa-IR/sect.kernel-compilation.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.kernel-compilation.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.kernel-compilation.html">hr-HR</a></li><li><a
              href="../id-ID/sect.kernel-compilation.html">id-ID</a></li><li><a
              href="../it-IT/sect.kernel-compilation.html">it-IT</a></li><li><a
              href="../ja-JP/sect.kernel-compilation.html">ja-JP</a></li><li><a
              href="../ko-KR/sect.kernel-compilation.html">ko-KR</a></li><li><a
              href="../nb-NO/sect.kernel-compilation.html">nb-NO</a></li><li><a
              href="../pl-PL/sect.kernel-compilation.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.kernel-compilation.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.kernel-compilation.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.kernel-compilation.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.kernel-compilation.html">tr-TR</a></li><li><a
              href="../zh-CN/sect.kernel-compilation.html">zh-CN</a></li><li><a
              href="../zh-TW/sect.kernel-compilation.html">zh-TW</a></li></ul></div></body></html>
