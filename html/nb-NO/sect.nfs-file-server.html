<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">11.4. NFS-filtjener</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-nb-NO-1.0-1" /><meta
        name="keywords"
        content="Postfix, Apache, NFS, Samba, Squid, OpenLDAP, SIP" /><link
        rel="home"
        href="index.html"
        title="Håndbok for Debian-administratoren" /><link
        rel="up"
        href="network-services.html"
        title="Kapittel 11. Nettverkstjenester: Postfix, Apache, NFS, Samba, Squid, LDAP, SIP, XMPP, TURN" /><link
        rel="prev"
        href="sect.ftp-file-server.html"
        title="11.3. FTP-filtjener" /><link
        rel="next"
        href="sect.windows-file-server-with-samba.html"
        title="11.5. Setting Up Windows Shares with Samba" /><meta
        name="viewport"
        content="width=device-width, initial-scale=1" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/nb-NO/sect.nfs-file-server.html" /></head><body><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="../../"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.ftp-file-server.html"><strong>Forrige</strong></a></li><li
          class="home">Håndbok for Debian-administratoren</li><li
          class="next"><a
            accesskey="n"
            href="sect.windows-file-server-with-samba.html"><strong>Neste</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.nfs-file-server"></a>11.4. NFS-filtjener</h2></div></div></div><div
          class="para">
			NFS (<span
            class="emphasis"><em>Network File System</em></span>) er en protokoll som tillater ekstern tilgang til et filsystem gjennom nettverket. Alle Unix-systemer kan arbeide med denne protokollen; når Windows-systemer er involvert, må Samba brukes i stedet.
		</div><a
          id="id-1.14.7.3"
          class="indexterm"></a><a
          id="id-1.14.7.4"
          class="indexterm"></a><a
          id="id-1.14.7.5"
          class="indexterm"></a><a
          id="id-1.14.7.6"
          class="indexterm"></a><a
          id="id-1.14.7.7"
          class="indexterm"></a><div
          class="para">
			NFS er et svært nyttig verktøy, men har tidligere lidd av mange begrensninger, som det er tatt hensyn til i versjon 4 av protokollen. Ulempen er at den nyeste versjonen av NFS er vanskeligere å sette opp når du ønsker å bruke grunnleggende sikkerhetsfunksjoner som autentisering og kryptering, da den trenger Kerberos for dette. Og uten disse må NFS-protokollen begrenses til et klarert lokalt nettverk når data ukryptert går over nettverket (en <span
            class="emphasis"><em>sniffer</em></span> kan fange den opp), og adgangsrettighetene er gitt med utgangspunkt i klientens IP-adresse (som kan etterlignes).
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>DOKUMENTASJON</em></span> NFS HOWTO</strong></p></div></div></div><div
            class="para">
			Det er ganske knapt med god dokumentasjon om å distribuere NFSv4. Her er noen tips med innhold av varierende kvalitet, men det bør i det minste gi noen hint om hva som bør gjøres. <div
              class="url">→ <a
                href="https://help.ubuntu.com/community/NFSv4Howto">https://help.ubuntu.com/community/NFSv4Howto</a></div> <div
              class="url">→ <a
                href="http://wiki.linux-nfs.org/wiki/index.php/Nfsv4_configuration">http://wiki.linux-nfs.org/wiki/index.php/Nfsv4_configuration</a></div>
		</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.14.7.10"></a>11.4.1. Å sikre NFS</h3></div></div></div><a
            id="id-1.14.7.10.2"
            class="indexterm"></a><div
            class="para">
				Hvis du ikke bruker Kerberos-baserte sikkerhetsfunksjoner, er det viktig å sikre at bare de maskinene som har lov til å bruke NFS kan koble til de ulike nødvendige RPC-tjenerne, fordi den grunnleggende protokollen har tillit til data som mottas fra nettverket. Brannmuren må også blokkere <span
              class="emphasis"><em>IP spoofing</em></span> for å hindre at en utenforstående maskin opptrer som en på innsiden, og at tilgangen til de riktige portene blir begrenset til maskinene som er ment å skulle ha tilgang til NFS-delinger.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DET GRUNNLEGGENDE</em></span> RPC</strong></p></div></div></div><div
              class="para">
				RPC (<span
                class="emphasis"><em>Remote Procedure Call</em></span>) er en Unix-standard for eksterne tjenester. NFS er en slik tjeneste.
			</div><a
              id="id-1.14.7.10.4.3"
              class="indexterm"></a><a
              id="id-1.14.7.10.4.4"
              class="indexterm"></a><div
              class="para">
				RPC-tjenester registrerer til en katalog kjent som <span
                class="emphasis"><em>portmapper</em></span>. En klient som ønsker NFS-forespørsel, adresserer først til <span
                class="emphasis"><em>portmapper</em></span> (på port 111, enten TCP eller UDP), og ber om NFS-tjeneren; svaret nevner vanligvis port 2049 (standard for NFS). Ikke alle RPC-tjenester bruker nødvendigvis en fast port.
			</div></div><div
            class="para">
				Eldre versjoner av protokollen krevde andre RPC-tjenester som brukte dynamisk tildelte porter. Heldigvis, med NFS versjon 4, er bare port 2049 (for NFS) og 111 (for portmapper) nødvendig, og de er dermed lette å sikre med brannmur.
			</div><a
            id="id-1.14.7.10.6"
            class="indexterm"></a></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.14.7.11"></a>11.4.2. NFS-tjener</h3></div></div></div><div
            class="para">
				NFS er en del av Linux-kjernen; i kjerner som leveres av Debian er den med som en kjernemodul. Hvis NFS-tjeneren skal kjøres automatisk ved oppstart, skal <span
              class="pkg pkg">nfs-kernel-server</span>-pakken installeres; Den inneholder de relevante oppstartsskriptene.
			</div><div
            class="para">
				NFS-tjenerens konfigurasjonsfil, <code
              class="filename">/etc/exports</code>, viser kataloger som er gjort tilgjengelig via nettverket (<span
              class="emphasis"><em>eksportert</em></span>). For hver NFS-deling, er det bare den gitte listen over maskiner som får tilgang. Mer finkornet adgangskontroll kan oppnås med et par alternativer. Syntaksen for denne filen er ganske enkel:
			</div><a
            id="id-1.14.7.11.4"
            class="indexterm"></a><a
            id="id-1.14.7.11.5"
            class="indexterm"></a><pre
            class="programlisting">
/directory/to/share machine1(option1,option2,...) machine2(...) ...
</pre><div
            class="para">
				Merk at med NFSv4 må alle eksporterte kataloger være del av et enkelt hierarki, og at rotkatalogen i dette hierarkiet må eksporteres og identifiseres med alternativet <code
              class="literal">fsid=0</code>, eller <code
              class="literal">fsid=root</code>.
			</div><div
            class="para">
				Hver maskin kan identifiseres enten ved sitt DNS-navn eller sin IP-adresse. Hele sett med maskiner kan også angis ved hjelp av enten en syntaks som <code
              class="literal">*.falcot.com</code>, eller et IP-adresseområde som <code
              class="literal">192.168.0.0/255.255.255.0</code>, eller <code
              class="literal">192.168.0.0/24</code>.
			</div><div
            class="para">
				Kataloger er som standard gjort tilgjengelig som skrivebeskyttet (eller med <code
              class="literal">ro</code>-valget). Valget <code
              class="literal">rw</code> tillater lese- og skriveadgang. NFS-klienten kobler vanligvis til fra en port forbeholdt rot (med andre ord, under 1024). Denne begrensningen kan oppheves av <code
              class="literal">insecure</code>-valget, (<code
              class="literal">secure</code>-alternativet er implisitt, men kan gjøres eksplisitt hvis det er nødvendig for klarhetens skyld).
			</div><a
            id="id-1.14.7.11.10"
            class="indexterm"></a><div
            class="para">
				Som standard svarer tjeneren bare på en NFS-spørring når den igangværende diskoperasjonen er fullført (<code
              class="literal">sync</code>-valget); dette kan oppheves med <code
              class="literal">async</code>-valget. Asynkron innskriving øker ytelsen litt, men de reduserer påliteligheten siden det er en risiko for tap av data i tilfelle tjeneren krasjer mellom godkjenningen av innskrivingen, og den faktiske innskrivingen på disken. Siden standardverdien nettopp ble endret (i forhold til den historiske verdien av NFS), er en eksplisitt innstilling å anbefale.
			</div><div
            class="para">
				For å ikke gi rot-tilgang til filsystemet til noen NFS-klient er alle spørsmål som tilsynelatende kommer fra en rotbruker vurdert av tjeneren som å komme fra <code
              class="literal">nobody</code>-brukeren. Dette samsvarer med <code
              class="literal">root_squash</code>-alternativet, og er aktivert som standard. Alternativet <code
              class="literal">no_root_squash</code>, som deaktiverer denne atferden, er risikabel, og bør bare brukes i kontrollerte omgivelser. <code
              class="literal">anonuid=<em
                class="replaceable">uid</em></code> og <code
              class="literal">anongid=<em
                class="replaceable">gid</em></code>-alternativene tillater å spesifisere en annen falsk bruker til å bli brukt i stedet for UID/GID 65534 (som tilsvarer bruker <code
              class="literal">nobody</code> og gruppe <code
              class="literal">nogroup</code>).
			</div><div
            class="para">
				Med NFSv4 kan du legge til et <code
              class="literal">sec</code>-valg for å indikere det sikkerhetsnivået du ønsker: <code
              class="literal">sec=sys</code> er som standard uten noen sikkerhetsegenskaper, <code
              class="literal">sec=krb5</code> aktiverer bare autentisering, <code
              class="literal">sec=krb5i</code> legger til integritetsbeskyttelse, og <code
              class="literal">sec=krb5p</code> er det mest komplette nivået, og inkluderer personvern (med datakryptering). For at dette skal virke, trenger du et Kerberos oppsett som virker (den tjenesten er ikke dekket i denne boken).
			</div><div
            class="para">
				Det er også andre valgmuligheter. De er dokumentert i manualsiden <span
              class="citerefentry"><span
                class="refentrytitle">exports</span>(5)</span>.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>VÆR VARSOM</em></span> Første innstallasjon</strong></p></div></div></div><div
              class="para">
				Oppstartsskriptet <code
                class="filename">/etc/init.d/nfs-kernel-server</code> starter bare tjeneren hvis <code
                class="filename">/etc/exports</code> lister en eller flere gyldige NFS-deler. Ved første gangs konfigurering, når denne filen er redigert for å inneholde gyldige oppføringer, må NFS-tjeneren derfor startes med følgende kommando:
			</div><pre
              class="screen">
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>service nfs-kernel-server start</code></strong></pre></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.14.7.12"></a>11.4.3. NFS-klient</h3></div></div></div><a
            id="id-1.14.7.12.2"
            class="indexterm"></a><a
            id="id-1.14.7.12.3"
            class="indexterm"></a><div
            class="para">
				Som med andre filsystemer, å integrere en NFS-del inn i systemhierarkiet krever montering. Siden dette filsystemet har sine særegenheter, kreves noen justeringer i syntaksen til <code
              class="command">mount</code>-kommandoen, og i <code
              class="filename">/etc/fstab</code>-filen.
			</div><div
            class="example"><a
              id="id-1.14.7.12.5"></a><p
              class="title"><strong>Eksempel 11.22. Å montere manuelt med <code
                  class="command">mount</code>-kommandoen</strong></p><div
              class="example-contents"><pre
                class="screen">
          <code
                  class="computeroutput"># </code><strong
                  class="userinput"><code>mount -t nfs4 -o rw,nosuid arrakis.internal.falcot.com:/shared /srv/shared</code></strong></pre></div></div><div
            class="example"><a
              id="id-1.14.7.12.6"></a><p
              class="title"><strong>Eksempel 11.23. NFS-inngang i <code
                  class="filename">/etc/fstab</code>-filen</strong></p><div
              class="example-contents"><pre
                class="programlisting">
arrakis.internal.falcot.com:/shared /srv/shared nfs4 rw,nosuid 0 0
</pre></div></div><div
            class="para">
				Inngangen ovenfor monterer, ved systemoppstart, <code
              class="filename">/shared/</code> NFS-mappen fra <code
              class="literal">arrakis</code>-tjeneren til den lokale <code
              class="filename">/srv/shared/</code>-mappen. Lese- og skriveadgang kreves (derav <code
              class="literal">rw</code>-parameteret). Valget <code
              class="literal">nosuid</code> er et beskyttelsestiltak som sletter alle <code
              class="literal">setuid</code>, eller <code
              class="literal">setgid</code>-bit fra programmer lagret i delingen. Hvis NFS-delingen kun er ment til å lagre dokumenter, er et annet anbefalt alternativ <code
              class="literal">noexec</code>, som hindrer kjøring av programmer som er lagret i delingen. Legg merke til at på tjeneren er ikke <code
              class="filename">shared</code>-mappen under NFSv4 root export (for eksempel <code
              class="filename">/export/shared</code>), en toppnivåmappe.
			</div><div
            class="para">
				Manualsiden <span
              class="citerefentry"><span
                class="refentrytitle">nfs</span>(5)</span> beskriver alle valgmulighetene noe mer detaljert.
			</div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.ftp-file-server.html"><strong>Forrige</strong>11.3. FTP-filtjener</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Opp</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Hjem</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.windows-file-server-with-samba.html"><strong>Neste</strong>11.5. Setting Up Windows Shares with Samba</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.nfs-file-server.html">ar-MA</a></li><li><a
              href="../da-DK/sect.nfs-file-server.html">da-DK</a></li><li><a
              href="../de-DE/sect.nfs-file-server.html">de-DE</a></li><li><a
              href="../el-GR/sect.nfs-file-server.html">el-GR</a></li><li><a
              href="../en-US/sect.nfs-file-server.html">en-US</a></li><li><a
              href="../es-ES/sect.nfs-file-server.html">es-ES</a></li><li><a
              href="../fa-IR/sect.nfs-file-server.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.nfs-file-server.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.nfs-file-server.html">hr-HR</a></li><li><a
              href="../id-ID/sect.nfs-file-server.html">id-ID</a></li><li><a
              href="../it-IT/sect.nfs-file-server.html">it-IT</a></li><li><a
              href="../ja-JP/sect.nfs-file-server.html">ja-JP</a></li><li><a
              href="../ko-KR/sect.nfs-file-server.html">ko-KR</a></li><li><a
              href="../nb-NO/sect.nfs-file-server.html">nb-NO</a></li><li><a
              href="../pl-PL/sect.nfs-file-server.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.nfs-file-server.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.nfs-file-server.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.nfs-file-server.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.nfs-file-server.html">tr-TR</a></li><li><a
              href="../vi-VN/sect.nfs-file-server.html">vi-VN</a></li><li><a
              href="../zh-CN/sect.nfs-file-server.html">zh-CN</a></li><li><a
              href="../zh-TW/sect.nfs-file-server.html">zh-TW</a></li></ul></div></body></html>
