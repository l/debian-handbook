<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">第 5 章 包管理系统：工具和基本原则</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.1" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-zh-CN-1.0-1" /><meta
        name="keywords"
        content="二进制包, 源码包, dpkg, 依赖, 冲突" /><link
        rel="home"
        href="index.html"
        title="Debian 管理员手册" /><link
        rel="up"
        href="index.html"
        title="Debian 管理员手册" /><link
        rel="prev"
        href="sect.after-first-boot.html"
        title="4.3. 在首次启动之后" /><link
        rel="next"
        href="sect.package-meta-information.html"
        title="5.2. 软件包元信息" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/zh-CN/packaging-system.html" /></head><body
      class="draft "><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="http://debian-handbook.info"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.after-first-boot.html"><strong>上一页</strong></a></li><li
          class="home">Debian 管理员手册</li><li
          class="next"><a
            accesskey="n"
            href="sect.package-meta-information.html"><strong>下一页</strong></a></li></ul><div
        xml:lang="zh-CN"
        class="chapter"
        lang="zh-CN"><div
          class="titlepage"><div><div><h1
                class="title"><a
                  id="packaging-system"></a>第 5 章 包管理系统：工具和基本原则</h1></div></div></div><div
          class="toc"><dl
            class="toc"><dt><span
                class="section"><a
                  href="packaging-system.html#sect.binary-package-structure">5.1. 二进制包的结构</a></span></dt><dt><span
                class="section"><a
                  href="sect.package-meta-information.html">5.2. 软件包元信息</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.package-meta-information.html#sect.control">5.2.1. 描述：<code
                        class="filename">control</code> 文件</a></span></dt><dt><span
                    class="section"><a
                      href="sect.package-meta-information.html#idm140476756586944">5.2.2. 配置脚本</a></span></dt><dt><span
                    class="section"><a
                      href="sect.package-meta-information.html#sect.conffiles">5.2.3. 校验，配置文件列表</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.source-package-structure.html">5.3. 源软件包的结构</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.source-package-structure.html#idm140476756455136">5.3.1. 格式</a></span></dt><dt><span
                    class="section"><a
                      href="sect.source-package-structure.html#idm140476756401280">5.3.2. Debian中的使用</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.manipulating-packages-with-dpkg.html">5.4. 通过<code
                    class="command">dpkg</code>来操作软件包</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.manipulating-packages-with-dpkg.html#idm140476756388960">5.4.1. 安装软件包</a></span></dt><dt><span
                    class="section"><a
                      href="sect.manipulating-packages-with-dpkg.html#idm140476756352624">5.4.2. 软件包移除</a></span></dt><dt><span
                    class="section"><a
                      href="sect.manipulating-packages-with-dpkg.html#idm140476756339456">5.4.3. Querying <code
                        class="command">dpkg</code>'s Database and Inspecting <code
                        class="filename">.deb</code> Files</a></span></dt><dt><span
                    class="section"><a
                      href="sect.manipulating-packages-with-dpkg.html#idm140476756289792">5.4.4. <code
                        class="command">dpkg</code>的日志文件</a></span></dt><dt><span
                    class="section"><a
                      href="sect.manipulating-packages-with-dpkg.html#sect.multi-arch">5.4.5. Multi-Arch Support</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.coexistence-with-other-packaging-systems.html">5.5. 与其它软件包共存</a></span></dt></dl></div><div
          class="highlights"><div
            class="para">
		作为 Debian 系统管理员，你经常地要处理 <code
              class="filename">.deb</code> 包，因为它们包含一致的功能单元（应用程序、文档等），使得安装和维护更容易。所以了解它们是什么及如何使用它们是个好主意。
	</div></div><div
          class="para">
		本章介绍了“二进制”和“源码”包的结构和内容。前者是 <code
            class="filename">.deb</code> 文件，可以用 <code
            class="command">dpkg</code> 命令直接处理；而后者则包含程序的源代码，以及创建二进制包的说明。
	</div><div
          class="section"><div
            class="titlepage"><div><div><h2
                  class="title"><a
                    id="sect.binary-package-structure"></a>5.1. 二进制包的结构</h2></div></div></div><a
            id="idm140476764163584"
            class="indexterm"></a><a
            id="idm140476757161344"
            class="indexterm"></a><div
            class="para">
			The Debian package format is designed so that its content may be extracted on any Unix system that has the classic commands <code
              class="command">ar</code>, <code
              class="command">tar</code>, and <code
              class="command">gzip</code> (sometimes <code
              class="command">xz</code> or <code
              class="command">bzip2</code>). This seemingly trivial property is important for portability and disaster recovery.
		</div><div
            class="para">
			Imagine, for example, that you mistakenly deleted the <code
              class="command">dpkg</code> program, and that you could thus no longer install Debian packages. <code
              class="command">dpkg</code> being a Debian package itself, it would seem your system would be done for... Fortunately, you know the format of a package and can therefore download the <code
              class="filename">.deb</code> file of the <span
              class="pkg pkg">dpkg</span> package and install it manually (see sidebar <a
              class="xref"
              href="packaging-system.html#sidebar.dpkg-apt-ar"><span
                class="emphasis"><em>工具</em></span> <code
                class="command">dpkg</code>、<code
                class="command">APT</code> 和 <code
                class="command">ar</code></a>). If by some misfortune one or more of the programs <code
              class="command">ar</code>, <code
              class="command">tar</code> or <code
              class="command">gzip</code>/<code
              class="command">xz</code>/<code
              class="command">bzip2</code> have disappeared, you will only need to copy the missing program from another system (since each of these operates in a completely autonomous manner, without dependencies, a simple copy will suffice). If your system suffered some even more outrageous fortune, and even these don't work (maybe the deepest system libraries are missing?), you should try the static version of <code
              class="command">busybox</code>, which is even more self-contained, and provides subcommands such as <code
              class="command">busybox ar</code>, <code
              class="command">busybox tar</code> and <code
              class="command">busybox gunzip</code>.
		</div><div
            class="sidebar"><a
              id="sidebar.dpkg-apt-ar"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>工具</em></span> <code
                        class="command">dpkg</code>、<code
                        class="command">APT</code> 和 <code
                        class="command">ar</code></strong></p></div></div></div><a
              id="idm140476763552448"
              class="indexterm"></a><a
              id="idm140476763551328"
              class="indexterm"></a><a
              id="idm140476763550208"
              class="indexterm"></a><div
              class="para">
			<code
                class="command">dpkg</code> 是处理 <code
                class="filename">.deb</code> 文件的命令，尤其是解压、分析和解包它们。
		</div><div
              class="para">
			<code
                class="command">APT</code> 是一组允许对系统进行高级的修改的程序：安装或者删除一个软件包（并且保持依赖关系满足），更新系统，列出可用的软件包等。
		</div><div
              class="para">
			<a
                id="idm140476766415440"
                class="indexterm"></a> As for the <code
                class="command">ar</code> program, it allows handling files of the same name: <code
                class="command">ar t <em
                  class="replaceable">archive</em></code> displays the list of files contained in such an archive, <code
                class="command">ar x <em
                  class="replaceable">archive</em></code> extracts the files from the archive into the current working directory, <code
                class="command">ar d <em
                  class="replaceable">archive</em> <em
                  class="replaceable">file</em></code> deletes a file from the archive, etc. Its man page (<span
                class="citerefentry"><span
                  class="refentrytitle">ar</span>(1)</span>) documents all its other features. <code
                class="command">ar</code> is a very rudimentary tool that a Unix administrator would only use on rare occasions, but admins routinely use <code
                class="command">tar</code>, a more evolved archive and file management program. This is why it is easy to restore <code
                class="command">dpkg</code> in the event of an erroneous deletion. You would only have to download the Debian package and extract the content from the <code
                class="filename">data.tar.gz</code> archive in the system's root (<code
                class="filename">/</code>):
		</div><pre
              class="screen">
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>ar x dpkg_1.17.23_amd64.deb</code></strong>
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>tar -C / -p -xzf data.tar.gz</code></strong></pre></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>基础知识</em></span> Man 手册注记</strong></p></div></div></div><div
              class="para">
			初学者可能会在看到“<span
                class="citerefentry"><span
                  class="refentrytitle">ar</span>(1)</span>”这样的文字注记时感到疑惑。这通常是个简写，它表示指向 man 手册第一类中标题是 <code
                class="literal">ar</code> 的页面。
		</div><div
              class="para">
			有时这种注记也用来避免歧义，比如要区分清楚是 <code
                class="command">printf</code> 命令，可以用 <span
                class="citerefentry"><span
                  class="refentrytitle">printf</span>(1)</span> 来指明，如果是 C 语言里的 <code
                class="function">printf</code> 函数，就可以用 <span
                class="citerefentry"><span
                  class="refentrytitle">printf</span>(3)</span> 来引用。
		</div><div
              class="para">
			<a
                class="xref"
                href="solving-problems.html">第 7 章 <em>问题的解决与相关信息的检索</em></a> discusses manual pages in further detail (see <a
                class="xref"
                href="solving-problems.html#sect.manual-pages">第 7.1.1 节 “手册页面”</a>).
		</div></div><div
            class="para">
			来看看 <code
              class="filename">.deb</code> 文件的内容：
		</div><pre
            class="screen"><code
              class="computeroutput">$ </code><strong
              class="userinput"><code>ar t dpkg_1.17.23_amd64.deb</code></strong>
<code
              class="computeroutput">debian-binary
control.tar.gz
data.tar.gz
$ </code><strong
              class="userinput"><code>ar x dpkg_1.17.23_amd64.deb</code></strong>
<code
              class="computeroutput">$ </code><strong
              class="userinput"><code>ls</code></strong>
<code
              class="computeroutput">control.tar.gz  data.tar.gz  debian-binary  dpkg_1.16.10_i386.deb
$ </code><strong
              class="userinput"><code>tar tzf data.tar.gz | head -n 15</code></strong>
<code
              class="computeroutput">./
./var/
./var/lib/
./var/lib/dpkg/
./var/lib/dpkg/parts/
./var/lib/dpkg/info/
./var/lib/dpkg/alternatives/
./var/lib/dpkg/updates/
./etc/
./etc/logrotate.d/
./etc/logrotate.d/dpkg
./etc/dpkg/
./etc/dpkg/dpkg.cfg.d/
./etc/dpkg/dpkg.cfg
./etc/alternatives/
$ </code><strong
              class="userinput"><code>tar tzf control.tar.gz</code></strong>
<code
              class="computeroutput">./
./conffiles
./postinst
./md5sums
./prerm
./preinst
./control
./postrm
$ </code><strong
              class="userinput"><code>cat debian-binary</code></strong>
<code
              class="computeroutput">2.0</code></pre><div
            class="para">
			如你所见， Debian 包的 <code
              class="command">ar</code> 存档格式由三个文件组成：
		</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
					<code
                    class="filename">debian-binary</code>. This is a text file which simply indicates the version of the <code
                    class="filename">.deb</code> file used (in 2015: version 2.0).
				</div></li><li
                class="listitem"><div
                  class="para">
					<code
                    class="filename">control.tar.gz</code>. This archive file contains all of the available meta-information, like the name and version of the package. Some of this meta-information allows package management tools to determine if it is possible to install or uninstall it, for example according to the list of packages already on the machine.
				</div></li><li
                class="listitem"><div
                  class="para">
					<code
                    class="filename">data.tar.gz</code>，这个存档文件包含所有要被从软件包里解压缩出来的文件；这是可执行文件、文档等存储的地方。有些软件包可能会使用其它压缩格式，那样的话文件名会有所不同（bzip2 是 <code
                    class="filename">data.tar.bz2</code>，XZ 是 <code
                    class="filename">data.tar.xz</code> for XZ，LZMA 是 <code
                    class="filename">data.tar.lzma</code>）。
				</div></li></ul></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.after-first-boot.html"><strong>上一页</strong>4.3. 在首次启动之后</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>上一级</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>起始页</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.package-meta-information.html"><strong>下一页</strong>5.2. 软件包元信息</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/packaging-system.html">ar-MA</a></li><li><a
              href="../da-DK/packaging-system.html">da-DK</a></li><li><a
              href="../de-DE/packaging-system.html">de-DE</a></li><li><a
              href="../el-GR/packaging-system.html">el-GR</a></li><li><a
              href="../en-US/packaging-system.html">en-US</a></li><li><a
              href="../es-ES/packaging-system.html">es-ES</a></li><li><a
              href="../fa-IR/packaging-system.html">fa-IR</a></li><li><a
              href="../fr-FR/packaging-system.html">fr-FR</a></li><li><a
              href="../hr-HR/packaging-system.html">hr-HR</a></li><li><a
              href="../id-ID/packaging-system.html">id-ID</a></li><li><a
              href="../it-IT/packaging-system.html">it-IT</a></li><li><a
              href="../ja-JP/packaging-system.html">ja-JP</a></li><li><a
              href="../pl-PL/packaging-system.html">pl-PL</a></li><li><a
              href="../pt-BR/packaging-system.html">pt-BR</a></li><li><a
              href="../ro-RO/packaging-system.html">ro-RO</a></li><li><a
              href="../ru-RU/packaging-system.html">ru-RU</a></li><li><a
              href="../tr-TR/packaging-system.html">tr-TR</a></li><li><a
              href="../zh-CN/packaging-system.html">zh-CN</a></li></ul></div></body></html>
