<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">5.3. 源软件包的结构</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-zh-CN-1.0-1" /><meta
        name="keywords"
        content="二进制包, 源码包, dpkg, 依赖, 冲突" /><link
        rel="home"
        href="index.html"
        title="Debian 管理员手册" /><link
        rel="up"
        href="packaging-system.html"
        title="第 5 章 包管理系统：工具和基本原则" /><link
        rel="prev"
        href="sect.package-meta-information.html"
        title="5.2. 软件包元信息" /><link
        rel="next"
        href="sect.manipulating-packages-with-dpkg.html"
        title="5.4. 通过dpkg来操作软件包" /><meta
        name="viewport"
        content="width=device-width, initial-scale=1" /><meta
        name="flattr:id"
        content="4pz9jq" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/zh-CN/sect.source-package-structure.html" /></head><body><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="../../"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.package-meta-information.html"><strong>上一页</strong></a></li><li
          class="home">Debian 管理员手册</li><li
          class="next"><a
            accesskey="n"
            href="sect.manipulating-packages-with-dpkg.html"><strong>下一页</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.source-package-structure"></a>5.3. 源软件包的结构</h2></div></div></div><a
          id="id-1.8.7.2"
          class="indexterm"></a><a
          id="id-1.8.7.3"
          class="indexterm"></a><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.8.7.4"></a>5.3.1. 格式</h3></div></div></div><a
            id="id-1.8.7.4.2"
            class="indexterm"></a><a
            id="id-1.8.7.4.3"
            class="indexterm"></a><a
            id="id-1.8.7.4.4"
            class="indexterm"></a><a
            id="id-1.8.7.4.5"
            class="indexterm"></a><div
            class="para">
				A source package is usually comprised of three files, a <code
              class="filename">.dsc</code>, a <code
              class="filename">.orig.tar.gz</code>, and a <code
              class="filename">.debian.tar.xz</code> (or <code
              class="filename">.diff.gz</code>). They allow creation of binary packages (<code
              class="filename">.deb</code> files described above) from the source code files of the program, which are written in a programming language.
			</div><div
            class="para">
				<code
              class="filename">.dsc</code> (Debian Source Control) 文件是包括 RFC 2822 标头 (如同 <code
              class="filename">control</code> 文件于 <a
              class="xref"
              href="sect.package-meta-information.html#sect.control">第 5.2.1 节 “描述：<code
                class="filename">control</code> 文件”</a>) 的简短文本档，描述原始软件包及包括的其他文件。由维护者签署，保证其真实性。详情见 <a
              class="xref"
              href="sect.package-authentication.html">第 6.5 节 “检查软件包真伪”</a>。
			</div><div
            class="example"><a
              id="id-1.8.7.4.8"></a><p
              class="title"><strong>例 5.1. 一个<code
                  class="filename">.dsc</code> 文件</strong></p><div
              class="example-contents"><pre
                class="programlisting">
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 3.0 (quilt)
Source: zim
Binary: zim
Architecture: all
Version: 0.65-4
Maintainer: Emfox Zhou &lt;emfox@debian.org&gt;
Uploaders: Raphaël Hertzog &lt;hertzog@debian.org&gt;
Homepage: http://zim-wiki.org
Standards-Version: 3.9.8
Vcs-Browser: https://anonscm.debian.org/cgit/collab-maint/zim.git
Vcs-Git: https://anonscm.debian.org/git/collab-maint/zim.git
Build-Depends: debhelper (&gt;= 9), xdg-utils, python (&gt;= 2.6.6-3~), libgtk2.0-0 (&gt;= 2.6), python-gtk2, python-xdg, dh-python
Package-List:
 zim deb x11 optional arch=all
Checksums-Sha1:
 4a9be85c98b7f4397800f6d301428d64241034ce 1899614 zim_0.65.orig.tar.gz
 0ec38c990ec7662205dd0c843bf81f9033906a2e 10332 zim_0.65-4.debian.tar.xz
Checksums-Sha256:
 5442f3334395a2beafc5b9a2bbec2e53e38270d4bad696b5c4053dd51dc1ed96 1899614 zim_0.65.orig.tar.gz
 78271df16aa166dce916b3ff4ecd705ed3a8832e49d3ef0bd8738a4fe8dd2b4f 10332 zim_0.65-4.debian.tar.xz
Files:
 63ab7a2070e6d1d3fb32700a851d7b8b 1899614 zim_0.65.orig.tar.gz
 648559b38e04eaf4f6caa97563c057ff 10332 zim_0.65-4.debian.tar.xz

-----BEGIN PGP SIGNATURE-----
Comment: Signed by Raphael Hertzog

iQEzBAEBCgAdFiEE1823g1EQnhJ1LsbSA4gdq+vCmrkFAlgzZXkACgkQA4gdq+vC
mrnyXAf+M/PzZFjqk6Hvv1QSbocIDZ3bEqRjVpNLApubsPsEZZT6yw9vypzNE2hZ
/BbLPa0Ntbhew4U+SJpuujV7VnLs9mZgOFuKRHKWYQBQ+oxw+gtM6iePwVj58aP/
LW7K5gE428ohMdjIkf42Lz4Fve3dVPgPLIzQxRZ87N6OKqmS81M6/RRIF3TS/gJp
CwpN1yifCfQs46gxL5/CgA4uhI8taz+g+8ZDd6fL5BQeFuNsgplY4QL1uGno3F7G
VY7WZhM601Re2ePnv+6vjh8kDWMjZhfB4RJy0+hHezuoVGKljyaxc1O4P/fxvXus
CEETju6cAE/HgDubDXDqExMwEd4odA==
=HUvj
-----END PGP SIGNATURE-----</pre></div></div><a
            id="id-1.8.7.4.9"
            class="indexterm"></a><div
            class="para">
				需要注意的是源码包也有依赖性（<code
              class="literal">编译-依赖</code>），和那些二进制包依赖完全不同，因为它们需要设置编译软件所需工具的选项后，再来构建二进制包。
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>当心</em></span> 不同的命名空间</strong></p></div></div></div><div
              class="para">
				需注意，原始软件包与其产生的可运行软件包间，不需使用对应的名称。每个原始软件包可能产生多个可运行软件包。所以 <code
                class="filename">.dsc</code> 文件有 <code
                class="literal">Source</code> 与 <code
                class="literal">Binary</code> 字段记录原始软件包的名称与其产生的可运行软件包清单。
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>文化</em></span> 为什么要分成几个软件包</strong></p></div></div></div><div
              class="para">
				通常，一个源代码软件包 (对于一个指定软件来说) 可产生多个二进制软件包。分开多个二进制包，可以满足在不同的环境使用 (部分) 软件。对于一个共享库，安装它后，可以让一个于应用程序工作 (如，<span
                class="pkg pkg">libc6</span>)；或者安装后，可以用来开发一个新的程序 (<span
                class="pkg pkg">libc6-dev</span> 就是这样的软件包)。在客户端-服务端服务里发现同样的逻辑，在一部机器安装服务端的内容同时在另部机器安装客户端的内容 (例如： <span
                class="pkg pkg">openssh-server</span> 与 <span
                class="pkg pkg">openssh-client</span>)。
			</div><div
              class="para">
				一样频繁的是，在一个专用的软件包提供文档：用户可以不依赖软件包而独立安装文档包，并且可以在任何时候选择删除掉以节省磁盘空间。此外，这也节省了 Debian 镜像的磁盘空间，因为在所有的架构中（而不是在每个架构中都复制一个一样的文档软件包）将共享这个文档软件包。
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>洞察</em></span>不同格式的源码包</strong></p></div></div></div><div
              class="para">
				本来只有一个原始的软件包格式，像<code
                class="literal">1.0</code>这样的格式，它关联了<code
                class="filename">.orig.tar.gz</code>和<code
                class="filename">.diff.gz</code>“Debian化”的补丁（还有一个变种，由一个单一的<code
                class="filename">.tar.gz</code>归档，当<code
                class="filename">.orig.tar.gz</code>不可用时它会自动使用。）.
			</div><div
              class="para">
				Since Debian <span
                class="distribution distribution">Squeeze</span>, Debian developers have the option to use new formats that correct many problems of the historical format. Format <code
                class="literal">3.0 (quilt)</code> can combine multiple upstream archives in the same source package: in addition to the usual <code
                class="filename">.orig.tar.gz</code>, supplementary <code
                class="filename">.orig-<em
                  class="replaceable">component</em>.tar.gz</code> archives can be included. This is useful with software that is distributed in several upstream components but for which a single source package is desired. These archives can also be compressed with <code
                class="command">xz</code> rather than <code
                class="command">gzip</code>, which saves disk space and network resources. Finally, the monolithic patch, <code
                class="filename">.diff.gz</code> is replaced by a <code
                class="filename">.debian.tar.xz</code> archive containing the compiling instructions and a set of upstream patches contributed by the package maintainer. These last are recorded in a format compatible with <code
                class="command">quilt</code> — a tool that facilitates the management of a series of patches.
			</div></div><div
            class="para">
				<code
              class="filename">.orig.tar.gz</code> 文件包括原开发者提供的源代码。要求 Debian 的软件包维护者不要修改它，以便检查原来的文件与集成后的文件 (比较校验码就知道) 并且尊重其他著者的意愿。
			</div><div
            class="para">
				The <code
              class="filename">.debian.tar.xz</code> contains all of the modifications made by the Debian maintainer, especially the addition of a <code
              class="filename">debian</code> directory containing the instructions to execute to construct a Debian package.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>工具</em></span> 解压缩源码包</strong></p></div></div></div><a
              id="id-1.8.7.4.16.2"
              class="indexterm"></a><a
              id="id-1.8.7.4.16.3"
              class="indexterm"></a><a
              id="id-1.8.7.4.16.4"
              class="indexterm"></a><a
              id="id-1.8.7.4.16.5"
              class="indexterm"></a><div
              class="para">
				使用原始软件包时，您可使用 <code
                class="command">dpkg-source</code> 指令 (从 <span
                class="pkg pkg">dpkg-dev</span> 软件包取得) 解压缩它：
			</div><pre
              class="screen"><code
                class="computeroutput">$ </code><strong
                class="userinput"><code>dpkg-source -x package_0.7-1.dsc</code></strong></pre><div
              class="para">
				可以使用 <code
                class="command">apt-get</code> 下载原始软件包并立即拆包它。然而，这需要使用适当的 <code
                class="literal">deb-src</code> 位于 <code
                class="filename">/etc/apt/sources.list</code> 文件内，(详情见 <a
                class="xref"
                href="apt.html#sect.apt-sources.list">第 6.1 节 “写入<code
                  class="filename">sources.list</code>文件”</a>)。用于列出原始软件包的 “来源” (就是收藏原始软件包的服务器)。
			</div><pre
              class="screen"><code
                class="computeroutput">$ </code><strong
                class="userinput"><code>apt-get source <em
                    class="replaceable">package</em></code></strong></pre></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.8.7.5"></a>5.3.2. Debian 中的使用</h3></div></div></div><div
            class="para">
				Debian 的基础是原始软件包。Debian 所有的软件包都从原始软件包而来，对软件包的修改也是针对原始软件包。运行软件包出了问题后，Debian 维护者修改原始软件包后，再编译为运行软件包。维护者的工作成果都在 Debian 的原始软件包内：您可轻易地回到原始软件包找出源头。
			</div><div
            class="para">
				Debian 服务器收到新版软件包 (原始软件包或运行软件包) 时，原始软件包是最重要的。原始软件包被支持 Debian 的多种架构机器编译。开发者同时送出指定架构 (通常是 i386 或 amd64) 的多个运行软件包，其实一点都不重要，因为可以自动生成该等运行软件包。
			</div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.package-meta-information.html"><strong>上一页</strong>5.2. 软件包元信息</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>上一级</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>起始页</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.manipulating-packages-with-dpkg.html"><strong>下一页</strong>5.4. 通过dpkg来操作软件包</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.source-package-structure.html">ar-MA</a></li><li><a
              href="../da-DK/sect.source-package-structure.html">da-DK</a></li><li><a
              href="../de-DE/sect.source-package-structure.html">de-DE</a></li><li><a
              href="../el-GR/sect.source-package-structure.html">el-GR</a></li><li><a
              href="../en-US/sect.source-package-structure.html">en-US</a></li><li><a
              href="../es-ES/sect.source-package-structure.html">es-ES</a></li><li><a
              href="../fa-IR/sect.source-package-structure.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.source-package-structure.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.source-package-structure.html">hr-HR</a></li><li><a
              href="../id-ID/sect.source-package-structure.html">id-ID</a></li><li><a
              href="../it-IT/sect.source-package-structure.html">it-IT</a></li><li><a
              href="../ja-JP/sect.source-package-structure.html">ja-JP</a></li><li><a
              href="../ko-KR/sect.source-package-structure.html">ko-KR</a></li><li><a
              href="../nb-NO/sect.source-package-structure.html">nb-NO</a></li><li><a
              href="../pl-PL/sect.source-package-structure.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.source-package-structure.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.source-package-structure.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.source-package-structure.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.source-package-structure.html">tr-TR</a></li><li><a
              href="../vi-VN/sect.source-package-structure.html">vi-VN</a></li><li><a
              href="../zh-CN/sect.source-package-structure.html">zh-CN</a></li><li><a
              href="../zh-TW/sect.source-package-structure.html">zh-TW</a></li></ul></div></body></html>
