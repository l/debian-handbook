<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">6.8. 自动升级</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-zh-CN-1.0-1" /><meta
        name="keywords"
        content="高级包管理工具(Advanced Packaging Tool), apt-get, apt-cache, aptitude 更安全的apt, 新立得包管理器, sources.list, apt-cdrom" /><link
        rel="home"
        href="index.html"
        title="Debian 管理员手册" /><link
        rel="up"
        href="apt.html"
        title="第 6 章 维护和更新：APT 工具" /><link
        rel="prev"
        href="sect.regular-upgrades.html"
        title="6.7. 保持系统在最新状态" /><link
        rel="next"
        href="sect.searching-packages.html"
        title="6.9. 搜索软件包" /><meta
        name="viewport"
        content="width=device-width, initial-scale=1" /><meta
        name="flattr:id"
        content="4pz9jq" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/zh-CN/sect.automatic-upgrades.html" /></head><body><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="../../"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.regular-upgrades.html"><strong>上一页</strong></a></li><li
          class="home">Debian 管理员手册</li><li
          class="next"><a
            accesskey="n"
            href="sect.searching-packages.html"><strong>下一页</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.automatic-upgrades"></a>6.8. 自动升级</h2></div></div></div><a
          id="id-1.9.17.2"
          class="indexterm"></a><a
          id="id-1.9.17.3"
          class="indexterm"></a><div
          class="para">
			Falcot Corp 虽有多部电脑但人力有限，其管理者试图尽可能地自动升级。必须在无人为介入情况下处理升级事宜。
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.9.17.5"></a>6.8.1. 配置 <code
                    class="command">dpkg</code></h3></div></div></div><div
            class="para">
				如稍早提过的 (见专栏 <a
              class="xref"
              href="sect.package-meta-information.html#sidebar.questions-conffiles"><span
                class="emphasis"><em>更进一步</em></span> 避免配置文件问题</a>)，<code
              class="command">dpkg</code> 可在不必确认的情况下取代原来的配置档 (以 <code
              class="literal">--force-confdef --force-confold</code> 选项运行该功能)。然而，有三个交互来源：有些来自 APT 自身、有些由 <code
              class="command">debconf</code> 处理、还有的是由软件包配置脚本运行。
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.9.17.6"></a>6.8.2. 配置 APT</h3></div></div></div><div
            class="para">
				APT 的例子很简单：<code
              class="literal">-y</code> 选项 (或 <code
              class="literal">--assume-yes</code>) 告诉 APT 面对所有的问题时，答案都是 “yes”。
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.9.17.7"></a>6.8.3. 配置 <code
                    class="command">debconf</code></h3></div></div></div><div
            class="para">
				<code
              class="command">debconf</code> 需要较详细的说明。此程序原本的设计就是控制给用户看到的相关性及数量，以及显示的方法。问题需有最小的优先权；拥有最小优先权以上的问题才显示。<code
              class="command">debconf</code> 缺省的答案 (由软件包维护者设置) 会略过。
			</div><div
            class="para">
				其他的相关配置元素是前端用到的接口。若选择 <code
              class="literal">noninteractive</code>，就停用所有的用户交互。若软件包试图显示信息性说明，则以电子邮件送给管理者。
			</div><div
            class="para">
				配置 <code
              class="command">debconf</code> 时，用到 <code
              class="command">dpkg-reconfigure</code> 工具，它是来自 <span
              class="pkg pkg">debconf</span> 软件包；相关的命令是 <code
              class="command">dpkg-reconfigure debconf</code>。配置值可能是在需要时暂时取代的环境变量 (例如，<code
              class="varname">DEBIAN_FRONTEND</code> 控制接口，如同在 <span
              class="citerefentry"><span
                class="refentrytitle">debconf</span>(7)</span> 手册页面所述)。
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.9.17.8"></a>6.8.4. 处理命令行接口</h3></div></div></div><div
            class="para">
				最后一个交互来源，以及最难摆脱的，是 <code
              class="command">dpkg</code> 运行的配置脚本。不幸的是，没有标准的解法且没有较佳的答案。
			</div><div
            class="para">
				通常的做法是，把标准的输入由空白内容的 <code
              class="filename">/dev/null</code> 文件转向给 <code
              class="command"><em
                class="replaceable">命令</em> &lt;/dev/null</code>，或由新的键入字符串取代。以上的方法都不是 100 % 可靠，但它们可以转至缺省的答案，因为大部分的脚本已考量到无默认值的答案。
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="id-1.9.17.9"></a>6.8.5. 神奇的组合</h3></div></div></div><div
            class="para">
				把前述的元素组合起来，就可能设计出一个可处理自动升级的小而可靠脚本。
			</div><div
            class="example"><a
              id="example.non-interactive-upgrade"></a><p
              class="title"><strong>例 6.4. 无交互升级脚本</strong></p><div
              class="example-contents"><pre
                class="programlisting">export DEBIAN_FRONTEND=noninteractive
yes '' | apt-get -y -o DPkg::options::="--force-confdef" -o DPkg::options::="--force-confold" dist-upgrade</pre></div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>实务</em></span> Falcot Corp 个案</strong></p></div></div></div><div
              class="para">
				Falcot 公司采用异质系统电脑，运行多种功能。管理者必须为每部电脑挑选最适合的解决方案。
			</div><div
              class="para">
				In practice, the servers running <span
                class="distribution distribution">Stretch</span> are configured with the “miracle combination” above, and are kept up to date automatically. Only the most critical servers (the firewalls, for instances) are set up with <code
                class="command">apticron</code>, so that upgrades always happen under the supervision of an administrator.
			</div><div
              class="para">
				The office workstations in the administrative services also run <span
                class="distribution distribution">Stretch</span>, but they are equipped with <span
                class="pkg pkg">gnome-packagekit</span>, so that users trigger the upgrades themselves. The rationale for this decision is that if upgrades happen without an explicit action, the behavior of the computer might change unexpectedly, which could cause confusion for the main users.
			</div><div
              class="para">
				在实验室里，有些安装 <span
                class="distribution distribution">测试版</span> — 就是使用最新版的软件 — 的电脑也不会自动更新。管理者必须配置 APT 才能更新它们；决定更新时 (手动)，列出重新加载软件包清单并避免下载繁琐的部件，管理者就能专注在真正有用的部件。
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.regular-upgrades.html"><strong>上一页</strong>6.7. 保持系统在最新状态</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>上一级</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>起始页</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.searching-packages.html"><strong>下一页</strong>6.9. 搜索软件包</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.automatic-upgrades.html">ar-MA</a></li><li><a
              href="../da-DK/sect.automatic-upgrades.html">da-DK</a></li><li><a
              href="../de-DE/sect.automatic-upgrades.html">de-DE</a></li><li><a
              href="../el-GR/sect.automatic-upgrades.html">el-GR</a></li><li><a
              href="../en-US/sect.automatic-upgrades.html">en-US</a></li><li><a
              href="../es-ES/sect.automatic-upgrades.html">es-ES</a></li><li><a
              href="../fa-IR/sect.automatic-upgrades.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.automatic-upgrades.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.automatic-upgrades.html">hr-HR</a></li><li><a
              href="../id-ID/sect.automatic-upgrades.html">id-ID</a></li><li><a
              href="../it-IT/sect.automatic-upgrades.html">it-IT</a></li><li><a
              href="../ja-JP/sect.automatic-upgrades.html">ja-JP</a></li><li><a
              href="../ko-KR/sect.automatic-upgrades.html">ko-KR</a></li><li><a
              href="../nb-NO/sect.automatic-upgrades.html">nb-NO</a></li><li><a
              href="../pl-PL/sect.automatic-upgrades.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.automatic-upgrades.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.automatic-upgrades.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.automatic-upgrades.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.automatic-upgrades.html">tr-TR</a></li><li><a
              href="../vi-VN/sect.automatic-upgrades.html">vi-VN</a></li><li><a
              href="../zh-CN/sect.automatic-upgrades.html">zh-CN</a></li><li><a
              href="../zh-TW/sect.automatic-upgrades.html">zh-TW</a></li></ul></div></body></html>
