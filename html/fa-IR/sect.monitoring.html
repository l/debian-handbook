<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">12.4. مانیتورینگ</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-fa-IR-1.0-1" /><meta
        name="keywords"
        content="RAID, LVM, FAI, Preseeding, مانیتورینگ, مجازی‌سازی, Xen, LXC" /><link
        rel="home"
        href="index.html"
        title="راهنمای جامع دبیان" /><link
        rel="up"
        href="advanced-administration.html"
        title="فصل 12. مدیریت پیشرفته" /><link
        rel="prev"
        href="sect.automated-installation.html"
        title="12.3. نصب خودکار" /><link
        rel="next"
        href="workstation.html"
        title="فصل 13. رومیزی" /><meta
        name="viewport"
        content="width=device-width, initial-scale=1" /><meta
        name="flattr:id"
        content="4pz9jq" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/fa-IR/sect.monitoring.html" /></head><body
      dir="rtl"><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="../../"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.automated-installation.html"><strong>قبلی</strong></a></li><li
          class="home">راهنمای جامع دبیان</li><li
          class="next"><a
            accesskey="n"
            href="workstation.html"><strong>بعدی</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.monitoring"></a>12.4. مانیتورینگ</h2></div></div></div><div
          class="para">
			مانیتورینگ یک عبارت عمومی است و فعالیت‌های مرتبط با آن اهداف گوناگونی را دنبال می‌کنند: از یک طرف، پیگیری منابع مصرفی فراهم شده توسط ماشین امکان پیشبینی میزان اشباع و بروزرسانی‌های متعاقب با آن را فراهم می‌کند؛ از طرف دیگر، هشدار به مدیر سیستم به محض اینکه یک سرویس از دسترس خارج شود یا به درستی کار نکند به معنی رفع سریع‌تر مشکلات در زمان بروز حادثه است.
		</div><div
          class="para">
			<span
            class="emphasis"><em>Munin</em></span> با نمایش نمودارهای گرافیکی برای مقادیر مختلف از پارامترهای متعدد (حافظه مصرفی، فضای اشغال شده دیسک، بار پردازنده، ترافیک شبکه، بار وب سرور/پایگاه‌داده و از این قبیل) ناحیه اول را پوشش می‌دهد. <span
            class="emphasis"><em>Nagios</em></span> با بررسی مداوم سرویس‌ها و نحوه کارکرد و قابل دسترس بودن آن‌ها، همراه با ارسال پیام به مدیر سیستم با استفاده از کانال‌های مناسب (ایمیل، پیامک و از این قبیل) ناحیه دوم را پوشش می‌دهد. هر دو ابزار ساختاری ماژولار دارند که به توسعه هر یک از آن‌ها و افزودن پارامترها یا سرویس‌های خاص کمک می‌کند.
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>جایگزین</em></span> Zabbix، یک ابزار مانیتورینگ یکپارچه</strong></p></div></div></div><a
            id="id-1.15.7.4.2"
            class="indexterm"></a><div
            class="para">
			با اینکه استفاده از Munin و Nagios بسیار متداول است، آن‌ها تنها بازیکنان موجود در میدان مانیتورینگ نیستند و هر کدام نیز تنها نصف وظایف (نمودار از یک طرف، هشدار از طرف دیگر) را انجام می‌دهند. Zabbix، از طرف دیگر هر دو بخش مانیتورینگ را یکپارچه می‌کند؛ همچنین شامل یک رابط وب به منظور پیکربندی جنبه‌های مختلف مانیتورینگ می‌باشد. طی چند سال گذشته فراز و نشیب‌های بسیاری را پشت سر گذاشته و هم اکنون به عنوان یک رقیب جدی به حساب می‌آید. در سرور مانیتورینگ، می‌توانید <span
              class="pkg pkg">zabbix-server-pgsql</span> یا <span
              class="pkg pkg">zabbix-server-mysql</span> را همراه با <span
              class="pkg pkg">zabbix-frontend-php</span> به منظور دسترسی به رابط وب نصب کنید. در سیستم‌های میزبان که قصد مانیتور کردن آن‌ها را دارید می‌توانید <span
              class="pkg pkg">zabbix-agent</span> را نصب کنید که داده‌ها را به سمت سرور می‌فرستد. <div
              class="url">→ <a
                href="http://www.zabbix.com/">http://www.zabbix.com/</a></div>
		</div></div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>جایگزین</em></span> Icinga، یک fork از Nagios</strong></p></div></div></div><a
            id="id-1.15.7.5.2"
            class="indexterm"></a><div
            class="para">
			به موجب اختلاف نظر در مدل توسعه انتخابی برای Nagios (که توسط یک شرکت کنترل می‌شود)، تعدادی از توسعه‌دهندگان آن را fork و از نام جدید Icinga استفاده کردند. Icinga کماکان ـ تا جای ممکن - با پیکربندی‌ها و پلاگین‌های Nagios سازگار، اما ویژگی‌های اضافی را به آن افزوده است. <div
              class="url">→ <a
                href="http://www.icinga.org/">http://www.icinga.org/</a></div>
		</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.munin"></a>12.4.1. راه‌اندازی Munin</h3></div></div></div><a
            id="id-1.15.7.6.2"
            class="indexterm"></a><div
            class="para">
				هدف Munin مانیتور کردن ماشین‌های متعدد است؛ بنابراین، طبیعی است که از معماری کلاینت/سرور استفاده کند. میزبان مرکزی - یا grapher - داده را از تمام میزبان‌های قابل مانیتور کردن دریافت کرده و نمودارهای گرافیکی تولید می‌کند.
			</div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="id-1.15.7.6.4"></a>12.4.1.1. پیکربندی میزبان‌ها برای مانیتور شدن</h4></div></div></div><div
              class="para">
					اولین گام نصب بسته <span
                class="pkg pkg">munin-node</span> است. فرآیند پس‌زمینه‌ای که توسط این بسته نصب می‌شود به درگاه ۴۹۴۹ گوش کرده و داده‌های دریافتی از پلاگین‌های فعال را ارسال می‌کند. هر پلاگین یک برنامه ساده است که توضیح مرتبط با داده دریافتی همراه با آخرین مقدار بدست آمده را باز می‌گرداند. پلاگین‌ها در مسیر <code
                class="filename">/usr/share/munin/plugins/</code> ذخیره شده‌اند اما تنها آن‌هایی که به صورت پیوند نمادین در <code
                class="filename">/etc/munin/plugins/</code> قرار داشته باشند، استفاده می‌گردند.
				</div><div
              class="para">
					زمانی که بسته نصب شود، مجموعه‌ای از پلاگین‌های فعال بر اساس نرم‌افزار موجود و پیکربندی فعلی میزبان تشخیص داده می‌شوند. اگرچه، این پیکربندی خودکار وابسته به قابلیتی است که هر پلاگین باید فراهم کرده باشد و بهتر است که نتایج را به صورت دستی مرور و ویرایش کنیم. مرور <a
                href="http://gallery.munin-monitoring.org">گالری پلاگین</a> می‌تواند جالب باشد با این وجود که همه پلاگین‌ها ممکن است شامل مستندات جامع نباشند. با این حال، تمام پلاگین‌ها اسکریپت هستند که اکثر آن‌ها ساده بوده و دارای توضیحات خوبی می‌باشند. مرور <code
                class="filename">/etc/munin/plugins/</code> شیوه خوبی برای اطلاع از کارکرد هر پلاگین و تشخیص اینکه کدام یک باید حذف شود می‌باشد. به طور مشابه، فعال‌سازی یک پلاگین جالب در <code
                class="filename">/usr/share/munin/plugins/</code> به سادگی ایجاد پیوند نمادین با استفاده از <code
                class="command">ln -sf /usr/share/munin/plugins/<em
                  class="replaceable">plugin</em> /etc/munin/plugins/</code> می‌باشد. به یاد داشته باشید اگر نام پلاگین به زیرخط یا “_” تمام شود، پلاگین نیازمند یک پارامتر است. این پارامتر باید در نام مرتبط با پیوند نمادین ذخیره‌سازی شود؛ برای نمونه، پلاگین “if_” باید همراه با پیوند نمادین <code
                class="filename">if_eth0</code> فعال‌سازی شود، تا بتواند ترافیک شبکه رابط eth0 را مانیتور کند.
				</div><div
              class="para">
					زمانی که تمام پلاگین‌ها راه‌اندازی شوند، پیکربندی فرآیند پس‌زمینه به منظور تعریف کنترل دسترسی به داده‌های گردآوری شده باید بروزرسانی گردد. اینکار شامل عبارت‌های <code
                class="literal">allow</code> در فایل <code
                class="filename">/etc/munin/munin-node.conf</code> می‌شود. پیکربندی پیشفرض به صورت <code
                class="literal">allow ^127\.0\.0\.1$</code> است که تنها اجازه دسترسی به میزبان محلی را می‌دهد. یک مدیرسیستم معمولا خطی مشابه را همراه با نشانی IP میزبان grapher می‌افزاید، سپس اقدام به راه‌اندازی مجدد فرآیند پس‌زمینه با استفاده از <code
                class="command">service munin-node restart</code> می‌کند.
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>مطالعه بیشتر</em></span> ایجاد پلاگین‌های محلی</strong></p></div></div></div><div
                class="para">
					Munin شامل مستندات کاملی درباره چگونگی عملکرد و توسعه پلاگین‌ها است. <div
                  class="url">→ <a
                    href="http://munin-monitoring.org/wiki/plugins">http://munin-monitoring.org/wiki/plugins</a></div>
				</div><div
                class="para">
					یک پلاگین بهتر است در شرایط مشابه با فراخوانی توسط munin-node مورد آزمون قرار گیرد؛ این عمل با اجرای <code
                  class="command">munin-run <em
                    class="replaceable">plugin</em></code> به عنوان root شبیه‌سازی می‌شود. یک پارامتر دوم احتمالی که به این دستور داده می‌شود (از جمله <code
                  class="literal">config</code>) به عنوان یک پارامتر به پلاگین فرستاده می‌شود.
				</div><div
                class="para">
					زمانی که یک پلاگین توسط پارامتر <code
                  class="literal">config</code> فراخوانی می‌شود، باید خود را با بازگرداندن مجموعه‌ای از فیلدها تعریف کند:
				</div><pre
                class="screen"><code
                  class="computeroutput">$ </code><strong
                  class="userinput"><code>sudo munin-run load config
</code></strong><code
                  class="computeroutput">graph_title Load average
graph_args --base 1000 -l 0
graph_vlabel load
graph_scale no
graph_category system
load.label load
graph_info The load average of the machine describes how many processes are in the run-queue (scheduled to run "immediately").
load.info 5 minute load average
</code></pre><div
                class="para">
					فیلدهای موجود مختلف توسط “مرجع پلاگین” موجود در قسمت “راهنمای Munin” توضیح داده شده‌اند. <div
                  class="url">→ <a
                    href="http://munin.readthedocs.org/en/latest/reference/plugin.html">http://munin.readthedocs.org/en/latest/reference/plugin.html</a></div>
				</div><div
                class="para">
					زمانی که بدون پارامتر فراخوانی می‌شود، پلاگین به سادگی آخرین مقدار محاسبه شده را باز می‌گرداند؛ برای نمونه، اجرای <code
                  class="command">sudo munin-run load</code> می‌تواند مقدار <code
                  class="literal">load.value 0.12</code> را باز گرداند.
				</div><div
                class="para">
					در نهایت، زمانی که یک پلاگین توسط پارامتر <code
                  class="literal">autoconf</code> فراخوانی می‌شود، باید مقدار “yes” (گزارش خروج ۰) یا “no” (گزارش خروج ۱) با توجه به اینکه آیا پلاگین باید در این میزبان فعال شود یا خیر را باز گرداند.
				</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="id-1.15.7.6.5"></a>12.4.1.2. پیکربندی Grapher</h4></div></div></div><div
              class="para">
					“grapher” در واقع رایانه‌ای است که داده‌ها را گردآوری کرده و نمودارهای مرتبط با آن را رسم می‌کند. نرم‌افزار مورد نیاز در بسته <span
                class="pkg pkg">munin</span> قرار دارد. پیکربندی استاندارد <code
                class="command">munin-cron</code> را هر ۵ دقیقه یکبار اجرا کرده، تا اطلاعات از تمام میزبان‌های موجود در <code
                class="filename">/etc/munin/munin.conf</code> گردآوری شوند (فقط میزبان محلی به صورت پیشفرض قرار دارد)، داده‌های بدست آمده را در فایل‌های RRD، که مخفف <span
                class="emphasis"><em>Round Robin Database</em></span> و مناسب ذخیره‌سازی داده‌های متغیر در طول زمان است، ذخیره‌سازی می‌کند که این فایل‌ها در مسیر <code
                class="filename">/var/lib/munin/</code> قرار دارند و در نهایت یک صفحه HTML همراه با نمودارها در <code
                class="filename">/var/cache/munin/www/</code> ایجاد می‌کند.
				</div><div
              class="para">
					بنابراین تمام ماشین‌های مانیتور شده باید در فایل پیکربندی <code
                class="filename">/etc/munin/munin.conf</code> قرار داشته باشند. هر ماشین به عنوان یک قسمت کامل همراه با نام آن و حداقل یک مدخل <code
                class="literal">address</code> که شامل نشانی IP ماشین است، قرار می‌گیرد.
				</div><pre
              class="programlisting">[ftp.falcot.com]
    address 192.168.0.12
    use_node_name yes</pre><div
              class="para">
					قسمت‌ها می‌توانند پیچیده‌تر باشند، تا با ترکیب داده‌های بدست آمده از چند ماشین نمودارهای اضافی رسم گردد. مثال‌های موجود در فایل پیکربندی نقطه آغاز مناسبی برای سفارشی‌کردن این فرآیند هستند.
				</div><div
              class="para">
					آخرین گام انتشار صفحات تولید شده است؛ اینکار نیازمند پیکربندی سرور وب به گونه‌ای است که محتوای <code
                class="filename">/var/cache/munin/www/</code> از طریق یک وبسایت قابل دسترس باشد. دسترسی به این وبسایت می‌تواند با استفاده از مکانیزم احرازهویت یا کنترل دسترسی مبتنی بر IP مدیریت شود. برای جزئیات مرتبط <a
                class="xref"
                href="sect.http-web-server.html">
      قسمت 11.2, “سرور وب (HTTP)”
    </a> را مشاهده کنید.
				</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="sect.nagios"></a>12.4.2. راه‌اندازی Nagios</h3></div></div></div><a
            id="id-1.15.7.7.2"
            class="indexterm"></a><div
            class="para">
				برخلاف Munin، الزامی بر نصب Nagios روی میزبان‌های مانیتور شده نیست؛ از Nagios بیشتر به منظور بررسی موجود بودن سرویس‌های شبکه استفاده می‌شود. برای نمونه، Nagios می‌تواند به یک سرور وب متصل شده و بررسی کند یک صفحه مشخص در زمان مشخص قابل دسترس است یا خیر.
			</div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="id-1.15.7.7.4"></a>12.4.2.1. نصب</h4></div></div></div><div
              class="para">
					اولین گام در راه‌اندازی Nagios نصب بسته‌های <span
                class="pkg pkg">nagios3</span>، <span
                class="pkg pkg">nagios-plugins</span> و <span
                class="pkg pkg">nagios3-doc</span> است. نصب بسته‌ها منجر به پیکربندی یک رابط وب و ایجاد کاربر <code
                class="literal">nagiosadmin</code> می‌شود (که برای آن گذرواژه درخواست خواهد شد). افزودن سایر کاربران به سادگی درج آن‌ها در فایل <code
                class="filename">/etc/nagios3/htpasswd.users</code> با استفاده از دستور <code
                class="command">htpasswd</code> در آپاچی است. اگر در زمان نصب پرسشی از طرف Debconf مطرح نشد، می‌توان از <code
                class="command">dpkg-reconfigure nagios3-cgi</code> برای تعریف گذرواژه <code
                class="literal">nagiosadmin</code> استفاده کرد.
				</div><div
              class="para">
					نشانی <code
                class="literal">http://<em
                  class="replaceable">server</em>/nagios3/</code> در مرورگر، رابط وب مربوط به آن را نمایش می‌دهد؛ به طور مشخص، به یاد داشته باشید که Nagios برخی پارامترهای ماشینی که در آن اجرا می‌شود را مانیتور می‌کند. با این حال، برخی ویژگی‌های تعاملی از جمله افزودن دیدگاه به یک میزبان ممکن است کار نکند. این ویژگی‌های در پیکربندی پیشفرض برای Nagios غیرفعال هستند، که بنا بر دلایل امنیتی بسیار محدود کننده است.
				</div><div
              class="para">
					همانطور که در <code
                class="filename">/usr/share/doc/nagios3/README.Debian</code> توضیح داده شده است، فعال‌سازی برخی ویژگی‌ها نیازمند ویرایش <code
                class="filename">/etc/nagios3/nagios.cfg</code> و تنظیم پارامتر <code
                class="literal">check_external_commands</code> آن به “1” است. همچنین نیاز داریم تا مجوزهای نوشتن روی دایرکتوری که توسط Nagios استفاده می‌شود را با استفاده از دستورات مشابه زیر تنظیم کنیم:
				</div><pre
              class="screen"><code
                class="computeroutput"># </code><strong
                class="userinput"><code>service nagios3 stop</code></strong>
<code
                class="computeroutput">[...]
# </code><strong
                class="userinput"><code>dpkg-statoverride --update --add nagios www-data 2710 /var/lib/nagios3/rw
</code></strong><code
                class="computeroutput"># </code><strong
                class="userinput"><code>dpkg-statoverride --update --add nagios nagios 751 /var/lib/nagios3
</code></strong><code
                class="computeroutput"># </code><strong
                class="userinput"><code>service nagios3 start</code></strong>
<code
                class="computeroutput">[...]</code></pre></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      id="id-1.15.7.7.5"></a>12.4.2.2. پیکربندی</h4></div></div></div><div
              class="para">
					رابط وب Nagios بسیار کاربردی است، اما اجازه تغییر پیکربندی یا افزودن میزبان‌ها و سرویس‌های قابل مانیتور را نمی‌دهد. پیکربندی کلی از طریق فایل‌های اشاره شده در فایل پیکربندی مرکزی <code
                class="filename">/etc/nagios3/nagios.cfg</code> مدیریت می‌شود.
				</div><div
              class="para">
					بدون درک از مفاهیم Nagios نباید مستقیم سراغ این فایل‌ها رفت. پیکربندی شامل اشیایی از نوع زیر می‌باشد:
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="itemizedlist"><ul><li
                  class="listitem"><div
                    class="para">
							یک <span
                      class="emphasis"><em>host</em></span> ماشینی است که باید مانیتور شود؛
						</div></li><li
                  class="listitem"><div
                    class="para">
							یک <span
                      class="emphasis"><em>hostgroup</em></span> مجموعه‌ای از میزبان‌ها است که برای نمایش یا در نظر گرفتن برخی عناصر پیکربندی، باید گروه‌بندی شوند؛
						</div></li><li
                  class="listitem"><div
                    class="para">
							یک <span
                      class="emphasis"><em>service</em></span> شامل عنصری قابل آزمون مرتبط با یک میزبان یا گروه میزبانی است. در اکثر موارد برای بررسی یک سرویس شبکه بکار می‌رود، اما می‌تواند برای بررسی محدوده مجاز برخی پارامترها نیز استفاده شود (برای نمونه، فضای آزاد دیسک یا بار پردازنده)؛
						</div></li><li
                  class="listitem"><div
                    class="para">
							یک <span
                      class="emphasis"><em>servicegroup</em></span> مجموعه‌ای از سرویس‌ها است که برای نمایش باید گروه‌بندی شوند؛
						</div></li><li
                  class="listitem"><div
                    class="para">
							یک <span
                      class="emphasis"><em>contact</em></span> شخصی است که می‌تواند هشدارها را دریافت کند؛
						</div></li><li
                  class="listitem"><div
                    class="para">
							یک <span
                      class="emphasis"><em>contactgroup</em></span> مجموعه‌ای از چنین افرادی است؛
						</div></li><li
                  class="listitem"><div
                    class="para">
							یک <span
                      class="emphasis"><em>timeperiod</em></span> بازه‌ای از زمان است که طی آن برخی سرویس‌ها باید بررسی شوند؛
						</div></li><li
                  class="listitem"><div
                    class="para">
							یک <span
                      class="emphasis"><em>command</em></span> دستوری است که به منظور بررسی یک سرویس مشخص فراخوانی می‌شود.
						</div></li></ul></div><div
              class="para">
					با توجه به نوع، هر شی شامل قابلیت‌هایی است که می‌تواند سفارشی شود. فهرست کامل آن بسیار طولانی است، اما مهم‌ترین قابلیت‌ها همان روابط بین اشیا است.
				</div><div
              class="para">
					یک <span
                class="emphasis"><em>service</em></span> از <span
                class="emphasis"><em>command</em></span> استفاده می‌کند تا وضعیت یک قابلیت موجود در<span
                class="emphasis"><em>host</em></span> (یا <span
                class="emphasis"><em>hostgroup</em></span>) را طی بازه <span
                class="emphasis"><em>timeperiod</em></span> بررسی کند. در صورت بروز مشکل، Nagios یک هشدار به تمام اعضای موجود در <span
                class="emphasis"><em>contactgroup</em></span> مرتبط با سرویس ارسال می‌کند. با توجه به کانال تعریف شده برای هر فرد در شی <span
                class="emphasis"><em>contact</em></span>، پیام برای وی فرستاده می‌شود.
				</div><div
              class="para">
					یک سیستم ارث‌گرایی امکان اشتراک‌گذاری مجموعه‌ای از قابلیت‌ها را بین چندین شی مختلف بدون تکرار اطلاعات فراهم می‌کند. علاوه بر این، پیکربندی پیشفرض شامل برخی از اشیای استاندارد می‌باشد؛ در اکثر موارد، تعریف میزبان‌ها، سرویس‌ها و افراد جدید به سادگی مشتق شدن از این اشیای عمومی است. فایل‌های موجود در <code
                class="filename">/etc/nagios3/conf.d/</code> منبع خوبی از اطلاعات درباره چگونگی کارکرد این اشیا است.
				</div><div
              class="para">
					مدیرسیستم‌های شرکت فالکوت از پیکربندی زیر استفاده می‌کنند:
				</div><div
              class="example"><a
                id="id-1.15.7.7.5.9"></a><p
                class="title"><strong>
      مثال 12.3. فایل <code
                    class="filename">/etc/nagios3/conf.d/falcot.cfg</code></strong></p><div
                class="example-contents"><pre
                  class="programlisting">define contact{
    name                            generic-contact
    service_notification_period     24x7
    host_notification_period        24x7
    service_notification_options    w,u,c,r
    host_notification_options       d,u,r
    service_notification_commands   notify-service-by-email
    host_notification_commands      notify-host-by-email
    register                        0 ; Template only
}
define contact{
    use             generic-contact
    contact_name    rhertzog
    alias           Raphael Hertzog
    email           hertzog@debian.org
}
define contact{
    use             generic-contact
    contact_name    rmas
    alias           Roland Mas
    email           lolando@debian.org
}

define contactgroup{
    contactgroup_name     falcot-admins
    alias                 Falcot Administrators
    members               rhertzog,rmas
}

define host{
    use                   generic-host ; Name of host template to use
    host_name             www-host
    alias                 www.falcot.com
    address               192.168.0.5
    contact_groups        falcot-admins
    hostgroups            debian-servers,ssh-servers
}
define host{
    use                   generic-host ; Name of host template to use
    host_name             ftp-host
    alias                 ftp.falcot.com
    address               192.168.0.6
    contact_groups        falcot-admins
    hostgroups            debian-servers,ssh-servers
}

# 'check_ftp' command with custom parameters
define command{
    command_name          check_ftp2
    command_line          /usr/lib/nagios/plugins/check_ftp -H $HOSTADDRESS$ -w 20 -c 30 -t 35
}

# Generic Falcot service
define service{
    name                  falcot-service
    use                   generic-service
    contact_groups        falcot-admins
    register              0
}

# Services to check on www-host
define service{
    use                   falcot-service
    host_name             www-host
    service_description   HTTP
    check_command         check_http
}
define service{
    use                   falcot-service
    host_name             www-host
    service_description   HTTPS
    check_command         check_https
}
define service{
    use                   falcot-service
    host_name             www-host
    service_description   SMTP
    check_command         check_smtp
}

# Services to check on ftp-host
define service{
    use                   falcot-service
    host_name             ftp-host
    service_description   FTP
    check_command         check_ftp2
}</pre></div></div><div
              class="para">
					این فایل پیکربندی دو میزبان مانیتور شده را تعریف می‌کند. اولی سرور وب است که بررسی‌های موجود برای درگاه‌های ۸۰ و ۴۴۳ انجام می‌شود. Nagios همچنین بررسی می‌کند که سرور SMTP روی درگاه ۲۵ اجرا شود. دومی سرور FTP است که بررسی به منظور دریافت پاسخ ظرف مدت ۲۰ ثانیه در آن صورت می‌گیرد. فراتر از این تاخیر، یک <span
                class="emphasis"><em>warning</em></span> صادر می‌شود؛ فراتر از ۳۰ ثانیه، هشدار به منزله بحرانی در نظر گرفته می‌شود. رابط وب Nagios همچنین نشان می‌دهد که سرویس SSH در حال مانیتور شدن است: این اطلاعات از میزبان‌هایی می‌آید که متعلق به گروه <code
                class="literal">ssh-servers</code> هستند. سرویس استاندارد منطبق با آن در فایل <code
                class="filename">/etc/nagios3/conf.d/services_nagios2.cfg</code> تعریف شده است.
				</div><div
              class="para">
					کاربرد ارث‌گرایی را به یاد داشته باشید: یک شی می‌تواند از شی دیگری با استفاده از “use <em
                class="replaceable">parent-name</em>” ارث‌بری کند. شی والد باید قابل شناسایی باشد، که نیازمند اختصاص قابلیت “name <em
                class="replaceable">identifier</em>” به آن می‌باشد. اگر قرار بر واقعی نبودن شی والد باشد، اما تنها به صورت والد عمل کند، اختصاص قابلیت “register 0” به آن به Nagios می‌گوید که از آن شی صرف نظر کند، که در این صورت نبود برخی پارامترهای مورد نیاز آن مشکلی را بوجود نمی‌آورد.
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>مستندات</em></span> فهرستی از قابلیت‌های شی</strong></p></div></div></div><div
                class="para">
					درک عمیق‌تر از روش‌های دیگری برای پیکربندی Nagios می‌تواند با استفاده از مستندات موجود در بسته <span
                  class="pkg pkg">nagios3-doc</span> حاصل شود. این مستندات به صورت مستقیم از رابط وب، در پیوند “Documentation” موجود در گوشه بالا سمت چپ قابل دسترسی هستند. شامل فهرستی از تمام انواع اشیا همراه با تمام قابلیت‌های موجود در آن‌ها می‌شود. همچنین توضیح می‌دهد چطور پلاگین‌های جدید را ایجاد کنیم.
				</div></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>مطالعه بیشتر</em></span> آزمون‌های راه‌دور با استفاده از NRPE</strong></p></div></div></div><div
                class="para">
					بسیاری پلاگین‌های Nagios امکان بررسی برخی پارامترهای محلی برای یک میزبان را فراهم می‌کنند؛ اگر ماشین‌های زیادی به این بررسی‌ها نیاز داشته باشند در صورتی که یک نصب مرکزی تمام اطلاعات را گردآوری کند، پلاگین NRPE یا <span
                  class="emphasis"><em>Nagios Remote Plugin Executor</em></span> باید راه‌اندازی گردد. بسته <span
                  class="pkg pkg">nagios-nrpe-plugin</span> باید در سرور Nagios و بسته <span
                  class="pkg pkg">nagios-nrpe-server</span> باید در میزبان‌هایی که نیازمند برخی آزمون‌ها هستند، نصب شود. گزینه دوم پیکربندی خود را از <code
                  class="filename">/etc/nagios/nrpe.cfg</code> دریافت می‌کند. این فایل همراه با نشانی‌های IP ماشین‌هایی که قصد اجرای این آزمون‌ها را دارند، باید شامل آزمون‌هایی باشد که از راه‌دور آغاز می‌شوند. در طرف Nagios، فعال‌سازی این آزمون‌های جدید به سادگی افزودن‌ سرویس‌های متناظر با آن‌ها با استفاده از دستور <span
                  class="emphasis"><em>check_nrpe</em></span> است.
				</div></div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.automated-installation.html"><strong>قبلی</strong>12.3. نصب خودکار</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>بالا</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>خانه</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="workstation.html"><strong>بعدی</strong>
      فصل 13. رومیزی</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.monitoring.html">ar-MA</a></li><li><a
              href="../da-DK/sect.monitoring.html">da-DK</a></li><li><a
              href="../de-DE/sect.monitoring.html">de-DE</a></li><li><a
              href="../el-GR/sect.monitoring.html">el-GR</a></li><li><a
              href="../en-US/sect.monitoring.html">en-US</a></li><li><a
              href="../es-ES/sect.monitoring.html">es-ES</a></li><li><a
              href="../fa-IR/sect.monitoring.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.monitoring.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.monitoring.html">hr-HR</a></li><li><a
              href="../id-ID/sect.monitoring.html">id-ID</a></li><li><a
              href="../it-IT/sect.monitoring.html">it-IT</a></li><li><a
              href="../ja-JP/sect.monitoring.html">ja-JP</a></li><li><a
              href="../ko-KR/sect.monitoring.html">ko-KR</a></li><li><a
              href="../nb-NO/sect.monitoring.html">nb-NO</a></li><li><a
              href="../pl-PL/sect.monitoring.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.monitoring.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.monitoring.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.monitoring.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.monitoring.html">tr-TR</a></li><li><a
              href="../vi-VN/sect.monitoring.html">vi-VN</a></li><li><a
              href="../zh-CN/sect.monitoring.html">zh-CN</a></li><li><a
              href="../zh-TW/sect.monitoring.html">zh-TW</a></li></ul></div></body></html>
