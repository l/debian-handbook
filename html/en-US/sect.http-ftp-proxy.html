<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">11.6. HTTP/FTP Proxy</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.1" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-en-US-1.0-1" /><meta
        name="keywords"
        content="Postfix, Apache, NFS, Samba, Squid, OpenLDAP" /><link
        rel="home"
        href="index.html"
        title="The Debian Administrator's Handbook" /><link
        rel="up"
        href="network-services.html"
        title="Chapter 11. Network Services: Postfix, Apache, NFS, Samba, Squid, LDAP" /><link
        rel="prev"
        href="sect.windows-file-server-with-samba.html"
        title="11.5. Setting Up Windows Shares with Samba" /><link
        rel="next"
        href="sect.ldap-directory.html"
        title="11.7. LDAP Directory" /><link
        rel="canonical"
        href="http://l.github.io/debian-handbook/html/en-US/sect.http-ftp-proxy.html" /></head><body
      class="draft "><noscript><iframe
          src="//www.googletagmanager.com/ns.html?id=GTM-5H35QX"
          height="0"
          width="0"
          style="display:none;visibility:hidden"></iframe></noscript><script
        type="text/javascript">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5H35QX');</script><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="http://debian-handbook.info"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.windows-file-server-with-samba.html"><strong>Prev</strong></a></li><li
          class="home">The Debian Administrator's Handbook</li><li
          class="next"><a
            accesskey="n"
            href="sect.ldap-directory.html"><strong>Next</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  id="sect.http-ftp-proxy"></a>11.6. HTTP/FTP Proxy</h2></div></div></div><div
          class="para">
			An HTTP/FTP proxy acts as an intermediary for HTTP and/or FTP connections. Its role is twofold:
		</div><div
          xmlns:d="http://docbook.org/ns/docbook"
          class="itemizedlist"><ul><li
              class="listitem"><div
                class="para">
					Caching: recently downloaded documents are copied locally, which avoids multiple downloads.
				</div></li><li
              class="listitem"><div
                class="para">
					Filtering server: if use of the proxy is mandated (and outgoing connections are blocked unless they go through the proxy), then the proxy can determine whether or not the request is to be granted.
				</div></li></ul></div><a
          id="idm139739554311024"
          class="indexterm"></a><a
          id="idm139739554310256"
          class="indexterm"></a><div
          class="para">
			Falcot Corp selected Squid as their proxy server.
		</div><a
          id="idm139739554309024"
          class="indexterm"></a><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="idm139739554308256"></a>11.6.1. Installing</h3></div></div></div><div
            class="para">
				The <span
              class="pkg pkg">squid3</span> Debian package only contains the modular (caching) proxy. Turning it into a filtering server requires installing the additional <span
              class="pkg pkg">squidguard</span> package. In addition, <span
              class="pkg pkg">squid-cgi</span> provides a querying and administration interface for a Squid proxy.
			</div><div
            class="para">
				Prior to installing, care should be taken to check that the system can identify its own complete name: the <code
              class="command">hostname -f</code> must return a fully-qualified name (including a domain). If it does not, then the <code
              class="filename">/etc/hosts</code> file should be edited to contain the full name of the system (for instance, <code
              class="literal">arrakis.falcot.com</code>). The official computer name should be validated with the network administrator in order to avoid potential name conflicts.
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="idm139739554302992"></a>11.6.2. Configuring a Cache</h3></div></div></div><div
            class="para">
				Enabling the caching server feature is a simple matter of editing the <code
              class="filename">/etc/squid3/squid.conf</code> configuration file and allowing machines from the local network to run queries through the proxy. The following example shows the modifications made by the Falcot Corp administrators:
			</div><div
            class="example"><a
              id="idm139739554301280"></a><p
              class="title"><strong>Example 11.30. The <code
                  class="filename">/etc/squid3/squid.conf</code> file (excerpts)</strong></p><div
              class="example-contents"><pre
                class="programlisting">
# INSERT YOUR OWN RULE(S) HERE TO ALLOW ACCESS FROM YOUR CLIENTS

# Example rule allowing access from your local networks. Adapt
# to list your (internal) IP networks from where browsing should
# be allowed
acl our_networks src 192.168.1.0/24 192.168.2.0/24
http_access allow our_networks
http_access allow localhost
# And finally deny all other access to this proxy
http_access deny all
</pre></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    id="idm139739554299216"></a>11.6.3. Configuring a Filter</h3></div></div></div><div
            class="para">
				<code
              class="command">squid</code> itself does not perform the filtering; this action is delegated to <code
              class="command">squidGuard</code>. The former must then be configured to interact with the latter. This involves adding the following directive to the <code
              class="filename">/etc/squid/squid.conf</code> file:
			</div><a
            id="idm139739554296832"
            class="indexterm"></a><pre
            class="programlisting">
redirect_program /usr/bin/squidGuard -c /etc/squid/squidGuard.conf
</pre><div
            class="para">
				The <code
              class="filename">/usr/lib/cgi-bin/squidGuard.cgi</code> CGI program also needs to be installed, using <code
              class="filename">/usr/share/doc/squidguard/examples/squidGuard.cgi.gz</code> as a starting point. Required modifications to this script are the <code
              class="varname">$proxy</code> and <code
              class="varname">$proxymaster</code> variables (the name of the proxy and the administrator's contact e-mail, respectively). The <code
              class="varname">$image</code> and <code
              class="varname">$redirect</code> variables should point to existing images representing the rejection of a query.
			</div><div
            class="para">
				The filter is enabled with the <code
              class="command">/etc/init.d/squid reload</code> command. However, since the <span
              class="pkg pkg">squidguard</span> package does no filtering by default, it is the administrator's task to define the policy. This can be done by creating the <code
              class="filename">/etc/squid/squidGuard.conf</code> file (using <code
              class="filename">/etc/squidguard/squidGuard.conf.default</code> as template if required).
			</div><div
            class="para">
				The working database must be regenerated with <code
              class="command">update-squidguard</code> after each change of the <code
              class="command">squidGuard</code> configuration file (or one of the lists of domains or URLs it mentions). The configuration file syntax is documented on the following website: <div
              class="url">→ <a
                href="http://www.squidguard.org/Doc/configure.html">http://www.squidguard.org/Doc/configure.html</a></div>
			</div><a
            id="idm139739554288144"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ALTERNATIVE</em></span> DansGuardian</strong></p></div></div></div><a
              id="idm139739554286352"
              class="indexterm"></a><a
              id="idm139739554285216"
              class="indexterm"></a><div
              class="para">
				The <span
                class="pkg pkg">dansguardian</span> package is an alternative to <span
                class="emphasis"><em>squidguard</em></span>. This software does not simply handle a black-list of forbidden URLs, but it can take advantage of the PICS system (<span
                class="emphasis"><em>Platform for Internet Content Selection</em></span>) to decide whether a page is acceptable by dynamic analysis of its contents.
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.windows-file-server-with-samba.html"><strong>Prev</strong>11.5. Setting Up Windows Shares with Samba</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Up</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Home</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.ldap-directory.html"><strong>Next</strong>11.7. LDAP Directory</a></li></ul><div
        id="translated_pages"><ul><li><a
              href="../ar-MA/sect.http-ftp-proxy.html">ar-MA</a></li><li><a
              href="../da-DK/sect.http-ftp-proxy.html">da-DK</a></li><li><a
              href="../de-DE/sect.http-ftp-proxy.html">de-DE</a></li><li><a
              href="../el-GR/sect.http-ftp-proxy.html">el-GR</a></li><li><a
              href="../en-US/sect.http-ftp-proxy.html">en-US</a></li><li><a
              href="../es-ES/sect.http-ftp-proxy.html">es-ES</a></li><li><a
              href="../fa-IR/sect.http-ftp-proxy.html">fa-IR</a></li><li><a
              href="../fr-FR/sect.http-ftp-proxy.html">fr-FR</a></li><li><a
              href="../hr-HR/sect.http-ftp-proxy.html">hr-HR</a></li><li><a
              href="../id-ID/sect.http-ftp-proxy.html">id-ID</a></li><li><a
              href="../it-IT/sect.http-ftp-proxy.html">it-IT</a></li><li><a
              href="../ja-JP/sect.http-ftp-proxy.html">ja-JP</a></li><li><a
              href="../pl-PL/sect.http-ftp-proxy.html">pl-PL</a></li><li><a
              href="../pt-BR/sect.http-ftp-proxy.html">pt-BR</a></li><li><a
              href="../ro-RO/sect.http-ftp-proxy.html">ro-RO</a></li><li><a
              href="../ru-RU/sect.http-ftp-proxy.html">ru-RU</a></li><li><a
              href="../tr-TR/sect.http-ftp-proxy.html">tr-TR</a></li><li><a
              href="../zh-CN/sect.http-ftp-proxy.html">zh-CN</a></li></ul></div></body></html>
